<!--
~ The contents of this file are subject to the OpenMRS Public License
~ Version 1.0 (the "License"); you may not use this file except in
~ compliance with the License. You may obtain a copy of the License at
~ http://license.openmrs.org
~
~ Software distributed under the License is distributed on an "AS IS"
~ basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See the
~ License for the specific language governing rights and limitations
~ under the License.
~
~ Copyright (C) OpenMRS, LLC.  All Rights Reserved.
-->
<!--
Green Card follow-up visit form
-->
<htmlform>
    <style type="text/css">
        table.right-aligned-first td:first-child {
            text-align: right;
        }
        table.link {
            text-align: right;
            border:2px solid darkgray;
            padding: inherit;
        }
        .show-links {
            text-align: right;
            border:2px solid darkgray;
            padding: inherit;
        }

        /* The Modal  */
        .modal {
            display: none; /* Hidden by default */
            position: fixed; /* Stay in place */
            z-index: 1; /* Sit on top */
            left: 0;
            top: 0;
            width: 100%; /* Full width */
            height: 100%; /* Full height */
            overflow: auto; /* Enable scroll if needed */
            background-color: rgb(0,0,0); /* Fallback color */
            background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
        }
        /* Modal Content/Box */
        .modal-content {
            background-color: #fefefe;
            margin: 15% auto; /* 15% from the top and centered */
            padding: 20px;
            border: 1px solid #888;
            width: 80%; /* Could be more or less, depending on screen size */
        }
        /* Modal Footer */
        .modal-footer {
            padding: 2px 16px;
            background-color: #fefefe;
            color: white;
        }
        /* The Close Button */
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }
        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
        /* .Modal  */

    </style>
    <script type="text/javascript" src="../moduleResources/kenyaemr/scripts/moment.js"></script>
    <link rel="stylesheet" type="text/css" href="../moduleResources/kenyaemr/styles/kenyaemr_extras.css"></link>
    <!--Wizard plugins-->
    <link rel="stylesheet" href="../moduleResources/kenyaemr/styles/smart_wizard.css" type="text/css" ></link>
    <script type="text/javascript" src="../moduleResources/kenyaemr/scripts/jquery.smartWizard.js"></script>
    <script type="text/javascript">
        //Global variables
        var bmi = null;
        var SELF = 978;
        var REFILL_DOCUMENTATION = 159802;
        var TS = 161642;
        var PREVIOUSLY_BREASTFEEDING = "<lookup expression="fn.latestObs(5632).getValueCoded()"/>"; // this is breastfeeding last obs
        var GREENCARD_VELOCITY = "<lookup expression="kenyaemr.GreenCardVelocityCalculation()" />";
        var PATIENT_ON_IPT = GREENCARD_VELOCITY.split(",")[0].split(":")[1];
        var PATIENT_ON_TB = GREENCARD_VELOCITY.split(",")[1].split(":")[1];
        var PATIENT_ON_ART = GREENCARD_VELOCITY.split(",")[2].split(":")[1];
        var PATIENT_HAS_BEEN_ON_ART = GREENCARD_VELOCITY.split(",")[3].split(":")[1];
        var REGIMEN_NAME = GREENCARD_VELOCITY.split(",")[4].split(":")[1];
        var REGIMEN_DURATION = GREENCARD_VELOCITY.split(",")[5].split(":")[1];
        var VL_RESULT = GREENCARD_VELOCITY.split(",")[6].split(":")[1];
        var LDL_RESULT = GREENCARD_VELOCITY.split(",")[7].split(":")[1];
        var IPT_COMPLETED = GREENCARD_VELOCITY.split(",")[8].split(":")[1];
        var GOOD_ADHERENCE = GREENCARD_VELOCITY.split(",")[9].split(":")[1];
        var PATIENT_PREGNANT = GREENCARD_VELOCITY.split(",")[10].split(":")[1];
        var PATIENT_BREASTFEEDING = GREENCARD_VELOCITY.split(",")[11].split(":")[1];


        var pAge = parseInt('<lookup expression="patient.age"/>');
        var pgender = "<lookup expression="patient.gender" />";
        var ctxPath = typeof openmrsContextPath === 'string' ? openmrsContextPath : OPENMRS_CONTEXT_PATH;


        //Start on jq onready
        jq(function() {
            jq('#greencard').smartWizard({
                selected: 0,  // Selected Step, 0 = first step
                keyNavigation: true, // Enable/Disable key navigation(left and right keys are used if enabled)
                enableAllSteps: false,  // Enable/Disable all steps on first load
                transitionEffect: 'fade', // Effect on navigation, none/fade/slide/slideleft
                contentURL:null, // specifying content url enables ajax content loading
                contentURLData:null, // override ajax query parameters
                contentCache:true, // cache step contents, if false content is fetched always from ajax url
                cycleSteps: false, // cycle step navigation
                enableFinishButton: false, // makes finish button enabled always
                hideButtonsOnDisabled: false, // when the previous/next/finish buttons are disabled, hide them instead
                errorSteps:[],    // array of step numbers to highlighting as error steps
                labelNext:'Next', // label for Next button
                labelPrevious:'Previous', // label for Previous button
                labelFinish:'Submit',  // label for Finish button
                noForwardJumping:false,
                ajaxType: 'POST',
// Events
                onLeaveStep:onLeaveStepValidation , // triggers when leaving a step
                onShowStep: null,  // triggers when showing a step
                onFinish: submitHtmlForm,  // triggers when Finish button is clicked
                buttonOrder: ['finish', 'next', 'prev']  // button order, to hide a button remove it from the list
            });
//Wizard set error function
            function setError(stepnumber){
                jq('#greencard').smartWizard('setError',{stepnum:stepnumber,iserror:true});
            }
            getField('weight.value').change(onWeightOrHeightChange);
            getField('height.value').change(onWeightOrHeightChange);
            onWeightOrHeightChange();
            onEncounterDateChange();
            recordedStabilityAssessmentIndicators();
            jq('#showNumberBooked').hide();
            jq("#returnVisitDate input[type=hidden]").change(getPatientsBookedOnDate);

            everOnIPTSelected = null;
            patientCurrentlyOnIPT = null;
//Defaults on ready
            jq("#tbl-partner-notification").hide();
            jq("#tbl-adverse-reactions").hide();
            jq('input[type=radio].adverse-reactions').prop("checked", false);
            jq("#tbl-complaints-today").hide();
            jq("#tbl-systems-review").hide();
            jq('input[type=radio].complaints-today').prop("checked", false);
            jq("#tbl-known-allergies").hide();
            jq('input[type=radio].known-allergies').prop("checked", false);
            jq("#tbl-chronic-illness").hide();
            jq('input[type=radio].chronic-illness').prop("checked", false);
            jq("#key-population").hide();
            jq('#nutritional-status input[type=radio]').attr("style", "pointer-events:none;");
//default on patient presence
            jq('.patient-details :input').prop('disabled', true);
            jq('#person-present input').click(onPersonPresentChange);
            jq('#visit-scheduled input').click(onVisitScheduledChange);
            jq('#on-ipt input').prop("disabled", true);
            jq("#tbl-start-antiTb").hide();
            jq("#tb-screening-result").hide();
//Sexual and reproductive setion
// jq('#fp-details').show();
            jq(".refill-facility").hide();
            jq('#lmp-details').hide();
            var age = parseInt('<lookup expression="patient.age"/>');
            if (age &lt; 11) {
                jq('#fp-details').hide();
                jq('#pregnantBreastFeeding').hide();
                jq('.reproductive-part').hide();
            }
//Gravida
            if (pgender == 'F' &amp;&amp; age &gt; 10 ) {
                getField('parity-term.value').change(onParityChange);
                getField('parity-abortion.value').change(onParityChange);
                jq('#fp-details').hide();
            }
            jq("#hasLMP :input[type=radio]").change(patientLMPStatus);
//Menopause
            var recentMenopauseStatus = "<lookup expression="fn.latestObs(160596).getValueCoded()"/>";
            if(recentMenopauseStatus == 113928){
                jq("#menopause input").prop("checked", true);
            }else{
                jq("#menopause input").prop("checked", false);
            }
            jq('#menopause').click(onMenopauseClick);
            jq('#lmp-date :input').prop('disabled', true);
            jq('#if-patient-pregnant').hide();
            jq('#pregnancyOptionValues').hide();
            jq("#wants-pregnancy").hide();
            jq("#tb-screening-tab").hide();
            jq("#tbl-ever-on-ipt").hide();
//TPT OUTCOME



            var actionTakenTab = jq('#action-taken');
            var iptClientWorkupTab = jq('#ipt-client-workup');
            var iptFollowup = jq('#ipt-followup');
            var iptInitiationTab = jq('#ipt-initiation');
            var iptEnrollmentTab = jq('#ipt-enrollment');
            var tbInitiationTab = jq('#tb-enrollment');
            tbInitiationTab.hide();
            actionTakenTab.hide();
            iptClientWorkupTab.hide();
            iptFollowup.hide();
            iptInitiationTab.hide();
            iptEnrollmentTab.hide();
            ageGroup();
            displayRecentBmi();
//Prophylaxis section
            jq("#ctx-part").hide();
            jq("#dapsone-part").hide();
//Event Handlers
            jq("#prophylaxis-used :input[type=radio]").change(prophylaxisSelected);
            jq("#lmp-date :input[type=text]").change(onLmpChange);
            jq("#on-anti-tb-drugs :input[type=radio]").change(onAntiTbDrugs);
            jq("#on-ipt :input[type=radio]").change(onIPT);
            jq("#ever-on-ipt :input[type=radio]").change(everOnIPT);
//sti notification
            jq("#screened-sti :input[type=radio]").change(screenedStiSelected);
//tb action
            jq('#tb-enrollment').hide();
            jq("#start-anti-tb-action").change(startAntiTbAction);
            jq("#clinical-diagnosis-action").change(clinicalDiagnosisAction);
            jq("#sputum-smear-action").change(sputumSmearAction);
            jq("#genexpert-action select").change(geneXpertAction);
            jq("#chest-xray-action").change(chestXrayAction);
            jq("#referral-action").change(referralAction);
            jq("#tb-test-ordered").change(testOrdered);
            jq('#general-exam-findings :input[type=checkbox]').change(generalExamSelected);
            jq("#complaints-today").change(complaintSelected);       //boolean
            jq(".complaint-time input").change(complaintDurationInput);
            jq('#adverse-reactions').change(adverseReactionSelected);     //boolean
            jq('#known-allergies').change(knownAllergiesSelected);       //boolean
            jq('#systems-review :input[type=radio]').change(systemsReviewSelected);   //non-bool
            jq('#chronic-illness :input[type=radio]').change(chronicIllnessesSelected);
            jq('#population-type :input[type=radio]').change(populationTypeSelected);
//Stability assessment
            jq("#stability").change(stabilitySelected);       //boolean
            jq("#returnVisitReason select").change(returnReasonSelected);       //non boolean
            jq("#tbl-standard").show();
            jq("#tbl-fast-track").hide();
            jq("#refill-label").hide();
            jq("#refill-date").hide();
            jq('#standard select').prop('disabled', true);
            jq('#fast-track select').prop('disabled', true);
            var tca_reason = getValue('returnVisitReason.value');
//On ART hide adherence assessment
            if(PATIENT_ON_ART =="true" &amp;&amp; PATIENT_HAS_BEEN_ON_ART =="true") {
                jq('.on-art').show();
                jq('#dlgAdherenceScreening').show();
            }
            else{
                jq('.on-art').hide();
                jq('#dlgAdherenceScreening').hide();
            }
// Morisky ART adherence assessment Modal
            jq("#dlgAdherenceScreening").click(function(e){
//Defaults
                var adherenceResponses1=jq('#adherence-1');
                var adherenceResponses2=jq('#adherence-2');
                jq('#adherence-2').hide();
                clearHiddenSections([adherenceResponses1, adherenceResponses2]);
                e.preventDefault();
                jq("#modalContents").dialog({bgiframe: true, height: 425, width: 900, modal: true });
                jq("#btnCloseARVAssessment").click(closeAdherenceAssessment);
                jq("#adherence-1").change(adherenceAssessment);
            });

            jq('#arv-adherence input[type=radio]').attr("style", "pointer-events:none;");
            var strtext = "";
            var familyPlanningOption = getValue('fplanning.value');
            var pregnancyOption = getValue('pregnancyOption.value');
            if (familyPlanningOption == "") {
                jq('#onFp :input').prop('disabled', true);
                jq('#notOnFp :input').prop('disabled', true);
            }
            if (familyPlanningOption == "965") {
                jq('#onFp :input').prop('disabled', false);
                jq('#notOnFp :input').prop('disabled', true);
            }
            if (familyPlanningOption == "160652") {
                jq('#onFp :input').prop('disabled', true);
                jq('#notOnFp :input').prop('disabled', false);
            }
            if (familyPlanningOption == "1360") {
                jq('#onFp :input').prop('disabled', false);
                jq('#notOnFp :input').prop('disabled', true);
            }
            jq('#pregnancyOption input:radio').change(function () {
                if ((getValue('pregnancyOption.value')) == 1066) {
                    var pregOtions=jq('#pregnancyOptionValues :input').val('');
                    var ancProfile=jq('#anc-profile');
                    jq('#pregnancyOptionValues').hide();
                    jq('#fp-details').hide();
                    jq('#fpOptionValues :input').prop('disabled', false);
                    jq('#fpOptionValues :input').prop('checked', false);
                    jq("#wants-pregnancy").show();
                    clearHiddenSections([pregOtions,ancProfile]);
                }
                if((getValue('pregnancyOption.value')) == 1065){
                    jq('#pregnancyOptionValues :input').prop('disabled', false);
                    var wantsPreg=jq('#wants-pregnancy');
                    jq('#pregnancyOptionValues').show();
                    jq('#fp-details').hide();
                    jq("#wants-pregnancy").hide();
                    clearHiddenSections([wantsPreg]);
//Automate EDC Computation
                    var lmpDate = getValue('lmp-date.value');
                    var formattedlmp=moment(moment(lmpDate, 'YYYY-MM-DD').toDate()).format('DD-MMM-YYYY');
                    var expectedDeliveryDate = moment(formattedlmp, "DD-MMM-YYYY").add(280, 'days').format('DD-MMM-YYYY');
//Find recent EDD if it exists Using LMP
                    var recentEDD = "<lookup expression="fn.latestObs(5596).getValueDatetime()"/>";
                    var recentLMP = "<lookup expression="fn.latestObs(1427).getValueDatetime()"/>";
//Using recent LMP
                    var formattedRecentlmp=moment(moment(recentLMP, 'DD-MMM-YYYY').toDate()).format('DD-MMM-YYYY');
                    var expectedDeliveryDateByRecentLMP = moment(formattedRecentlmp, "DD-MMM-YYYY").add(280, 'days').format('DD-MMM-YYYY');
//Calculation
                    if(recentEDD !=""){
                        getField('patient-edd.value').val(recentEDD);
                    }else if(recentLMP !="") {
                        getField('patient-edd.value').val(expectedDeliveryDateByRecentLMP);
                    }else if (lmpDate!=""){
                        getField('patient-edd.value').val(expectedDeliveryDate);
                    }else{
                        getField('patient-edd.value').val("");
                    }

                }
            });
            jq("#fplanning select ").change(function () {
                jq("#fplanning select option:selected").each(function () {
                    strtext += jq(this).val();
                });
                if (strtext == "") {
                    jq('#notOnFp :input').prop('checked', false);
                    jq('#onFp :input').prop('checked', false);
                    jq('#onFp :input').prop('disabled', true);
                    jq('#notOnFp :input').prop('disabled', true);
                }
                if (strtext == "965") {       //on family planning
                    jq('#notOnFp :input').prop('checked', false);
                    jq('#onFp :input').prop('disabled', false);
                    jq('#notOnFp :input').prop('disabled', true);
                }
                if (strtext == "160652") {
                    jq('#onFp :input').prop('checked', false);
                    jq('#onFp :input').prop('disabled', true);
                    jq('#notOnFp :input').prop('disabled', false);
                }
                if (strtext == "1360") {
                    jq('#notOnFp :input').prop('checked', false);
                    jq('#onFp :input').prop('disabled', false);
                    jq('#notOnFp :input').prop('disabled', true);
                }
                strtext = "";
            });
            jq("#wants-pregnancy").change(function(){
                getField('fplanning.value').prop("selectedIndex", 0);
                jq('#fp-details').show();
                jq('#fpOptionValues :input[type=checkbox]').prop('disabled', true);
                jq('#fpOptionValues :input').prop('checked', false);
            });
//TB MODULE
// Defaults on load
            /*On TB Drugs  */
            if (PATIENT_ON_TB == "true"){
                jq("#on-anti-tb-drugs input[value=1065]").prop("checked", true);
// jq('#on-anti-tb-drugs input[type=radio]').attr("style", "pointer-events:none;");
                jq(".tb-patient").text("On TB Treatment");
            }
            /*On TPT Drugs  */
            if (PATIENT_ON_IPT == 'true'){
                jq('#on-ipt input').prop("disabled", false);
                jq("#on-ipt input[value=1065]").prop("checked", true);
                jq("#on-anti-tb-drugs input[value=1066]").prop("checked", true);
//jq('#on-anti-tb-drugs input[type=radio]').attr("style", "pointer-events:none;");
//jq('#on-ipt input[type=radio]').attr("style", "pointer-events:none;");
                jq(".ipt-patient").text("Currently on TPT");
                jq("#tbl-ever-on-ipt").hide();
                jq("#tb-screening-tab").show();
                jq("#ipt-followup").show();
                jq("#tb-screening-result").show();
            }
// Screening
            /*TB Screening form validation*/
            var screeningRadios = jq('#screening-questions').find('input[type=radio]');
            var iptClientWorkupRadios = jq('#ipt-client-workup').find('input[type=radio]');
            var pregnancyStatus = getField('#pregnancyOption');
            var pregnantStatusRadios = jq('#fp-details').find('input[type=checkbox]');
            const YES_CONCEPT_ID = 1065;
            const NO_CONCEPT_ID = 1066;
            var showHideTabs = function() {
                var actionTakenTab = jq('#action-taken');
                var tbRxdate = jq('#tbrxdate input').val('');
                var tbRegimen = jq('#tb-regimen');
                var iptClientWorkupTab = jq('#ipt-client-workup');
                var iptFollowup = jq('#ipt-followup');
                var tbScreeningQuestionsTab = jq("#tb-screening-tab");
                var tbScreeningResults = jq("#tb-screening-result");
                var tbScreeningResultsStatus = jq("#tb-result-status");
                var everOnIPTRadio = everOnIPTSelected;
                var showActionTakenTab = false;
                var showIPTClientWorkupTab = false;
                var showIPTFollowupTab = false;
                var screeningYesResponses = [];
                var screeningNoResponses = [];
//Fetch responses for the screening questions
                jq.each(screeningRadios, function(){
                    const COUGH = 159799;
                    const CONTACT = 124068;
                    const FEVER = 1494;
                    const WEIGHTLOSS = 832;
                    const SWEAT =133027;
                    const LETHERGY =116334;
//Push any responses to the respective screeningYesResponses and screeningNoResponses array
                    if ((this.value == COUGH || this.value == CONTACT || this.value == FEVER || this.value == WEIGHTLOSS || this.value == SWEAT || this.value == LETHERGY )&amp;&amp; this.checked == true) {
                        screeningYesResponses.push(this);
                    }
//Replaced yes concept with individual symptoms
                    if (this.value == NO_CONCEPT_ID &amp;&amp; this.checked == true) {
                        screeningNoResponses.push(this);
                    }
                });
//If no responses have been recorded then show the ActionTaken and IPTClientWorkup tabs
                if (screeningYesResponses.length == 0 &amp;&amp; screeningYesResponses.length == 0 ) {
                }

                if (everOnIPTRadio == NO_CONCEPT_ID &amp;&amp; screeningYesResponses.length &gt; 0) {
                    actionTakenTab.show();
                    iptClientWorkupTab.hide();
                    iptFollowup.hide();
                    iptInitiationTab.hide();
                    clearRadios([iptFollowup, iptClientWorkupTab, iptInitiationTab, tbScreeningResultsStatus]);
                }
                if (everOnIPTRadio == NO_CONCEPT_ID &amp;&amp; screeningYesResponses.length == 0) {
                    actionTakenTab.hide();
                    iptClientWorkupTab.hide();
                    iptFollowup.hide();
                    iptInitiationTab.hide();
                    clearRadios([iptFollowup, actionTakenTab, iptClientWorkupTab, iptInitiationTab, tbRxdate, tbRegimen, tbScreeningResultsStatus]);
                }
                if (everOnIPTRadio == NO_CONCEPT_ID &amp;&amp; screeningNoResponses.length == screeningRadios.length / 2 ) { // check if all screening No responses are checked: total radios / 2
                    actionTakenTab.hide();
                    iptClientWorkupTab.show();
                    tbScreeningResults.show();
                    jq("#tb-result-status input[value=1660]").prop("checked", true);
                    jq('#tb-result-status input[type=radio]').attr("style", "pointer-events:none;");
                    iptFollowup.hide();
                    clearRadios([actionTakenTab, iptFollowup, tbRxdate, tbRegimen]);
                }
                if (everOnIPTRadio == YES_CONCEPT_ID &amp;&amp; screeningNoResponses.length == screeningRadios.length / 2 ) { // check if patient ever on ipt and all screening No responses are checked: total radios / 2
                    iptClientWorkupTab.hide();
                    tbScreeningResults.show();
                    jq("#tb-result-status input[value=1660]").prop("checked", true);
                    jq('#tb-result-status input[type=radio]').attr("style", "pointer-events:none;");
                    actionTakenTab.hide();
                    iptInitiationTab.hide();
                    clearRadios([actionTakenTab, iptFollowup, tbRxdate, tbRegimen]);
                }
                if (patientCurrentlyOnIPT == YES_CONCEPT_ID &amp;&amp; screeningNoResponses.length == screeningRadios.length / 2 ) { // check if patient currently on TPT all screening No responses are checked: total radios / 2
                    iptClientWorkupTab.hide();
                    tbScreeningResults.show();
                    jq("#tb-result-status input[value=1660]").prop("checked", true);
                    jq('#tb-result-status input[type=radio]').attr("style", "pointer-events:none;");
                    actionTakenTab.hide();
                    iptInitiationTab.hide();
                    clearRadios([actionTakenTab, iptFollowup, tbRxdate, tbRegimen]);
                }
                if (PATIENT_ON_IPT == 'true' &amp;&amp; screeningNoResponses.length == screeningRadios.length / 2 ) { // check if patient currently on TPT from velocity all screening No responses are checked: total radios / 2
                    iptClientWorkupTab.hide();
                    tbScreeningResults.show();
                    jq("#tb-result-status input[value=1660]").prop("checked", true);
                    jq('#tb-result-status input[type=radio]').attr("style", "pointer-events:none;");
                    actionTakenTab.hide();
                    iptInitiationTab.hide();
                    clearRadios([actionTakenTab, iptFollowup, tbRxdate, tbRegimen]);
                }
                if(everOnIPTRadio == YES_CONCEPT_ID &amp;&amp; screeningYesResponses.length &gt; 0) {
                    actionTakenTab.show();
                    iptClientWorkupTab.hide();
                    iptFollowup.hide();
                    iptInitiationTab.hide();
                    clearRadios([iptClientWorkupTab, iptFollowup, iptInitiationTab, tbScreeningResultsStatus]);
                }
                if(screeningYesResponses.length == 0) {
                    actionTakenTab.hide();
                    clearRadios([actionTakenTab, tbRxdate, tbRegimen]);
                }
                if(patientCurrentlyOnIPT == YES_CONCEPT_ID &amp;&amp; screeningYesResponses.length &gt; 0) {
                    actionTakenTab.show();
                    tbScreeningResults.show();
                    iptFollowup.hide();
                    iptClientWorkupTab.hide();
                    clearRadios([iptClientWorkupTab, tbScreeningResultsStatus]);
                }
                if(screeningYesResponses.length &gt; 0) {
                    actionTakenTab.show();
                    iptClientWorkupTab.hide();
                    clearRadios([iptClientWorkupTab, tbScreeningResultsStatus]);
                }
            };
            var showHideIPTInitiationTab = function() {
                var iptInitiationTab = jq('#ipt-initiation');
                var showIPTInitiationTab = false;
                var iptClientWorkupYesResponses = [];
                var iptClientWorkupNoResponses = [];
//Fetch responses for the TPT client workup questions
                jq.each(iptClientWorkupRadios, function() {
                    const YELLOWURINE = 162311;
                    const NUMBNESS = 132652;
                    const YELLOWEYES = 5192;
                    const TENDERNESS = 124992;
//Push any responses to the respective iptClientWorkupYesResponses and iptClientWorkupNoResponses array
                    if ((this.value == YELLOWURINE || this.value == NUMBNESS || this.value == YELLOWEYES || this.value == TENDERNESS)&amp;&amp; this.checked == true) {
                        iptClientWorkupYesResponses.push(this);
                    }
                    if (this.value == NO_CONCEPT_ID &amp;&amp; this.checked == true) {
                        iptClientWorkupNoResponses.push(this);
                    }
                });
                if (iptClientWorkupYesResponses.length == 0 &amp;&amp; iptClientWorkupNoResponses.length == 0) {}

                if (iptClientWorkupNoResponses.length == iptClientWorkupRadios.length / 2)  { // check if all No responses are checked: total radios / 2
                    iptInitiationTab.show();
                    jq('#ipt-result-status').show();
                    jq("#tb-screening-result").show();
                }else{
                    iptInitiationTab.hide();
                    clearRadios([iptInitiationTab]);
                }
            };
            clearRadios = function(parentObj) {
                for (var i = 0; i &lt; parentObj.length; i++){
                    parentObj[i].find('input[type=radio]').each(function () {
                        this.checked = false;
                    });
                    parentObj[i].find('input[type=checkbox]').each(function () {
                        this.checked = false;
                    });
                    parentObj[i].find('select').each(function () {
                        this.selectedIndex = 0;
                    });
                }
            }
            screeningRadios.change(function() {
                showHideTabs();
            });
            iptClientWorkupRadios.change(function() {
                showHideIPTInitiationTab();
            });
            showHideIPTInitiationTab();

// --------------------------------------------- adding ipt handlers ---------------------------------

            jq("#txtIptDueDate").datepicker({
                changeMonth: true,
                changeYear: true,
                dateFormat: "yy-mm-dd"
            });
            jq("#txtIptCollectionDate").datepicker({
                changeMonth: true,
                changeYear: true,
                dateFormat: "yy-mm-dd"
            });

            jq("#btnShowIptFollowupDialog").click(function(e){ // ipt followup
                e.preventDefault();
                jq("#dlgIptFollowup").dialog({bgiframe: true,
                    title : "Record TPT follow-up information",
                    buttons: {
                        "Save": recordIptFollowupInformation,
                        "Cancel": function () {
                            jq("#dlgIptFollowup").dialog("close");
                        }
                    },
                    height: 450,
                    width: 970,
                    modal: true });
            });

            jq("#btnShowIptOutcomeDialog").click(function(e){ // tpt outcome
                e.preventDefault();
                jq("#dlgIptOutcome").dialog({bgiframe: true,
                    title : "Discontinue patient in TPT program",
                    buttons: {
                        "Discontinue TPT": discontinuePatientInIpt,
                        "Cancel": function () {
                            jq("#dlgIptOutcome").dialog("close");
                        }
                    },
                    height: 300,
                    width: 900,
                    modal: true });
            });

            jq("#btnEnrollInIptProgram").click(function(e){ // ipt outcome
                e.preventDefault();
                jq("#dlgIptInitiation").dialog({bgiframe: true,
                    title : "Initiate patient in TPT",
                    buttons: {
                        "Confirm TPT Initiation": enrollPatientToIPTProgram,
                        "Cancel": function () {
                            jq("#dlgIptInitiation").dialog("close");
                        }
                    },
                    height: 300,
                    width: 900,
                    modal: true });
            });
        });   //End of JQuery onReady function


        // get count of patients booked on a date
        function getPatientsBookedOnDate() {
            var tca_date = jq('#returnVisitDate input[type=hidden]').val();
            jq('#showNumberBooked').hide();
            jq.getJSON('/' + ctxPath + '/kenyaemr/emrUtils/clientsBookedForHivConsultationOnDate.action', { appointmentDate: tca_date }, function(data) {
                jq('#showBookedResult').text(data.bookingsOnDate);
                jq('#showNumberBooked').show();
            });
        }

        //----------------------------------- TPT handlers ------------------------

        function discontinuePatientInIpt() {
            var selIptDisReason = jq("#iptDiscReason").val();
            var txtDiscAction = jq("#iptDiscAction").val();
            var patientId = <lookup expression="patient.patientId"/>;
            var userId = <lookup expression="user.userId"/>; // get logged in user. the discontinueIptProgram method doesn't seem to get access to Context.authenticatedUser()
            var encDate = getValue('encounter-date.value');
            if(encDate == null) {
                encDate = new Date();
            }

            if(selIptDisReason == null || selIptDisReason == "") {
                jq('#iptDiscontinueReason').text('TPT discontinuation reason required').addClass("ke-error-label");

            } else if (txtDiscAction == null || txtDiscAction == "") {
                jq('#iptDiscActionTaken').text('Action taken required').addClass("ke-error-label");

            }else {

                jq.getJSON('/' + ctxPath + '/kenyaemr/emrUtils/discontinueIptProgram.action', {
                    completionDate: encDate,
                    patientId: patientId,
                    reason: selIptDisReason,
                    action: txtDiscAction,
                    userId: userId
                }, function (data) {
                    if (data.status == "Success") {
                        jq("#dlgIptOutcome").dialog('close');
                        jq("#lblIptCompletionState").text(data.message).addClass("ke-success-label");
                        jq("#btnShowIptOutcomeDialog").attr("disabled", true);
                        jq("#btnShowIptFollowupDialog").attr("disabled", true);
                    } else {
                        jq("#lblIptCompletionState").text(data.message).addClass("ke-error-label");
                    }

                });
            }
        }

        function recordIptFollowupInformation() {
            var iptDueDate = jq("#txtIptDueDate").val();
            var iptCollectionDate = jq("#txtIptCollectionDate").val();
            var iptHepatoxicity = jq("input[name='rdoHepatoxicity']:checked").val();
            var iptNeuropathy = jq("input[name='rdoNeuropathy']:checked").val();
            var iptRash = jq("input[name='rdoRash']:checked").val();
            var iptAdherence = jq("input[name='rdoAdherence']:checked").val();
            var iptActionTaken = jq("#txtActionTaken").val();


            var patientId = <lookup expression="patient.patientId"/>;
            var userId = <lookup expression="user.userId"/>; // get logged in user. the discontinueIptProgram method doesn't seem to get access to Context.authenticatedUser()
            var encDate = getValue('encounter-date.value');
            if(encDate == null) {
                encDate = new Date();
            }
            if(iptCollectionDate =="" ||iptCollectionDate == null ) {
                jq('#collectedDate').text('TPT collection date required').addClass("ke-error-label");
            }
            else if(iptDueDate =="" ||iptDueDate ==null ) {
                jq('#ipt-due-date').text('TPT due date required').addClass("ke-error-label");
            }
            else if(iptHepatoxicity =="" ||iptHepatoxicity == null ) {
                jq('#hepatotoxity').text('TPT hepatotoxity required').addClass("ke-error-label");
            }
            else if(iptNeuropathy =="" ||iptNeuropathy == null ) {
                jq('#neuropathy-peripheral').text(' Neuropathy required').addClass("ke-error-label");
            }
            else if(iptRash =="" ||iptRash == null ) {
                jq('#patient-rash').text('Rash required').addClass("ke-error-label");
            }
            else if(iptAdherence =="" ||iptAdherence == null ) {
                jq('#adherencemes').text('TPT adherence measurement required').addClass("ke-error-label");
            }else {

                jq.getJSON('/' + ctxPath + '/kenyaemr/emrUtils/addIptFollowup.action', {
                    encounterDate: encDate,
                    patientId: patientId,
                    userId: userId,
                    iptDueDate: iptDueDate,
                    iptCollectionDate: iptCollectionDate,
                    iptHepatoxicity: iptHepatoxicity,
                    iptNeuropathy: iptNeuropathy,
                    iptRash: iptRash,
                    iptAdherence: iptAdherence,
                    iptActionTaken: iptActionTaken
                }, function (data) {

                    if (data.status == "Success") {
                        jq("#dlgIptFollowup").dialog('close');
                        jq("#lblIptCompletionState").text(data.message).addClass("ke-success-label");
                        jq("#btnShowIptFollowupDialog").attr("disabled", true);
                    } else {
                        jq("#lblIptCompletionState").text(data.message).addClass("ke-error-label");
                    }

                });
            }
        }


        // enroll patient in TPT program

        function enrollPatientToIPTProgram() {
            var patientId = <lookup expression="patient.patientId"/>;
            var encDate = getValue('encounter-date.value');
            var indicationForIpt = jq("#indicationForIpt").val();
            var userId = <lookup expression="user.userId"/>; // get logged in user. the discontinueIptProgram method doesn't seem to get access to Context.authenticatedUser()

            if(encDate == null) {
                encDate = new Date();
            }
            if(indicationForIpt != null &amp;&amp; indicationForIpt != "") {

                jq.getJSON('/' + ctxPath + '/kenyaemr/emrUtils/enrollInIptProgram.action', {
                    enrollmentDate: encDate,
                    patientId: patientId,
                    indicationForIpt: indicationForIpt,
                    userId: userId
                }, function (data) {
                    if (data.status == "Success") {
                        jq("#enrollInIptProgram").attr("disabled", true);
                        jq("#lblIptEnrollmentStatus").text(data.message).addClass("ke-success-label");
                        jq("#dlgIptInitiation").dialog("close");
                        jq("#btnEnrollInIptProgram").attr("disabled", true);
                    } else {
                        jq("#lblIptEnrollmentStatus").text(data.message).addClass("ke-error-label");
                    }
                });
            }else {
                jq('#lblIptIndicationOptions').text('Indication for TPT is required.').addClass("ke-error-label");

            }
        }





        // ------------------------------------ end of ipt handlers -----------------------


        function onWeightOrHeightChange() {
            var display = '';
            var weightKg = parseFloat(getValue('weight.value'));
            var heightM = parseFloat(getValue('height.value')) / 100;
            if (pAge &gt; 14) {
                if (weightKg >0 &amp;&amp; heightM >0) {
                    bmi = weightKg / (heightM * heightM);
                    if (isNaN(bmi) || bmi &lt; 10 || bmi &gt; 50) {
                        display = 'Abnormal value. Were height and weight entered correctly?';
                    }
                    else {
                        display = bmi.toFixed(2);
                    }
                }
//set nutritional status and bmi
                jq('#calculated-bmi').html(display);
                if (bmi &lt; 16 &amp;&amp; bmi &gt; 1) {
                    jq("#nutritional-status input[value=163302]").prop("checked", true);
                } else if (bmi &gt; 16 &amp;&amp; bmi &lt; 18.5) {
                    jq("#nutritional-status input[value=163303]").prop("checked", true);
                } else if (bmi &gt; 18.5 &amp;&amp; bmi &lt; 25) {
                    jq("#nutritional-status input[value=1115]").prop("checked", true);
                } else if (bmi &gt; 25) {
                    jq("#nutritional-status input[value=114413]").prop("checked", true);
                }
            }
        }
        function onEncounterDateChange() {
            var patientId = <lookup expression="patient.patientId"/>;
            var encDate = getValue('encounter-date.value');
            if(encDate == null) {
                encDate = new Date();
            }
            if(PATIENT_ON_ART =="true") {
                jq('#current-regimen').html(REGIMEN_NAME);
                jq('#current-regimen-stability:text').val(REGIMEN_NAME);
                jq('#current-regimen-duration:text').val(REGIMEN_DURATION);
            }else{
                jq('#current-regimen').html("None");
                jq('#current-regimen-stability:text').val("None");
                jq('#current-regimen-duration:text').val("N/A");
            }
        }

        function displayRecentBmi() {
            var weightKg = "<lookup expression="fn.latestObs(5089).valueNumeric"/>"
            var heightM = ("<lookup expression="fn.latestObs(5090).valueNumeric"/>")/100
            var bmi = '';
            var recent_bmi ='';
   //If client is > 25 years prepopluate height
            if (pAge &gt; 24 &amp;&amp; heightM !="") {
                getField('height.value').val(heightM*100);
            }else{
                getField('height.value').val("");
            }
            if (pAge &gt; 14) {
                if (weightKg >0 &amp;&amp; heightM >0) {
                    bmi = weightKg / (heightM * heightM);
                    recent_bmi = bmi.toFixed(2);
                    jq('#recent-calculated-bmi').html(recent_bmi);
                    jq('#bmi-value:text').val(recent_bmi);
//set recent nutritional status from recent bmi
                    if (recent_bmi &lt; 16 &amp;&amp; recent_bmi &gt; 1) {
                        jq("#nutritional-status input[value=163302]").prop("checked", true);
                    } else if (recent_bmi &gt; 16 &amp;&amp; recent_bmi &lt; 18.5) {
                        jq("#nutritional-status input[value=163303]").prop("checked", true);
                    } else if (recent_bmi &gt; 18.5 &amp;&amp; recent_bmi &lt; 25) {
                        jq("#nutritional-status input[value=1115]").prop("checked", true);
                    } else if (recent_bmi &gt; 25) {
                        jq("#nutritional-status input[value=114413]").prop("checked", true);
                    }
                }
            }
        }
        //Recorded stability assessment criteria box
        function recordedStabilityAssessmentIndicators() {
//1. Age
            jq('#age:text').val(pAge);
//2. BMI
            /* displayRecentBmi() */
//3. Most recent VL
            if(VL_RESULT &gt; 1){
                jq('#vl-value:text').val(VL_RESULT);
            }else if (LDL_RESULT == "LDL" ) {
                jq('#vl-value:text').val(LDL_RESULT);
            }else{
                jq('#vl-value:text').val("Not available");
            }
//4. Active OIs

//5. Missed appointment last 6 months
            if(PATIENT_ON_ART =="true" &amp;&amp; GOOD_ADHERENCE == 'true') {
                jq('#good-adherence:text').val("YES");
            }else if(PATIENT_ON_ART =="true" &amp;&amp; GOOD_ADHERENCE == 'false'){
                jq('#good-adherence:text').val("NO");
            }else  {
                jq('#good-adherence:text').val("N/A");
            }
//6. Completed 6 months TPT
            if(IPT_COMPLETED == 'true') {
                jq('#ipt-completion:text').val("YES");
            }else{
                jq('#ipt-completion:text').val("NO");
            }
//7. pregnant
            if(PATIENT_PREGNANT == 'true') {
                jq('#pregnant:text').val("YES");
            }else{
                jq('#pregnant:text').val("NO");
            }
//8. breast feeding
           if(PREVIOUSLY_BREASTFEEDING == 1065 || PATIENT_BREASTFEEDING == 'true') {
                jq('#breast-feeding:text').val("YES");
            }else{
                jq('#breast-feeding:text').val("NO");
            }
        }
        function onLmpChange() {
            jq('#pregnancyOption :input').prop('disabled', false);
            jq('#breastfeeding :input').prop('disabled', false);
        }
        //Ckeckbox to remove pregnancy details
        function onMenopauseClick() {
            var val = getValue('menopause.value');
            if(val == 113928){
                jq('#if-patient-pregnant').hide();
                jq("#wants-pregnancy").hide();
                jq('#fp-details').hide();
                jq('#pregnancyOptionValues').hide();
            }else{
                jq('#if-patient-pregnant').show();
            }
        }
        function patientLMPStatus(){
            var val = getValue('hasLMP.value');
            var ifPatientPregnant =  jq('#if-patient-pregnant');
            var pregIntention = jq("#pregnancyIntention");
            var onfpMethodChecked = jq('#fplanning select').val('');
            if(val == 1065){
                jq('#if-patient-pregnant').show();
                jq('#fp-details').hide();
                jq('#lmp-details').show();
                jq('#lmp-date :input').prop('disabled', false);
                clearHiddenSections([ifPatientPregnant, pregIntention, onfpMethodChecked]);
            }
            if(val == 1066){
                jq('#if-patient-pregnant').hide();
                jq('#pregnancyOptionValues').hide();
                jq('#fp-details').show();
                jq("#wants-pregnancy").hide();
                jq('#lmp-date :input').val('');
                jq('#lmp-details').hide();
                clearHiddenSections([ifPatientPregnant, pregIntention]);
                jq('#lmp-date :input').prop('disabled', true);
                getField('lmp-date.error').html('Please specify patient LMP Date.').hide();
            }
            if(val == 1175){
                jq('#if-patient-pregnant').hide();
                jq('#pregnancyOptionValues').hide();
                jq('#fp-details').hide();
                jq('#lmp-details').hide();
                jq("#wants-pregnancy").hide();
                jq('#lmp-date :input').val('');
                clearHiddenSections([ifPatientPregnant, pregIntention, onfpMethodChecked]);
                jq('#lmp-date :input').prop('disabled', true);
                getField('lmp-date.error').html('Please specify patient LMP Date.').hide();
            }
        }
        //Treatment supporter Validations
        function onPersonPresentChange() {
            var popType = jq("#population-type");
            var keyPop = jq("#key-population");
            var nutStatus = jq("#nutritional-status");
            var whoAdult = jq("#whoAdult");
            var whoChild = jq("#whoChild");
            var complaintsToday = jq("#complaints-today");
            var onAntTb = jq("#on-anti-tb-drugs");
            var onIPTDrugs = jq("#on-ipt");
            var everOnIPTDrugs = jq("#ever-on-ipt");
            var tbScreeningAnswers = jq("#screening-questions");
            var workupAnswers = jq("#ipt-workup");
            var iptStatus = jq("#ipt-result-status");
            var tBtestsOrdered = jq("#tb-test-ordered");
            var tBtestResults = jq("#tb-results");
            var startantiTb = jq("#startAnti-tb");
            var tbRegimen = jq("#tb-regimen");
            var familyPlanning = jq("#fplanning");
            var onfamilyPlanning = jq("#onFp");
            var notOnfamilyPlanning = jq("#notOnFp");
            var allergiesSelected = jq("#known-allergies");
            var chronicIllnessSelected = jq("#chronic-illness");
            var adverseReactionsSelected = jq("#adverse-reactions");
            var adultVaccSelected = jq('#adult-vacc');
            var childVaccSelected = jq('#child-vacc');
            var otherVaccSelected = jq('#otherVacc');
            var hasMenses = jq('#hasLMP');
            var pregOption = jq('#pregnancyOption');
            var breastfeedingOption = jq('#breastfeeding');
            var preIntention = jq('#pregnancyIntention');
            var generalExamSelected = jq('#general-exam-findings');
            var systemsFindingsSelected = jq('#systems-review');
            var skinFindingsSelected = jq('.skin-findings');
            var eyeFindingsSelected = jq('.eye-findings');
            var entFindingsSelected = jq('.ent-findings');
            var chestFindingsSelected = jq('.chest-findings');
            var cvsFindingsSelected = jq('.cvs-findings');
            var abdomenFindingsSelected = jq('.abdomen-findings');
            var cnsFindingsSelected = jq('.cns-findings');
            var gusFindingsSelected = jq('.gus-findings');
            var stabilityAssessment = jq(".stability-details");

            if (getValue('person-present.value') == SELF ) {
                jq('.patient-details :input').prop('disabled', false);
                jq('#greencard').smartWizard('enableFinish', false);
                jq(".stability-details").show();
                jq("#difcom").show();
                jq(".phdp").show();
            } else {
                complaintSelected();
                knownAllergiesSelected();
                chronicIllnessesSelected();
                adverseReactionSelected();
                if(getValue('person-present.value') == REFILL_DOCUMENTATION){
                    jq('.refill-facility').show();
                }
                jq(".on-art").hide();
                jq('#dlgAdherenceScreening').hide();
//jq("#tbl-phdp").hide();
                jq("#tbl-ctx-adherence").hide();
                jq("#tbl-dap-adherence").hide();
                jq(".stability-details").hide();
                jq("#difcom").hide();
                jq(".phdp").hide();
                jq("#refill-label").hide();
                jq("#refill-date").hide();
                jq('.patient-details :input').prop('disabled', true);
                jq('#greencard').smartWizard('goToStep', 4);
                jq('#greencard').smartWizard('enableFinish', true);
                clearRadios([popType, keyPop, whoAdult, whoChild, nutStatus, complaintsToday, onAntTb, onIPTDrugs, everOnIPTDrugs, tbScreeningAnswers,
                    workupAnswers, iptStatus, tBtestsOrdered, tBtestResults, startantiTb, tbRegimen, allergiesSelected, chronicIllnessSelected, adverseReactionsSelected,
                    adultVaccSelected, childVaccSelected, otherVaccSelected, hasMenses, pregOption, breastfeedingOption, preIntention, familyPlanning, onfamilyPlanning, notOnfamilyPlanning, generalExamSelected, systemsFindingsSelected,
                    skinFindingsSelected, eyeFindingsSelected, entFindingsSelected, chestFindingsSelected, cvsFindingsSelected, abdomenFindingsSelected, cnsFindingsSelected, gusFindingsSelected, stabilityAssessment]);
                jq('#weight input').val('');
                jq('#height input').val('');
                jq('#muac input').val('');
                jq('#calculated-bmi').html('');
                jq('#other-vacc input').val('');
                jq('#lmp-date input').val('');
                jq('#diagnosis-type input').val('');
                jq('#treatment-plan textarea').val('');
                jq('#clinical-notes textarea').val('');
                jq('.skin-notes textarea').val('');
                jq('.eye-notes textarea').val('');
                jq('.ent-notes textarea').val('');
                jq('.chest-notes textarea').val('');
                jq('.cvs-notes textarea').val('');
                jq('.abdomen-notes textarea').val('');
                jq('.cns-notes textarea').val('');
                jq('.gus-notes textarea').val('');
                jq('#temp input').val('');
                jq('#pulse input').val('');
                jq('#systolic input').val('');
                jq('#diastolic input').val('');
                jq('#resp input').val('');
                jq('#oxygen input').val('');
                jq('#tbrxdate input').val('');
            }
        }
        function onVisitScheduledChange() {
            var personPresent = getValue('person-present.value');
            var visitScheduled = getValue('visit-scheduled.value');
            if (visitScheduled != null &amp;&amp; (personPresent == TS || personPresent == REFILL_DOCUMENTATION)) {
                jq('.patient-details :input').prop('disabled', true);
                jq('#greencard').smartWizard('goToStep', 4);
                jq('#greencard').smartWizard('enableFinish', true);
            }
        }

        function onParityChange() {
            var gravida = '';
            var parityTerm = parseInt(getValue('parity-term.value'));
            var parityAbortion = parseInt(getValue('parity-abortion.value'));
            if (!isNaN(parityTerm) &amp;&amp; !isNaN(parityAbortion)) {
                gravida = parityTerm + parityAbortion + 1;
                getField('gravida.value').val(gravida);
            }
        }
        var generalExamSelected = function(){
            var val = jq(this).val();
            var generalExamsChecked = jq("#general-exam-findings input:checkbox:checked");
            if(val == 1107 &amp;&amp; generalExamsChecked.length ==1){
                jq("#general-exam-findings input[type=checkbox]").prop("disabled",true);
                jq(this).prop("disabled",false);
            }else {
                jq("#general-exam-findings input[type=checkbox]").prop("disabled",false);
                jq("#general-exam-findings input[value=1107]").prop("disabled",true);
            }
            if(generalExamsChecked.length ==0){
                jq("#general-exam-findings input[value=1107]").prop("disabled",false);
            }
        }
        var complaintSelected = function() {
            var val = getValue('complaints-today.value');
            var complaint = jq('.complaint select').val('');
            var complaintDuration = jq('.complaint-time input').val('');
            var complaintDate = jq('.complaint-date input').val('');
            if (val == "false" || val == 1066){
                jq("#tbl-complaints-today").hide();
                clearHiddenSections([complaint, complaintDuration, complaintDate]);
                getField('complaint-field.error').html('Please specify the complaints.').hide();
            }else {
                jq("#tbl-complaints-today").show();
            }
        }
        var complaintDurationInput = function() {
            var table = document.getElementById("tbl-complaints-today");
            for (var i = 0, row; row = table.rows[i]; i++) {
                var val = jq(this).closest('tr').find(".complaint-time input").val();
                var encounterDate = new Date(getValue('encounter-date.value'));
                var formattedComplaintDate = moment(moment(encounterDate, 'YYYY-MM-DD').subtract(val, 'days').toDate()).format('YYYY-MM-DD');
                if(val >0 ) {
                    jq(this).closest('tr').find(".complaint-date input").val(formattedComplaintDate);
                }
            }
        }
        var adverseReactionSelected = function() {
            var val = getValue('adverse-reactions.value');
            var medicineCausing= jq('.medicine-causing select').val('');
            var reaction = jq('.reaction select').val('');
            var severity = jq('.severity select').val('');
            var onsetDate = jq('.adverse-events-onset-date input').val('');
            var action = jq('.action-taken select').val('');
            if (val == "false" || val == 1066){
                jq("#tbl-adverse-reactions").hide();
                clearHiddenSections([medicineCausing, reaction, severity, onsetDate, action]);
                getField('adverse.error').html('Please specify the adverse drug reactions.').hide();
            }else {
                jq("#tbl-adverse-reactions").show();
            }
        }
        var knownAllergiesSelected = function() {
            var val = getValue('known-allergies.value');
            var allergy = jq('.allergen select').val('');
            var reaction = jq('.reaction select').val('');
            var severity = jq('.severity select').val('');
            var date = jq('.allergy-date input').val('');
            if (val == "false" || val == 1066){
                jq("#tbl-known-allergies").hide();
                clearHiddenSections([allergy, reaction, severity, date]);
                getField('allergy-field.error').html('Please specify the allergy.').hide();
            }else {
                jq("#tbl-known-allergies").show();
            }
        }
        var systemsReviewSelected = function() {
            var val = jq(this).val();
            var skinFindings = jq('.skin-findings');
            var skinNotes = jq('.skin-notes textarea').val('');
            var eyeFindings = jq('.eye-findings');
            var eyeNotes = jq('.eye-notes textarea').val('');
            var entFindings = jq('.ent-findings');
            var entNotes = jq('.ent-notes textarea').val('');
            var chestFindings = jq('.chest-findings');
            var chestNotes = jq('.chest-notes textarea').val('');
            var cvsFindings = jq('.cvs-findings');
            var cvsNotes = jq('.cvs-notes textarea').val('');
            var abdomenFindings = jq('.abdomen-findings');
            var abdomenNotes = jq('.abdomen-notes textarea').val('');
            var cnsFindings = jq('.cns-findings');
            var cnsNotes = jq('.cns-notes textarea').val('');
            var gusFindings = jq('.gus-findings');
            var gusNotes = jq('.gus-notes textarea').val('');
            if (val == 1115){
                jq("#tbl-systems-review").hide();
                clearHiddenSections([skinFindings, skinNotes, eyeFindings, eyeNotes, entFindings, entNotes, chestFindings, chestNotes, cvsFindings, cvsNotes, abdomenFindings, abdomenNotes, cnsFindings, cnsNotes, gusFindings, gusNotes]);
            }else {
                jq("#tbl-systems-review").show();
            }
        }
        var chronicIllnessesSelected = function() {
            var val = getValue('chronic-illness.value');
            var illness = jq('.illness-chronic select').val('');
            var onset = jq('.onset-date-chronic-illness input').val('');
            if (val == "false" || val == 1066){
                jq("#tbl-chronic-illness").hide();
                clearHiddenSections([illness, onset]);
                getField('chronic.error').html('Please specify the chronic illness.').hide();
            }else {
                jq("#tbl-chronic-illness").show();
            }
        }
        var screenedStiSelected = function() {
            var val = jq(this).val();
            var partnerNotification = jq("#tbl-partner-notification");
            if (val == 703){
                jq("#tbl-partner-notification").show();

            }else {
                jq("#tbl-partner-notification").hide();
                clearHiddenSections([partnerNotification]);
            }
        }
        var onAntiTbDrugs = function(){
            var val = jq(this).val();
            var onIpt = jq('#on-ipt');
            var actionTakenTab = jq('#action-taken');
            var iptClientWorkupTab = jq('#ipt-client-workup');
            var iptFollowup = jq('#ipt-followup');
            var tbScreeningQuestionsTab = jq("#tb-screening-tab");
            var iptInitiationTab = jq('#ipt-initiation');
            var iptEnrollmentTab = jq('#ipt-enrollment');
            var tbInitiationTab = jq('#tb-enrollment');
            everOnIPTSelected = null;
            patientCurrentlyOnIPT = null;
            if(val == 1066) {
                jq('#on-ipt input').prop("disabled", false);
            }
            if(val == 1065){
                jq('#on-ipt input').prop("disabled", true);
                jq('input[type=radio].on-ipt').prop("checked", false);
                jq("#tb-screening-result").hide();
                jq("#tb-screening-tab").hide();
                jq("#tbl-ever-on-ipt").hide();
                clearRadios([onIpt, actionTakenTab, iptClientWorkupTab, iptFollowup, tbScreeningQuestionsTab]);
                actionTakenTab.hide();
                iptClientWorkupTab.hide();
                iptFollowup.hide();
                tbScreeningQuestionsTab.hide();
                iptInitiationTab.hide();
                iptEnrollmentTab.hide();
                tbInitiationTab.hide();
            }
        }
        var onIPT = function(){
            var val = jq(this).val();
            patientCurrentlyOnIPT = val;
            everOnIPTSelected = null;
            var everOnIpt = jq("#tbl-ever-on-ipt");
            var actionTakenTab = jq('#action-taken');
            var iptClientWorkupTab = jq('#ipt-client-workup');
            var iptFollowup = jq('#ipt-followup');
            var tbScreeningQuestionsTab = jq("#tb-screening-tab");
            var iptInitiationTab = jq('#ipt-initiation');
            var iptEnrollmentTab = jq('#ipt-enrollment');
            var tbScreeningResult = jq("#tb-screening-result");
            var tbScreeningResultsStatus = jq("#tb-result-status");

            if(val == 1065 &amp;&amp; PATIENT_ON_IPT == 'true') {
                jq("#tbl-ever-on-ipt").hide();
                jq("#ipt-followup").show();
                tbScreeningQuestionsTab.show();
                tbScreeningResult.hide();
                iptClientWorkupTab.hide();
                actionTakenTab.hide();
                iptInitiationTab.hide();
                iptEnrollmentTab.hide();
                clearRadios([iptClientWorkupTab, actionTakenTab, tbScreeningResultsStatus]);
            }
            if(val == 1065 &amp;&amp; PATIENT_ON_IPT == 'false') {
                jq("#tbl-ever-on-ipt").hide();
                jq("#ipt-followup").hide();
                tbScreeningQuestionsTab.show();
                tbScreeningResult.hide();
                iptClientWorkupTab.hide();
                actionTakenTab.hide();
                iptInitiationTab.hide();
                iptEnrollmentTab.show();
                clearRadios([iptClientWorkupTab, actionTakenTab, tbScreeningResultsStatus]);
            }
            if(val == 1066) {
                jq("#tbl-ever-on-ipt").show();
                iptFollowup.hide();
                actionTakenTab.hide();
                tbScreeningQuestionsTab.hide();
                tbScreeningResult.hide();
                iptInitiationTab.hide();
                iptEnrollmentTab.hide();
                clearRadios([everOnIpt, iptFollowup, actionTakenTab, tbScreeningQuestionsTab, tbScreeningResult, tbScreeningResultsStatus]);
            }
        }
        var everOnIPT = function () {
            var val = jq(this).val();
            everOnIPTSelected = val;
            var tbScreeningResults = jq("#tb-screening-result");
            var tbScreeningResultsStatus = jq("#tb-result-status");
            var tbScreeningTab = jq("#tb-screening-tab");
            var iptClientWorkupTab = jq('#ipt-client-workup');
            var actionTakenTab = jq('#action-taken');
            var iptInitiationTab = jq('#ipt-initiation');
            var iptEnrollmentTab = jq('#ipt-enrollment');
            if(val == 1066) {
                // show TB screening, TB results and TPT workup forms
                tbScreeningTab.show();
                tbScreeningResults.hide();
                iptClientWorkupTab.hide();
                actionTakenTab.hide();
                clearRadios([iptClientWorkupTab, tbScreeningTab, actionTakenTab, tbScreeningResultsStatus]);
            }
            if(val == 1065) {
// show TB screening and TB result forms
                iptClientWorkupTab.hide();
                tbScreeningTab.show();
                actionTakenTab.hide();
                iptInitiationTab.hide();
                iptEnrollmentTab.hide();
                clearRadios([iptClientWorkupTab, tbScreeningTab, actionTakenTab, tbScreeningResultsStatus]);
            }
        }
        var ageGroup = function () {
            if (pAge &gt; 15) {
                whoChild.style.display='none';
            }
            if (pAge &lt; 16) {
                whoAdult.style.display='none';
            }
        }
        var populationTypeSelected = function () {
            var val = jq(this).val();
            var keypop = jq('#key-population');
            if (val == 164929 ){
                jq("#key-population").show();
            }
            if(val == 164928){
                jq("#key-population").hide();
                clearHiddenSections([keypop]);
            }
        }
        //Resulting TB status for Ordered test
        var testOrdered  = function () {
            var val = jq(this).val();
            var testOrderedChecked = jq("#tb-test-ordered input:checkbox:checked");
            var sputumSmear = getValue("sputum-smear-action.value");
            var geneXpert = getField("genexpert-action.value").val();
            var referral = getValue("referral-action.value");
            var clinicalDiagnosis = getValue("clinical-diagnosis-action.value");
            var xray = getValue("chest-xray-action.value");

//No signs with without abnormal xray
            if((clinicalDiagnosis !=703 || sputumSmear !=703 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &lt; 0 || xray !=152526)){
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tb-screening-result").show();
            }
//No signs with normal xray results
            if((clinicalDiagnosis !=703 || sputumSmear ==664 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &lt; 0 &amp;&amp; xray ==1115)){
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tb-screening-result").show();
            }
//No signs with negative clinical diagnosis normal xray results with normal sputum smear
            if((clinicalDiagnosis ==664 || sputumSmear ==664 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &lt; 0 &amp;&amp; xray ==1115)){
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tb-screening-result").show();
            }
//Presumed TB  with negative clinical diagnosis normal xray results with normal sputum smear
            if((clinicalDiagnosis ==664 || sputumSmear ==664 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &gt; 0 || xray ==152526)){
                jq("#tb-result-status input[value=1660]").prop("checked", false);
                jq("#tb-result-status input[value=142177]").prop("checked", true);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tb-screening-result").show();
            }
//Presumed TB  with  tests or abnormal xray
            if((clinicalDiagnosis !=703 || sputumSmear ==664 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &gt; 0 || xray ==152526)){
                jq("#tb-result-status input[value=1660]").prop("checked", false);
                jq("#tb-result-status input[value=142177]").prop("checked", true);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tb-screening-result").show();
            }
//TB confirmed
            if(clinicalDiagnosis ==703 || sputumSmear ==703 || geneXpert ==162203 || geneXpert ==162204 || geneXpert ==164104) {
                jq("#tb-result-status input[value=1660]").prop("checked", false);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", true);
                jq('#ipt-client-workup').hide();
                jq("#tbl-start-antiTb").show();
                jq("#tb-screening-result").show();
            }

        }
        //Resulting TB status for Action Positive Sputum smear
        var sputumSmearAction  = function () {
            var sputumSmear = getValue("sputum-smear-action.value");
            var geneXpert = getField("genexpert-action.value").val();
            var clinicalDiagnosis = getValue("clinical-diagnosis-action.value");
            var xray = getValue("chest-xray-action.value");
            var referral = getValue("referral-action.value");
            var testOrderedChecked = jq("#tb-test-ordered input:checkbox:checked");
//No signs without abnormal xray
            if((clinicalDiagnosis !=703 || sputumSmear !=703 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &lt; 0 || xray !=152526)){
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tb-screening-result").show();
            }
//No signs without abnormal xray with  negative sputum smear
            if((clinicalDiagnosis !=703 || sputumSmear ==664 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &lt; 0 || xray !=152526)){
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tbl-start-antiTb").hide();
                jq("#tb-screening-result").show();
            }
//No signs with normal xray results with normal sputum smear
            if((clinicalDiagnosis !=703 || sputumSmear ==664 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &lt; 0 &amp;&amp; xray ==1115)){
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tb-screening-result").show();
            }
//No signs with negative clinical diagnosis normal xray results with normal sputum smear
            if((clinicalDiagnosis ==664 || sputumSmear ==664 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &lt; 0 &amp;&amp; xray ==1115)){
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tb-screening-result").show();
            }
//Presumed TB  with negative clinical diagnosis normal xray results with normal sputum smear
            if((clinicalDiagnosis ==664 || sputumSmear ==664 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &gt; 0 || xray ==152526)){
                jq("#tb-result-status input[value=1660]").prop("checked", false);
                jq("#tb-result-status input[value=142177]").prop("checked", true);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tb-screening-result").show();
            }
//Presumed TB  with  tests or abnormal xray with normal sputum smear
            if((clinicalDiagnosis !=703 || sputumSmear ==664 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &gt; 0 || xray ==152526)){
                jq("#tb-result-status input[value=1660]").prop("checked", false);
                jq("#tb-result-status input[value=142177]").prop("checked", true);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tb-screening-result").show();
            }
//TB confirmed with positive sputum smear
            if(clinicalDiagnosis ==703 || sputumSmear ==703 || geneXpert ==162203 || geneXpert ==162204 || geneXpert ==164104) {
                jq("#tb-result-status input[value=1660]").prop("checked", false);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", true);
                jq('#ipt-client-workup').hide();
                jq("#tbl-start-antiTb").show();
                jq("#tb-screening-result").show();
            }
        }
        //Resulting TB status for Action Positive GeneXpert
        var geneXpertAction  = function () {
            var geneXpert = getField("genexpert-action.value").val();
            var sputumSmear = getValue("sputum-smear-action.value");
            var clinicalDiagnosis = getValue("clinical-diagnosis-action.value");
            var xray = getValue("chest-xray-action.value");
            var referral = getValue("referral-action.value");
            var testOrderedChecked = jq("#tb-test-ordered input:checkbox:checked");
//No signs without abnormal xray
            if((clinicalDiagnosis !=703 || sputumSmear !=703 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &lt; 0 || xray !=152526)){
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tb-screening-result").show();
            }
//No signs without abnormal xray with  negative sputum smear
            if((clinicalDiagnosis !=703 || sputumSmear ==664 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &lt; 0 || xray !=152526)){
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tbl-start-antiTb").hide();
                jq("#tb-screening-result").show();
            }
//No signs with normal xray results with normal sputum smear
            if((clinicalDiagnosis !=703 || sputumSmear ==664 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &lt; 0 &amp;&amp; xray ==1115)){
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tb-screening-result").show();
            }
//No signs with negative clinical diagnosis normal xray results with normal sputum smear
            if((clinicalDiagnosis ==664 || sputumSmear ==664 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &lt; 0 &amp;&amp; xray ==1115)){
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tb-screening-result").show();
            }
//Presumed TB  with negative clinical diagnosis normal xray results with normal sputum smear
            if((clinicalDiagnosis ==664 || sputumSmear ==664 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &gt; 0 || xray ==152526)){
                jq("#tb-result-status input[value=1660]").prop("checked", false);
                jq("#tb-result-status input[value=142177]").prop("checked", true);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tb-screening-result").show();
            }
//Presumed TB  with  tests or abnormal xray with normal sputum smear
            if((clinicalDiagnosis !=703 || sputumSmear ==664 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &gt; 0 || xray ==152526)){
                jq("#tb-result-status input[value=1660]").prop("checked", false);
                jq("#tb-result-status input[value=142177]").prop("checked", true);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tb-screening-result").show();
            }
//TB confirmed with positive sputum smear
            if(clinicalDiagnosis ==703 || sputumSmear ==703 || geneXpert ==162203 || geneXpert ==162204 || geneXpert ==164104) {
                jq("#tb-result-status input[value=1660]").prop("checked", false);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", true);
                jq('#ipt-client-workup').hide();
                jq("#tbl-start-antiTb").show();
                jq("#tb-screening-result").show();
            }
        }
        //Resulting TB status for Abnormal chest x ray
        var chestXrayAction = function () {
            var xray = getValue("chest-xray-action.value");
            var sputumSmear = getValue("sputum-smear-action.value");
            var geneXpert = getField("genexpert-action.value").val();
            var referral = getValue("referral-action.value");
            var clinicalDiagnosis = getValue("clinical-diagnosis-action.value");
            var testOrderedChecked = jq("#tb-test-ordered input:checkbox:checked");
//No signs without abnormal xray
            if((clinicalDiagnosis !=703 || sputumSmear !=703 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &lt; 0 || xray !=152526)){
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tb-screening-result").show();
            }
//No signs without abnormal xray with  negative sputum smear
            if((clinicalDiagnosis !=703 || sputumSmear ==664 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &lt; 0 || xray !=152526)){
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tbl-start-antiTb").hide();
                jq("#tb-screening-result").show();
            }
//No signs with normal xray results with normal sputum smear
            if((clinicalDiagnosis !=703 || sputumSmear ==664 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &lt; 0 &amp;&amp; xray ==1115)){
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tb-screening-result").show();
            }
//No signs with negative clinical diagnosis normal xray results with normal sputum smear
            if((clinicalDiagnosis ==664 || sputumSmear ==664 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &lt; 0 &amp;&amp; xray ==1115)){
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tb-screening-result").show();
            }
//Presumed TB  with negative clinical diagnosis normal xray results with normal sputum smear
            if((clinicalDiagnosis ==664 || sputumSmear ==664 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &gt; 0 || xray ==152526)){
                jq("#tb-result-status input[value=1660]").prop("checked", false);
                jq("#tb-result-status input[value=142177]").prop("checked", true);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tb-screening-result").show();
            }
//Presumed TB  with  tests or abnormal xray with normal sputum smear
            if((clinicalDiagnosis !=703 || sputumSmear ==664 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &gt; 0 || xray ==152526)){
                jq("#tb-result-status input[value=1660]").prop("checked", false);
                jq("#tb-result-status input[value=142177]").prop("checked", true);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tb-screening-result").show();
            }
//TB confirmed with positive sputum smear
            if(clinicalDiagnosis ==703 || sputumSmear ==703 || geneXpert ==162203 || geneXpert ==162204 || geneXpert ==164104) {
                jq("#tb-result-status input[value=1660]").prop("checked", false);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", true);
                jq('#ipt-client-workup').hide();
                jq("#tbl-start-antiTb").show();
                jq("#tb-screening-result").show();
            }
        }
        //Resulting TB status for Action Referral
        var referralAction  = function () {
            var referral = getValue("referral-action.value");
            var sputumSmear = getValue("sputum-smear-action.value");
            var geneXpert = getField("genexpert-action.value").val();
            var clinicalDiagnosis = getValue("clinical-diagnosis-action.value");
            var xray = getValue("chest-xray-action.value");
            var testOrderedChecked = jq("#tb-test-ordered input:checkbox:checked");
//No signs without abnormal xray
            if((clinicalDiagnosis !=703 || sputumSmear !=703 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &lt; 0 || xray !=152526)){
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tb-screening-result").show();
            }
//No signs without abnormal xray with  negative sputum smear
            if((clinicalDiagnosis !=703 || sputumSmear ==664 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &lt; 0 || xray !=152526)){
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tbl-start-antiTb").hide();
                jq("#tb-screening-result").show();
            }
//No signs with normal xray results with normal sputum smear
            if((clinicalDiagnosis !=703 || sputumSmear ==664 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &lt; 0 &amp;&amp; xray ==1115)){
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tb-screening-result").show();
            }
//No signs with negative clinical diagnosis normal xray results with normal sputum smear
            if((clinicalDiagnosis ==664 || sputumSmear ==664 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &lt; 0 &amp;&amp; xray ==1115)){
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tb-screening-result").show();
            }
//Presumed TB  with negative clinical diagnosis normal xray results with normal sputum smear
            if((clinicalDiagnosis ==664 || sputumSmear ==664 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &gt; 0 || xray ==152526)){
                jq("#tb-result-status input[value=1660]").prop("checked", false);
                jq("#tb-result-status input[value=142177]").prop("checked", true);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tb-screening-result").show();
            }
//Presumed TB  with  tests or abnormal xray with normal sputum smear
            if((clinicalDiagnosis !=703 || sputumSmear ==664 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &gt; 0 || xray ==152526)){
                jq("#tb-result-status input[value=1660]").prop("checked", false);
                jq("#tb-result-status input[value=142177]").prop("checked", true);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tb-screening-result").show();
            }
//TB confirmed with positive sputum smear
            if(clinicalDiagnosis ==703 || sputumSmear ==703 || geneXpert ==162203 || geneXpert ==162204 || geneXpert ==164104) {
                jq("#tb-result-status input[value=1660]").prop("checked", false);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", true);
                jq('#ipt-client-workup').hide();
                jq("#tbl-start-antiTb").show();
                jq("#tb-screening-result").show();
            }
        }
        //Resulting TB status for Action clinical diagnosis
        var clinicalDiagnosisAction  = function () {
            var clinicalDiagnosis = getValue("clinical-diagnosis-action.value");
            var sputumSmear = getValue("sputum-smear-action.value");
            var xray = getValue("chest-xray-action.value");
            var referral = getValue("referral-action.value");
            var geneXpert = getField("genexpert-action.value").val();
            var testOrderedChecked = jq("#tb-test-ordered input:checkbox:checked");
            var iptFollowup = jq('#ipt-followup');
//No signs without abnormal xray
            if((clinicalDiagnosis !=703 || sputumSmear !=703 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &lt; 0 || xray !=152526)){
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tb-screening-result").show();
            }
//No signs without abnormal xray with  negative sputum smear
            if((clinicalDiagnosis !=703 || sputumSmear ==664 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &lt; 0 || xray !=152526)){
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tbl-start-antiTb").hide();
                jq("#tb-screening-result").show();
            }
//No signs with normal xray results with normal sputum smear
            if((clinicalDiagnosis !=703 || sputumSmear ==664 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &lt; 0 &amp;&amp; xray ==1115)){
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tb-screening-result").show();
            }
//No signs with negative clinical diagnosis normal xray results with normal sputum smear
            if((clinicalDiagnosis ==664 || sputumSmear ==664 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &lt; 0 &amp;&amp; xray ==1115)){
                jq("#tb-result-status input[value=1660]").prop("checked", true);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tb-screening-result").show();
            }
//Presumed TB  with negative clinical diagnosis normal xray results with normal sputum smear
            if((clinicalDiagnosis ==664 || sputumSmear ==664 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &gt; 0 || xray ==152526)){
                jq("#tb-result-status input[value=1660]").prop("checked", false);
                jq("#tb-result-status input[value=142177]").prop("checked", true);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tb-screening-result").show();
            }
//Presumed TB  with  tests or abnormal xray with normal sputum smear
            if((clinicalDiagnosis !=703 || sputumSmear ==664 || geneXpert !=162203 || geneXpert !=162204 || geneXpert !=164104) &amp;&amp; (testOrderedChecked.length &gt; 0 || xray ==152526)){
                jq("#tb-result-status input[value=1660]").prop("checked", false);
                jq("#tb-result-status input[value=142177]").prop("checked", true);
                jq("#tb-result-status input[value=1662]").prop("checked", false);
                jq('#ipt-client-workup').hide();
                jq("#tb-screening-result").show();
            }
//TB confirmed with positive sputum smear
            if(clinicalDiagnosis ==703 || sputumSmear ==703 || geneXpert ==162203 || geneXpert ==162204 || geneXpert ==164104) {
                jq("#tb-result-status input[value=1660]").prop("checked", false);
                jq("#tb-result-status input[value=142177]").prop("checked", false);
                jq("#tb-result-status input[value=1662]").prop("checked", true);
                jq('#ipt-client-workup').hide();
                jq("#tbl-start-antiTb").show();
                jq("#tb-screening-result").show();
            }
        }
        //Resulting TB status for Action start anti tb
        var startAntiTbAction  = function () {
            var startAntiTb = getValue("start-anti-tb-action.value");
            var sputumSmear = getValue("sputum-smear-action.value");
            var xray = getValue("chest-xray-action.value");
            var testOrderedChecked = jq("#tb-test-ordered input:checkbox:checked");
            if(startAntiTb ==1065){
                jq("#tb-result-status input[value=1662]").prop("disabled", false);
                jq("#tb-result-status input[value=1662]").prop("checked", true);
                jq("#tb-result-status.input[value=142177]").prop("disabled", true);
                jq("#tb-result-status.input[value=1660]").prop("disabled", true);
                jq("#tb-result-status.input[value=160737]").prop("disabled", true);
                jq("#tb-referral :input").prop("disabled", true);
                jq('#tb-enrollment').show();
                jq('#ipt-client-workup').hide();
                jq('#ipt-initiation').hide();
                jq('#ipt-enrollment').hide();
                jq('#ipt-result-status').hide();
//set TB RX date to todays date
                var encounterDate = getValue('encounter-date.value');
                var momentEncounterDate =moment(moment(encounterDate,'YYYY-MM-DD').toDate()).format("DD-MMM-YYYY");
                getField('tbrxdate.value').val(momentEncounterDate);

            }
            if(startAntiTb ==1066 ){
                jq("#tb-referral :input").prop("disabled", false);
                getField('tbrxdate.value').val("");
                jq("#tbrxdate :input").prop("disabled", true);
                jq('#tb-regimen select').prop("disabled", true);
                jq('#tb-enrollment').hide();
            }
        }

        //Prophylaxis selected
        var prophylaxisSelected  = function () {
            var prophylaxisUsed = getValue('prophylaxis-used.value');
            var ctxAdherence = jq('#ctx-adherence');
            var ctxDispensed = jq('#ctx-dispensed');
            var dapsoneAdherence = jq('#dapsone-adherence');
            var dapsoneDispensed = jq('#dapsone-dispensed');
            if(prophylaxisUsed == 105281){
                jq("#ctx-part").show();
                jq("#dapsone-part").hide();
                clearHiddenSections([dapsoneAdherence, dapsoneDispensed]);
            }
            if(prophylaxisUsed == 74250){
                jq("#dapsone-part").show();
                jq("#ctx-part").hide();
                clearHiddenSections([ctxAdherence,ctxDispensed]);
            }
            if(prophylaxisUsed == 1107){
                jq("#dapsone-part").hide();
                jq("#ctx-part").hide();
                clearHiddenSections([ctxAdherence,ctxDispensed, dapsoneAdherence, dapsoneDispensed]);
            }
        }
        //Morisky assessment
        var adherenceAssessment  = function () {
            var val = jq(this).val();
            const YES_CONCEPT_ID = 1065;
            const NO_CONCEPT_ID = 1066;
            var assessmentRadios = jq('#adherence-1').find('input[type=radio]');
            var assessmentYesResponses = [];
            var assessmentNoResponses = [];
//Fetch responses for the assessment questions
            jq.each(assessmentRadios, function(){
//Push any responses to the respective assessmentYesResponses and assessmentNoResponses array
                if (this.value == YES_CONCEPT_ID &amp;&amp; this.checked == true) {
                    assessmentYesResponses.push(this);
                }
                if (this.value == NO_CONCEPT_ID &amp;&amp; this.checked == true) {
                    assessmentNoResponses.push(this);
                }
            });
//If no responses have been recorded then prompt since this assessment is mandatory
            if (assessmentYesResponses.length == 0 &amp;&amp; assessmentNoResponses.length == 0 ) {
//Prompt to complete assessment
            }else{
                if(assessmentYesResponses.length &gt; 0) {
                    jq('#adherence-2').show();
                }
                if(assessmentYesResponses.length == 0) {
                    jq("#arv-adherence input[value=159405]").prop("checked", true);
                    jq('#adherence-2').hide();
                }
                if(assessmentYesResponses.length == 1 || assessmentYesResponses.length == 2 ) {
                    jq("#arv-adherence input[value=163794]").prop("checked", true);
                    jq('#adherence-2').show();
                }
                if(assessmentYesResponses.length == 3 || assessmentYesResponses.length == 4 ) {
                    jq("#arv-adherence input[value=159407]").prop("checked", true);
                    jq('#adherence-2').show();
                }
            }
        }
        var closeAdherenceAssessment  = function () {
            var x = jq("#modalContents");
            x.dialog('close');
        }
        //stability selected
        var stabilitySelected = function() {
            var stabilityStatus = getValue('stability.value');
            var tca_reason = getField('returnVisitReason.value').val();
            var refillDate = jq("#refill-date").hide();
            if (stabilityStatus == "false" || stabilityStatus == 1066){
                jq("#tbl-standard").show();
                jq("#tbl-fast-track").hide();
                jq("#refill-label").hide();
                jq("#refill-date").hide();
                jq('#standard select').prop('disabled', false);
                jq('#fast-track select').prop('disabled', true);
// clearHiddenSections([refillDate]);
            }else {
                jq("#tbl-fast-track").show();
                jq("#tbl-standard").hide();
                jq('#fast-track select').prop('disabled', false);
                jq('#standard select').prop('disabled', true);
            }
        }
        var returnReasonSelected = function() {
            var stabilityStatus = getValue('stability.value');
            var tca_reason = getField('returnVisitReason.value').val();
            if (stabilityStatus == "true" &amp;&amp; tca_reason == 160521){
                jq("#refill-label").show();
                jq("#refill-date").show();
                jq('#refill-label input').prop('disabled', false);
                jq('#refill-date input').prop('disabled', false);
            }else {
                jq("#refill-label").hide();
                jq("#refill-date").hide();
                jq('#refill-label input').prop('disabled', true);
                jq('#refill-date input').prop('disabled', true);
            }
        }

        clearHiddenSections = function(parentObj) {
            for(var i=0; i &lt; parentObj.length; i++){
                parentObj[i].find('input[type=radio]').each(function() {
                    this.checked = false;
                });
                parentObj[i].find('input[type=checkbox]').each(function() {
                    this.checked = false;
                });
                parentObj[i].find('input[type=text]').each(function() {
                    this.val("");
                });
                parentObj[i].find('select').each(function() {
                    this.selectedIndex =0;
                });

            }
        }
        //Smart wizard validations
        function onLeaveStepValidation (obj, context) {
            var stepNumFrom = context.fromStep;
            var stepNumTo = context.toStep;
//Validations steps
            if (stepNumFrom == 1)  {
                return step1Validation();
            }
            else if (stepNumFrom == 2 &amp;&amp; stepNumTo &gt; stepNumFrom) {
                return step2Validation();
            }
            else if (stepNumFrom == 3 &amp;&amp; stepNumTo &gt; stepNumFrom) {
                return step3Validation();
            }
            else if (stepNumFrom == 4 &amp;&amp; stepNumTo &gt; stepNumFrom) {
                return step4Validation();
            }
            else {

                return true;
            }
        }
        function step1Validation(){    //Step 1 validations
            var recentWHO = "<lookup expression="fn.latestObs(5356).getValueCoded()"/>";
            var personPresent =getValue('person-present.value');
            var visit_scheduled =getValue('visit-scheduled.value');
            var patientWeight =getValue('weight.value');
            var patientHeight =getValue('height.value');
            var populationType =getValue('population-type.value');
            var adultWhoStage =getField('whoStage-adult.value').val();
            var childWhoStage =getField('whoStage-child.value').val();

            if (visit_scheduled == false) {
                jq('#greencard').smartWizard('setError', {stepnum: 1, iserror: true});
                getField('visit-scheduled.error').html('Visit type is required').show();
                return false;
            }else{
                getField('visit-scheduled.error').html('Visit type is required.').hide();
            }
            if (personPresent == false) {
                jq('#greencard').smartWizard('setError', {stepnum: 1, iserror: true});
                getField('person-present.error').html('Please specify person present').show();
                return false;
            }else{
                getField('person-present.error').html('Please specify person present').hide();
            }
            if (patientWeight == false &amp;&amp; personPresent == SELF) {
                jq('#greencard').smartWizard('setError', {stepnum: 1, iserror: true});
                getField('weight.error').html('Please specify patient weight').show();
                return false;
            }else{
                getField('weight.error').html('Please specify patient weight').hide();
            }
            if (patientHeight == false &amp;&amp; personPresent == SELF) {
                jq('#greencard').smartWizard('setError', {stepnum: 1, iserror: true});
                getField('height.error').html('Please specify patient height').show();
                return false;
            }else{
                getField('height.error').html('Please specify patient height').hide();
            }
            if (populationType == false &amp;&amp; personPresent == SELF) {
                jq('#greencard').smartWizard('setError', {stepnum: 1, iserror: true});
                getField('population-type.error').html('Please specify population type').show();
                return false;
            }else{
                getField('population-type.error').html('Please specify population type').hide();
            }
            if (recentWHO =="" &amp;&amp; pAge &gt; 15 &amp;&amp; adultWhoStage == false &amp;&amp; personPresent == SELF ) {
                jq('#greencard').smartWizard('setError', {stepnum: 1, iserror: true});
                getField('whoStage-adult.error').html('Please specify adult WHO stage').show();
                return false;
            }else{
                getField('whoStage-adult.error').html('Please specify adult WHO stage').hide();
            }
            if (recentWHO =="" &amp;&amp; pAge &lt; 16 &amp;&amp; childWhoStage == false &amp;&amp; personPresent == SELF) {
                jq('#greencard').smartWizard('setError',{stepnum:1,iserror:true});
                getField('whoStage-child.error').html('Please specify child WHO stage').show();
                return false;
            }
            else {
                jq('#greencard').smartWizard('showMessage',"");
                return true;
            }
        }
        function step2Validation(){     //Step 2 validations

            var personPresent =getValue('person-present.value');
            var complaint = getField('complaint-field.value').val();
            var complaintsToday = getValue('complaints-today.value');  //boolean
            var onAntiTbDrugs = getValue('on-anti-tb-drugs.value');    //non boolean
            var onIpt = getValue('on-ipt.value');
            var everOnIpt= getValue('ever-on-ipt.value');
            var allergen = getField('allergy-field.value').val();
            var knownAllergies = getValue('known-allergies.value');   //boolean
            var chronic = getField('chronic.value').val();
            var chronicIllness = getValue('chronic-illness.value');   //non boolean
            var adverse = getField('adverse.value').val();   // boolean
            var adverseReactions = getValue('adverse-reactions.value');   // boolean
            var patientHasLMP = getValue('hasLMP.value');
            var encounterDate = getValue('encounter-date.value');
            var lmpDate = getValue('lmp-date.value');
            var tbrxDate = getValue('tbrxdate.value');
            var recentLMPPresent = "<lookup expression="fn.latestObs(1427).getValueDatetime()"/>";
            var menopause = getValue('menopause.value');
            var isPregnant = getValue('pregnancyOption.value');
            var isBreastfeeding = getValue('breastfeeding.value');
            var pregnancyIntention = getValue('pregnancyIntention.value');
            var onfpMethodChecked = getField('fplanning.value').val();
            var fpMethodsChecked = jq("#onFp input:checkbox:checked");
            var notOnfpMethodsChecked = jq("#notOnFp input:checkbox:checked");
//TB validation
            var screeningRadios = jq('#screening-questions').find('input[type=radio]');
            const YES_CONCEPT_ID = 1065;
            const NO_CONCEPT_ID = 1066;
            var screeningYesResponses = [];
            var screeningNoResponses = [];
            jq.each(screeningRadios, function(){    //Fetch responses for the screening questions
//Push any responses to the respective screeningYesResponses and screeningNoResponses array
                const COUGH = 159799;
                const CONTACT = 124068;
                const FEVER = 1494;
                const WEIGHTLOSS = 832;
                const SWEAT =133027;
                const LETHERGY =116334;
//Push any responses to the respective screeningYesResponses and screeningNoResponses array
                if ((this.value == COUGH || this.value == CONTACT || this.value == FEVER || this.value == WEIGHTLOSS || this.value == SWEAT || this.value == LETHERGY )&amp;&amp; this.checked == true) {
                    screeningYesResponses.push(this);
                }
                if (this.value == NO_CONCEPT_ID &amp;&amp; this.checked == true) {
                    screeningNoResponses.push(this);
                }
            });
            if (complaintsToday == false &amp;&amp; personPresent == SELF) {
                jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                getField('complaints-today.error').html('Please specify  if patient has any complaints today.').show();
                return false;
            }else{
                getField('complaints-today.error').html('Please specify  if patient has any complaints today.').hide();
            }
            if (complaintsToday == 'true' &amp;&amp; complaint == '') {
                jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                getField('complaint-field.error').html('Please specify the complaints.').show();
                return false;
            }else{
                getField('complaint-field.error').html('Please specify the complaints.').hide();
            }
            if (onAntiTbDrugs == false &amp;&amp; personPresent == SELF) {
                jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                getField('on-anti-tb-drugs.error').html('Please specify if patient is on anti-tb drugs.').show();
                return false;
            }else{
                getField('on-anti-tb-drugs.error').html('Please specify if patient is on anti-tb drugs.').hide();
            }
            if (onAntiTbDrugs == 1066 &amp;&amp; onIpt == false) {
                jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                getField('on-ipt.error').html('Please specify if patient is currently on TPT.').show();
                return false;
            }else{
                getField('on-ipt.error').html('Please specify if patient is currently on TPT.').hide();
            }
            if (onAntiTbDrugs == 1066 &amp;&amp; onIpt == 1066 &amp;&amp; everOnIpt == false) {
                jq("#tbl-ever-on-ipt").show();    //show ever on ipt that was previously hidden
                jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                getField('ever-on-ipt.error').html('Please specify if patient has ever been on TPT.').show();
                return false;
            }else{
                getField('ever-on-ipt.error').html('Please specify if patient has ever been on TPT.').hide();
            }
//If neither yes nor no repsonsed recorder
            if (onAntiTbDrugs == 1066 &amp;&amp;  onIpt == 1066 &amp;&amp; screeningYesResponses.length == 0 &amp;&amp; screeningNoResponses.length == 0 ) {
                jq('#greencard').smartWizard('setError',{stepnum:2,iserror:true});
                getField('tb-screening-error.error').html('Please conduct TB screening.').show();
                return false;
            }else{
                getField('tb-screening-error.error').html('Please conduct TB screening.').hide();
            }
//If not completed tb screening
            if (onAntiTbDrugs == 1066 &amp;&amp; pAge &gt; 15 &amp;&amp; onIpt == 1066 &amp;&amp; screeningYesResponses.length + screeningNoResponses.length != 4 ) {
                jq('#greencard').smartWizard('setError',{stepnum:2,iserror:true});
                getField('tb-screening-error.error').html('Please complete TB screening.').show();
                return false;
            }else{
                getField('tb-screening-error.error').html('Please complete TB screening.').hide();
            }
            if (onAntiTbDrugs == 1066 &amp;&amp; pAge &lt; 16 &amp;&amp; onIpt == 1066 &amp;&amp; screeningYesResponses.length + screeningNoResponses.length != 5 ) {
                jq('#greencard').smartWizard('setError',{stepnum:2,iserror:true});
                getField('tb-screening-error.error').html('Please complete TB screening.').show();
                return false;
            }else{
                getField('tb-screening-error.error').html('Please complete TB screening.').hide();
            }
            var isTBRxDateBeforeEncounter = moment(moment(moment(encounterDate, 'YYYY-MM-DD').toDate()).format('YYYY-MM-DD')).isBefore(moment(moment(tbrxDate, 'DD-MMM-YYYY').toDate()).format('YYYY-MM-DD'));
            if (isTBRxDateBeforeEncounter) {
                jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                getField('tbrxdate.error').html('TB RX date, should  be earlier than encounter Date').show();
                return false;
            }
            var iptEventDate = jq('#ipt-event-type input[class=hasDatepicker]').val();
            var isIPTEventDateBeforeEncounter = moment(moment(moment(new Date(), 'YYYY-MM-DD').toDate()).format('YYYY-MM-DD')).isBefore(moment(moment(iptEventDate, 'DD-MMM-YYYY').toDate()).format('YYYY-MM-DD'));
            if (isIPTEventDateBeforeEncounter) {
                jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                getField('ipt-event-type.error').html('TPT outcome date, should  not be in future').show();
                return false;
            }
            if (knownAllergies == false &amp;&amp; personPresent == SELF) {
                jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                getField('known-allergies.error').html('Please specify if patient has any known allergies.').show();
                return false;
            }else{
                getField('known-allergies.error').html('Please specify if patient has any known allergies.').hide();
            }
            if (knownAllergies == 'true' &amp;&amp; allergen == '') {
                jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                getField('allergy-field.error').html('Please specify the allergy.').show();
                return false;
            }else{
                getField('allergy-field.error').html('Please specify the allergy.').hide();
            }
            if (chronicIllness == false &amp;&amp; personPresent == SELF) {
                jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                getField('chronic-illness.error').html('Please specify if patient has any chronic illness.').show();
                return false;
            }else{
                getField('chronic-illness.error').html('Please specify if patient has any chronic illness.').hide();
            }
            if (chronicIllness == 1065 &amp;&amp; chronic == '') {
                jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                getField('chronic.error').html('Please specify the chronic illness.').show();
                return false;
            }else{
                getField('chronic.error').html('Please specify the chronic illness.').hide();
            }
            if (adverseReactions == false &amp;&amp; personPresent == SELF) {
                jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                getField('adverse-reactions.error').html('Please specify if patient has any adverse drug reactions.').show();
                return false;
            }else{
                getField('adverse-reactions.error').html('Please specify if patient has any adverse drug reactions.').hide();
            }
            if (adverseReactions == 'true' &amp;&amp; adverse == '') {
                jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                getField('adverse.error').html('Please specify the adverse drug reactions.').show();
                return false;
            }else{
                getField('adverse.error').html('Please specify the adverse drug reactions.').hide();
            }
            if(pgender == 'F'  &amp;&amp; personPresent == SELF &amp;&amp; pAge &gt; 10) {
                if (patientHasLMP == false) {
                    jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                    getField('hasLMP.error').html('Please specify if patient has ever had menses.').show();
                    return false;
                }else{
                    getField('hasLMP.error').html('Please specify if patient has ever had  menses.').hide();
                }
                if (patientHasLMP == 1065 &amp;&amp; lmpDate == false &amp;&amp; recentLMPPresent == "") {
                    jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                    getField('lmp-date.error').html('Please specify patient LMP Date.').show();
                    return false;
                } else {
                    getField('lmp-date.error').html('Please specify patient LMP Date.').hide();
                }
                if (patientHasLMP == 1065 &amp;&amp; lmpDate &gt; encounterDate) {
                    jq('#greencard').smartWizard('setError', {stepnum: 4, iserror: true});
                    getField('lmp-date.error').html('LMP date cannot be later than encounter date.').show();
                    return false;
                } else {
                    getField('lmp-date.error').html('LMP date cannot be later than encounter date.').hide();
                }
                if (patientHasLMP == 1065 &amp;&amp; isPregnant == false &amp;&amp; menopause != 113928) {
                    jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                    getField('pregnancyOption.error').html('Please specify if patient is pregnant.').show();
                    return false;
                } else {
                    getField('pregnancyOption.error').html('Please specify if patient is pregnant.').hide();
                }
                if (patientHasLMP == 1065 &amp;&amp; isBreastfeeding == false &amp;&amp; menopause != 113928) {
                    jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                    getField('breastfeeding.error').html('Please specify if patient is breast feeding.').show();
                    return false;
                } else {
                    getField('breastfeeding.error').html('Please specify if patient is breast feeding.').hide();
                }
                if (patientHasLMP == 1066 &amp;&amp; onfpMethodChecked == false) {
                    jq('#fp-details').show();
                    jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                    getField('fplanning.error').html('Please specify if patient is using family planning methods.').show();
                    return false;
                } else {
                    getField('fplanning.error').html('Please specify if patient is using family planning methods.').hide();
                }
                if (isPregnant == 1066 &amp;&amp; pregnancyIntention == false) {
                    jq("#wants-pregnancy").show();
                    jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                    getField('pregnancyIntention.error').html('Please specify if patient wants to get pregnant in the next three months.').show();
                    return false;
                } else {
                    getField('pregnancyIntention.error').html('Please specify if patient wants to get pregnant in the next three months.').hide();
                }
                if (isPregnant == 1066 &amp;&amp; onfpMethodChecked == false) {
                    jq('#fp-details').show();
                    jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                    getField('fplanning.error').html('Please specify if patient is using family planning methods.').show();
                    return false;
                } else {
                    getField('fplanning.error').html('Please specify if patient is using family planning methods.').hide();
                }
//Validate fp options chooses atleast one option if on fp   or if wants fp
                if (isPregnant == 1066 &amp;&amp; onfpMethodChecked == 965 &amp;&amp; fpMethodsChecked.length == 0) {
                    jq('#fp-details').show();
                    jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                    getField('fp-error.error').html('Please add at least one family planning method.').show();
                    return false;
                } else if (isPregnant == 1066 &amp;&amp; onfpMethodChecked == 1360 &amp;&amp; fpMethodsChecked.length == 0) {
                    jq('#fp-details').show();
                    jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                    getField('fp-error.error').html('Please add at least one family planning method.').show();
                    return false;
                }else{
                    getField('fp-error.error').html('Please add at least one family planning method.').hide();
                }
//Validate not-on-fp options chooses atleast one option if not on fp
                if (isPregnant == 1066 &amp;&amp; onfpMethodChecked == 160652 &amp;&amp; notOnfpMethodsChecked.length == 0) {
                    jq('#fp-details').show();
                    jq('#greencard').smartWizard('setError', {stepnum: 2, iserror: true});
                    getField('notOnfp-error.error').html('Please add at least one reason for not using family planning.').show();
                    return false;
                }
                jq('#greencard').smartWizard('showMessage',"");
                return true;
            }
            else {
                jq('#greencard').smartWizard('showMessage',"");
                return true;
            }
        }
        function step3Validation(){   //Step 3 validations
            var systemsReview = getValue('systems-review.value');    //boolean
            var generalExamsChecked = jq("#general-exam-findings input:checkbox:checked");
            var personPresent =getValue('person-present.value');

//Validate general examinations findings
            if (generalExamsChecked.length == 0 &amp;&amp; personPresent == SELF) {
                jq('#greencard').smartWizard('setError', {stepnum: 3, iserror: true});
                getField('genExams-error.error').html('Please specify general examinations findings.').show();
                return false;
            }else{
                getField('genExams-error.error').html('Please specify general examinations findings.').hide();
            }
            if (systemsReview == false &amp;&amp; personPresent == SELF) {
                jq('#greencard').smartWizard('setError', {stepnum: 3, iserror: true});
                getField('systems-review.error').html('Please specify if patient has any findings on systems review.').show();
                return false;
            }
            else {
                jq('#greencard').smartWizard('showMessage',"");
                return true;
            }
        }  //Step 4 validations substituted with before submit

        beforeSubmit.push(function() {
//var PATIENT_STABLE = "<lookup expression="kenyaemr.patientIsStable()" />";
            var personPresent =getValue('person-present.value');
            var tca_date = getValue('returnVisitDate.value');
            var tca_reason = getValue('returnVisitReason.value');
            var refillFacility = getValue('refill-facility-name.value');
            var encounterDate = getValue('encounter-date.value');
            var fastTrackCareError = getValue('fast-track.value');
            var standardCareError = getValue('standard.value');
            var stabilityStatus= getValue('stability.value');
            var prophylaxis_Used = getValue('prophylaxis-used.value');
            var ctxAdherence = getValue('ctx-adherence.value');
            var ctxDispensed = getValue('ctx-dispensed.value');
            var dapsoneAdherence = getValue('dapsone-adherence.value');
            var dapsoneDispensed = getValue('dapsone-dispensed.value');
            var arvAdherence = getValue('arv-adherence.value');
            var cacxScreened = getValue('cacx-screening.value');
            var stiScreened = getValue('screened-sti.value');
            var stiPartnerNotification = getValue('sti-partnerNotification.value');

            if (prophylaxis_Used == false) {
                getField('prophylaxis-used.error').html('Please specify Prophylaxis used.').show();
                return false;
            }else{
                getField('prophylaxis-used.error').html('Please specify Prophylaxis used.').hide();
            }
            if (prophylaxis_Used == 105281 &amp;&amp; ctxAdherence == false &amp;&amp; personPresent == SELF) {      //ctx
                jq("#ctx-part").show();
                getField('ctx-adherence.error').html('Please specify CTX adherence.').show();
                return false;
            }else{
                getField('ctx-adherence.error').html('Please specify CTX adherence.').hide();
            }
            if (prophylaxis_Used == 105281 &amp;&amp; ctxDispensed == false) {     //ctx
                jq("#ctx-part").show();
                getField('ctx-dispensed.error').html('Please specify if CTX was dispensed.').show();
                return false;
            }else{
                getField('ctx-dispensed.error').html('Please specify if CTX was dispensed.').hide();
            }
            if (prophylaxis_Used == 74250 &amp;&amp; dapsoneAdherence == false &amp;&amp; personPresent == SELF) {      //dapsone
                jq("#dapsone-part").show();
                getField('dapsone-adherence.error').html('Please specify Dapsone adherence.').show();
                return false;
            }else{
                getField('dapsone-adherence.error').html('Please specify Dapsone adherence.').hide();
            }
            if (prophylaxis_Used == 74250 &amp;&amp; dapsoneDispensed == false) {     //dapsone
                jq("#dapsone-part").show();
                getField('dapsone-dispensed.error').html('Please specify if Dapsone was dispensed.').show();
                return false;
            }else{
                getField('dapsone-dispensed.error').html('Please specify if Dapsone was dispensed.').hide();
            }
            if (PATIENT_ON_ART =="true"&amp;&amp; PATIENT_HAS_BEEN_ON_ART =="true"&amp;&amp; personPresent == SELF &amp;&amp; arvAdherence == false ) {
                getField('arv-adherence.error').html('Please conduct ARV adherence.').show();
                return false;
            }else{
                getField('arv-adherence.error').html('Please conduct ARV adherence.').hide();
            }
            if (pgender == 'F') {     //Cacx screening on over 18 years is mandatory
                if (pAge &gt; 18 &amp;&amp; personPresent == SELF &amp;&amp; cacxScreened == false) {
                    getField('cacx-screening.error').html('Please specify whether patient was screened for CaCx.').show();
                    return false;
                } else {
                    getField('cacx-screening.error').html('Please specify whether patient was screened for CaCx.').hide();
                }
            }
            if (stiScreened == false &amp;&amp; personPresent == SELF ) {
                getField('screened-sti.error').html('Please specify whether patient was screened for STI.').show();
                return false;
            }else{
                getField('screened-sti.error').html('Please specify whether patient was screened for STI.').hide();
            }
            if (stiScreened == 703 &amp;&amp; personPresent == SELF &amp;&amp; stiPartnerNotification == false) {
                jq("#tbl-partner-notification").show();
                getField('sti-partnerNotification.error').html('Please specify partner notification status.').show();
                return false;
            }else{
                getField('sti-partnerNotification.error').html('Please specify partner notification status.').hide();
            }
            if (personPresent == SELF &amp;&amp; stabilityStatus == false) {
                getField('stability.error').html('Please specify stability status.').show();
                return false;
            }else{
                getField('stability.error').html('Please specify stability status.').hide();
            }

            if (personPresent == SELF &amp;&amp; stabilityStatus == "true" &amp;&amp; fastTrackCareError == "") {
                getField('fast-track.error').html('Please specify differentiated care model.').show();
                return false;
            }else{
                getField('fast-track.error').html('Please specify differentiated care model.').hide();
            }
            if (personPresent == SELF &amp;&amp; stabilityStatus == "false" &amp;&amp; standardCareError == "") {
                getField('standard.error').html('Please specify differentiated care model.').show();
                return false;
            }else{
                getField('standard.error').html('Please specify differentiated care model.').hide();
            }
            if (tca_date == "") {
                getField('returnVisitDate.error').html('Please specify return visit date for patient.').show();
                return false;
            }else{
                getField('returnVisitDate.error').html('Please specify return visit date for patient.').hide();
            }
            if (tca_date &lt; encounterDate ) {
                getField('returnVisitDate.error').html('Return visit date should not be earlier than encounter date.').show();
                return false;
            }else{
                getField('returnVisitDate.error').html('Return visit date should not be earlier than encounter date.').hide();
            }
            if (tca_reason == "") {
                getField('returnVisitReason.error').html('Please specify reason for return visit.').show();
                return false;
            }else{
                getField('returnVisitReason.error').html('Please specify reason for return visit.').hide();
            }
            if (refillFacility == "" &amp;&amp; personPresent == REFILL_DOCUMENTATION) {
                getField('refill-facility-name.error').html('Please specify refill facility visited.').show();
                return false;
            }else{
                getField('refill-facility-name.error').html('Please specify refill facility visited.').hide();
            }
            return true;
        });
    </script>
    <div id="greencard" class="swMain">
        <ifMode mode="ENTER">
            <ul>
                <li><a href="#step-1">
                    <label class="stepNumber">1</label>
                    <span class="stepDesc">
Visit details<br />
</span>
                </a></li>
                <li><a href="#step-2">
                    <label class="stepNumber">2</label>
                    <span class="stepDesc">
History<br />
</span>
                </a></li>
                <li><a href="#step-3">
                    <label class="stepNumber">3</label>
                    <span class="stepDesc">
Examination<br />
</span>
                </a></li>
                <li><a href="#step-4">
                    <label class="stepNumber">4</label>
                    <span class="stepDesc">
Management<br />
</span>
                </a></li>
            </ul>
        </ifMode>
        <ifMode mode="EDIT">
            <ul class="patient-details">
                <li><a href="#step-1">
                    <label class="stepNumber">1</label>
                    <span class="stepDesc">
Visit details<br />
</span>
                </a></li>
                <li><a href="#step-2">
                    <label class="stepNumber">2</label>
                    <span class="stepDesc">
History<br />
</span>
                </a></li>
                <li><a href="#step-3">
                    <label class="stepNumber">3</label>
                    <span class="stepDesc">
Examination<br />
</span>
                </a></li>
                <li><a href="#step-4">
                    <label class="stepNumber">4</label>
                    <span class="stepDesc">
Management<br />
</span>
                </a></li>
            </ul>
        </ifMode>

        <div class="ke-form-content">
            <!--Wizard Step 1-->
            <div id="step-1">
                <h2 class="StepTitle">Visit details</h2>
                <div class="ke-form-header">
                    <table width="100%">
                        <tr>
                            <td>Date:
                                <encounterDate id="encounter-date" showTime="true"/>
                            </td>
                            <td>Location:
                                <encounterLocation default="GlobalProperty:kenyaemr.defaultLocation" type="autocomplete"/>
                            </td>
                        </tr>
                    </table>
                </div>
                <ifMode mode="EDIT">
                    <script type="text/javascript">
                        jq(function(){
                            var SELF = 978;
                            var TS = 161642;
                            var age = parseInt('<lookup expression="patient.age"/>');
                            var keypop = getValue('population-type.value');
                            var everOnIPT = getValue('ever-on-ipt.value');
                            var complaintsToday = getValue('complaints-today.value');
                            var knownAllergies = getValue('known-allergies.value');
                            var chronicIllness = getValue('chronic-illness.value');   //non boolean
                            var adverseReactions = getValue('adverse-reactions.value');   // boolean
                            var systemsReview = getValue('systems-review.value');   // non boolean
                            var hasLMP=getValue('hasLMP.value');
                            var menopause = getValue('menopause.value');
                            var wantsPreg=getValue('pregnancyIntention.value');
                            var ctxAdherence = getValue('ctx-adherence.value');
                            var ctxDispensed = getValue('ctx-dispensed.value');
                            var dapsoneAdherence = getValue('dapsone-adherence.value');
                            var dapsoneDispensed = getValue('dapsone-dispensed.value');
                            var clinicalDiagnosis = getValue("clinical-diagnosis-action.value");
                            var screeningRadios = jq('#screening-questions').find('input[type=radio]');
                            var actionTakenTab = jq('#action-taken');
                            var tbQuestions = jq('#tb-questions');
                            var iptClientWorkupTab = jq('#ipt-client-workup');
                            var tbRxdate = jq('#tbrxfield');
                            var screeningYesResponses = [];
                            var screeningNoResponses = [];
//Stability assessment
                            var stabilityStatus = getValue('stability.value');
                            var tca_reason = getField('returnVisitReason.value').val();

                            if (stabilityStatus == "false" || stabilityStatus == 1066){
                                jq("#tbl-standard").show();
                                jq("#tbl-fast-track").hide();
                                jq('#standard select').prop('disabled', false);
                                getField('standard.value').prop("selectedIndex", 1);
                                jq('#fast-track select').prop('disabled', true);
                            }else {
                                jq("#tbl-fast-track").show();
                                jq("#tbl-standard").hide();
                                jq('#fast-track select').prop('disabled', false);
                                jq('#standard select').prop('disabled', true);
                            }
                            if (stabilityStatus == "true" &amp;&amp; tca_reason == 160521 ){
                                jq("#refill-label").show();
                                jq("#refill-date").show();
                                jq('#refill-label input').prop('disabled', false);
                                jq('#refill-date input').prop('disabled', false);
                            }else {
                                jq("#refill-label").hide();
                                jq("#refill-date").hide();
                                jq('#refill-label input').prop('disabled', true);
                                jq('#refill-date input').prop('disabled', true);
                            }
                            jq('#currently-onIpt :input').prop('disabled', false);
                            jq("#tbl-ever-on-ipt").show();
                            jq('#ever-taken-ipt :input').prop('disabled', false);

//Person is present
                            if (getValue('person-present.value') == SELF) {
                                jq('.patient-details :input').prop('disabled', false);
                            } else {
                                jq('.patient-details :input').prop('disabled', true);
                                jq('#greencard').smartWizard('goToStep', 4);
                                jq('#greencard').smartWizard('enableFinish', true);
                            }
//if key pop show which type
                            if (keypop == 164929 ){
                                jq("#key-population").show();
                            }else{
                                jq("#key-population").hide();
                            }
//If any checked  complaints allergies chronic illness and adverse events
                            if (complaintsToday == 'true'){
                                jq("#tbl-complaints-today").show();
                            }else{
                                jq("#tbl-complaints-today").hide();
                            }
                            if (knownAllergies == 'true'){
                                jq("#tbl-known-allergies").show();
                            }else{
                                jq("#tbl-known-allergies").hide();
                            }
                            if (chronicIllness == 1065){
                                jq("#tbl-chronic-illness").show();
                            }else{
                                jq("#tbl-chronic-illness").hide();
                            }
                            if (adverseReactions == 'true'){
                                jq("#tbl-adverse-reactions").show();
                            }else{
                                jq("#tbl-adverse-reactions").hide();
                            }
                            if (systemsReview == 1116){
                                jq("#tbl-systems-review").show();
                            }else{
                                jq("#tbl-systems-review").hide();
                            }
//If has LMP activate date and if pg
                            if (hasLMP == 1065) {     //yes_no pregnancy
                                jq('#lmp-date :input').prop('disabled', false);
                                jq('#if-patient-pregnant').show();
                                jq('#wants-pregnancy').show();
                            }else{
                                jq('#lmp-date :input').prop('disabled', true);
                            }
                            if(menopause == 113928){
                                jq('#lmp-details').show();
                                jq('#if-patient-pregnant').hide();
                                jq('#wants-pregnancy').hide();
                            }else{
                                jq('#lmp-details').hide();
                            }
//if wants pregnancy show details
                            if (wantsPreg != false) {     //yes_no pregnancy
                                jq("#fp-details").show();
                            }else{
                                jq("#fp-details").hide();
                            }
                            if (age &lt; 11) {
                                jq('.reproductive-part').hide();
                                jq('#pregnantBreastFeeding').hide();
                                jq("#fp-details").hide();
                            }
//If using ctx show dispece and adherence
                            if (ctxAdherence != false || ctxDispensed != false) {     //ctx
                                jq("#ctx-part").show();
                            }
//If using dapsone show dispece and adherence
                            if (dapsoneAdherence != false || dapsoneDispensed != false) {     //dapsone
                                jq("#dapsone-part").show();
                            }
//TB screening show on edit
//if key pop show which type
//Screening for all options
                            jq("#tb-screening-tab").show();


                            jq.each(screeningRadios, function(){
                                const YES_CONCEPT_ID = 1065;
                                const NO_CONCEPT_ID = 1066
                                const COUGH = 159799;
                                const CONTACT = 124068;
                                const FEVER = 1494;
                                const WEIGHTLOSS = 832;
                                const SWEAT =133027;
                                const LETHERGY =116334;
//Push any responses to the respective screeningYesResponses and screeningNoResponses array
                                if ((this.value == COUGH || this.value == CONTACT || this.value == FEVER || this.value == WEIGHTLOSS || this.value == SWEAT || this.value == LETHERGY)&amp;&amp; this.checked == true) {
                                    screeningYesResponses.push(this);

                                }

                                if (this.value == NO_CONCEPT_ID &amp;&amp; this.checked == true) {
                                    screeningNoResponses.push(this);

                                }

                            });
//If no responses have been recorded than hide the ActionTaken and IPTClientWorkup tabs
                            if (screeningYesResponses.length == 0 &amp;&amp; screeningNoResponses.length == 0 ) {
// Do nothing
                            }
                            if (screeningYesResponses.length &gt; 0) {
                                tbQuestions.show();
                                actionTakenTab.show();
                            }
//Check if we have 5 NO responses
                            if (screeningNoResponses.length == screeningRadios.length / 2 ) {
                                tbQuestions.show();
                                iptClientWorkupTab.show();
                            }
                            if (clinicalDiagnosis == 703 ){
                                jq("#tbl-start-antiTb").show();
                            }else{
                                jq("#tbl-start-antiTb").hide();
                            }

                        });
                    </script>
                </ifMode>
                <!--.On Edit display-->
                <fieldset class="visit-details-part">
                    <legend>Visit Type</legend>
                    <table cellspacing="15">
                        <tr>
                            <th>Visit scheduled?  <span style="color:red;"><strong>*</strong></span></th>
                            <th align="left">Visit by:  <span style="color:red;"><strong>*</strong></span></th>
                        </tr>
                        <tr>
                            <td>
                                <obs id="visit-scheduled" conceptId="1246AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"  style="yes_no"/>
                            </td>
                            <td>
                                <obs
                                        id="person-present"
                                        conceptId="161643AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                        answerConceptIds="978AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,161642AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159802AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                        answerLabels="Self (SF),Treatment supporter (TS),Refill visit documentation,Other (give name)"
                                        style="radio"
                                        answerSeparator="&lt;br /&gt;"
                                />
                                <obs id="person-present-name" conceptId="160638AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
                            </td>
                        </tr>
                    </table>
                </fieldset>
                <!--Triage-->
                <fieldset class="vitals-part">
                    <legend>Vital Signs</legend>

                    <table cellspacing="5" style=" float: left; ">
                        <tr>
                            <th>Vital signs</th>
                            <th align="left">Current</th>
                            <th align="left">Recent</th>
                        </tr>
                        <tr class="patient-details">
                            <td>Temp</td>
                            <td>
                                <obs conceptId="5088AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="temp"/> &#176;C
                            </td>
                            <td>
                                <span class="value"><recentObs conceptId="5088AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></span>
                            </td>
                        </tr>
                        <tr class="patient-details">
                            <td>Pulse Rate</td>
                            <td>
                                <obs conceptId="5087AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="pulse"/>
                            </td>
                            <td><span class="value"><recentObs conceptId="5087AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></span></td>
                        </tr>
                        <tr class="patient-details">
                            <td>BP</td>
                            <td>
                                <obs conceptId="5085AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="systolic"/>
                                /
                                <obs conceptId="5086AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="diastolic"/>
                                mmHg
                            </td>
                            <td><span class="value"><recentObs conceptId="5085AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/> / <recentObs
                                    conceptId="5086AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></span></td>
                        </tr>
                        <tr class="patient-details">
                            <td>Respiratory Rate</td>
                            <td>
                                <obs conceptId="5242AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="resp"/>
                            </td>
                            <td><span class="value"><recentObs conceptId="5242AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></span></td>
                        </tr>
                        <tr class="patient-details">
                            <td>Oxygen Saturation</td>
                            <td>
                                <obs conceptId="5092AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="oxygen"/>
                            </td>
                            <td><span class="value"><recentObs conceptId="5092AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></span></td>
                        </tr>
                    </table>
                    <table cellspacing="5" style="display: inline-block; ">

                        <tr>
                            <th>Other Recordings</th>
                            <th align="left">Current</th>
                            <th align="left">Recent</th>
                            <th align="left">Nutritional Status</th>
                        </tr>
                        <tr class="patient-details">
                            <td>Weight</td>
                            <td>
                                <obs id="weight" conceptId="5089AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
                                kg
                                <span style="color:red;"><strong>*</strong></span>
                            </td>
                            <td><span class="value"><recentObs conceptId="5089AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></span></td>
                            <td rowspan="4">
                                <obs    id="nutritional-status"
                                        conceptId="163300AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                        answerConceptIds="1115AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,163302AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,163303AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,114413AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                        answerLabels="Normal,Severe acute malnutrition,Moderate acute malnutrition,Overweight/Obese"
                                        style="radio"
                                        answerSeparator="&lt;br /&gt;"
                                />
                            </td>
                        </tr>
                        <tr class="patient-details">
                            <td>Height</td>
                            <td>
                                <obs id="height" conceptId="5090AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
                                cm
                                <span style="color:red;"><strong>*</strong></span>
                            </td>
                            <td><span class="value"><recentObs conceptId="5090AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></span></td>
                        </tr>
                        <includeIf velocityTest="$patient.age &gt; 14">
                            <tr class="patient-details">
                                <td>BMI</td>
                                <td><span id="calculated-bmi" class="value"></span></td>
                                <td><span id="recent-calculated-bmi" class="value"></span></td>
                            </tr>
                        </includeIf>
                        <tr class="patient-details">
                            <td>MUAC</td>
                            <td>
                                <obs conceptId="1343AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="muac"/>
                            </td>
                            <td><span class="value"><recentObs conceptId="1343AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></span></td>
                        </tr>
                    </table>
                </fieldset>
                <!-- Population Type  -->
                <fieldset class="patient-details">
                    <legend>Population Type</legend>
                    <div>
                        Population type :  <span style="color:red;"><strong>*</strong></span> &#160;&#160;
                        <obs conceptId="164930"
                             answerConceptIds="164928,164929"
                             answerLabels="General Population,Key Population" id="population-type"
                             style="radio" />
                    </div>
                    <table id="key-population">
                        <tr>
                            <td>
                                <obs conceptId="160581AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="105AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabel="People who inject drugs" style="checkbox" /><br/>
                                <obs conceptId="160581AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="165100"
                                     answerLabel="Transgender" style="checkbox" /><br/>
                                <includeIf velocityTest="$patient.gender == 'M'">
                                    <obs conceptId="160581AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="160578AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                         answerLabel="Men who have sex with men" style="checkbox" /><br/>
                                </includeIf>
                                <includeIf velocityTest="$patient.gender == 'F'">
                                    <obs conceptId="160581AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="160579AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                         answerLabel="Female sex worker" style="checkbox" id="female-sex-worker" /><br/>
                                </includeIf>
                                <obs conceptId="160581AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="162277AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabel="People in prison and other closed settings" style="checkbox"  id="prisoner"/><br/>
                            </td>
                        </tr>
                    </table>
                </fieldset>
                <!-- WHO staging -->
                <fieldset class="patient-details">
                    <legend>WHO Staging</legend>
                    <table cellspacing="10" >
                        <tr>
                            <th  style="color: #888" >Current Stage </th>
                            <th  style="color: #888" >Recent </th>
                        </tr>
                        <tr>
                            <td>
                                <div id="whoAdult">
                                    <table>
                                        <tr>
                                            <td><strong>Adult</strong></td><td><obs conceptId="5356AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptIds="1204AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1205AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1206AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1207AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="dropdown" answerLabels="WHO Stage1,WHO Stage2,WHO Stage3,WHO Stage4" id="whoStage-adult"/></td>
                                        </tr>
                                    </table>
                                </div>
                                <div id="whoChild">
                                    <table>
                                        <tr>
                                            <td><strong>Child</strong></td><td><obs conceptId="5356AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptIds="1220AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1221AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1222AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1223AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="dropdown" answerLabels="WHO Stage1,WHO Stage2,WHO Stage3,WHO Stage4" id="whoStage-child" /></td>
                                        </tr>
                                    </table>
                                </div>
                            </td>
                            <td>
                                <span class="value"><recentObs conceptId="5356AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></span>
                            </td>
                        </tr>
                    </table>
                </fieldset>
            </div>    <!--.step 1-->
            <!--.step 2-->
            <div id="step-2">
                <h2 class="StepTitle">Presenting complaints</h2>
                <!-- Additional History  -->
                <fieldset class="patient-details">
                    <legend>Complaints and History of complaints</legend>
                    <div>
                        Patient having complaint(s) today?
                        <obs id="complaints-today" conceptId="1154AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="yes_no"/>
                        <span style="color:red;"><strong>*</strong></span>
                    </div>
                    <table cellspacing="5" id="tbl-complaints-today">
                        <tr>
                            <th style="color: #888">Complaint</th>
                            <th style="color: #888; text-align: center">Duration (Days)</th>
                            <th style="color: #888; text-align: center">Onset Date</th>
                        </tr>
                        <repeat>
                            <template>
                                <obsgroup groupingConceptId="160531AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
                                    <tr>
                                        <td>
                                            <obs class="complaint" conceptId="5219AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                 answerConceptIds="151AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,141631AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,121543AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,119537AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,148035AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,840AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,131021AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,120749AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,871AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,120345AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,119574AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,113054AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,206AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,143264AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,143129AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,142412AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,122496AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,118789AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,141830AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
                                                            141585AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,141128AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,131040AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,114399AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162626AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,140238AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,140070AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,123396AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,142247AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,135462AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,139084AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,117698AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,116214AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,112989AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,879AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,116558AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,114395AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,135595AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,135488AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
                                                             121657AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,144576AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,116334AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,131015AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,111721AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,133028AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,133632AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5978AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,133469AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,133027AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,132653AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,125225AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,131034AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5953AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,512AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,127777AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,113224AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,131032AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,126535AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
                                                               141597AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,158843AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,140941AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,125198AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,112200AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160208AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,111525AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,122983AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,832AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                 answerLabels="Abdominal pain,Abnormal Uterine Bleeding,Anxiety,Depression,Back pain,Bloody Urine,Breast Pain,Chest Pain,Cold and Chills,Confusion,Delirium,Convulsions,Seizure,Cough,Crying Infant,Diarrhea,Difficult in breathing,Difficulty in swallowing,Dizziness,Ear Pain,Epigastric Pain,Eye apin,Facial Pain,Fatigue/weakness,Fever,Flank Pain,Vaginal Discharge,Discharge from Penis,Genital Ulcer,Headache,Hearing Loss,Hypotension,Shock,Itchiness/Pruritus,Joint Pain,Leg Pain,Loss of Appetite,Lymphadenopathy,Memory Loss,Coma,Lethargy,Mouth Pain,Mouth Ulceration,Muscle cramps,Muscle Pain,Nausea,Neck Pain,Night sweats,Numbness,Pain when Swallowing,Pelvic Pain,Poor Vision,Rash,Red Eye,Running/Blocked nose,Scrotal Pain,Shoulder Pain,
                                                       Sleep Disturbance,Sore Throat,Excessive Sweating,Swollen Legs,Tremors,Urinary Symptoms,Vertigo,Vomiting,Weight Loss,Other"
                                                 style="dropdown" id="complaint-field"
                                            />
                                        </td>
                                        <td><obs class="complaint-time" conceptId="159368AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id ="complaint-duration" size="10" /></td>
                                        <td>
                                            <obs class="complaint-date" conceptId="159948AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" allowFutureDates="false"/>
                                        </td>
                                    </tr>
                                </obsgroup>
                            </template>
                            <render n="1" concept="complaint"/>
                            <render n="2" concept="complaint"/>
                            <render n="3" concept="complaint"/>
                            <render n="4" concept="complaint"/>
                            <render n="5" concept="complaint"/>
                        </repeat>
                    </table>
                    <table>
                        <tr>
                            <th  style="color: #888" >Clinical Notes</th>
                            <th  style="color: #888" >Previous visit's notes</th>
                        </tr>
                        <tr>

                            <td>
                                <obs conceptId="160430AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" rows="3" cols="80" id="clinical-notes"/>
                            </td>
                            <td>
                                <span class="value"><recentObs conceptId="160430AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></span>
                            </td>
                        </tr>
                    </table>
                </fieldset>

                <fieldset class="patient-details">
                    <!--TB Screening-->
                    <legend>TB Screening</legend>
                    <table cellspacing="10" id="tb-questions">
                        <tr>
                            <th  style="color: #888" >Current Status </th>
                            <th  style="color: #888" >Recent </th>
                        </tr>
                        <tr>
                            <td>
                                Patient on anti-TB Drugs? &#160;
                                <obs conceptId="164948"
                                     answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabel="Yes,No"
                                     style="radio"
                                     id="on-anti-tb-drugs" />
                                <span style="color:red;"><strong>*</strong></span>
                                <br/>
                            </td>
                            <td width="20%"> <div><a class="tb-patient"></a></div></td>

                        </tr>
                        <tr id="currently-onIpt">
                            <td>
                                Patient currently on TPT? &#160;&#160;
                                <obs conceptId="164949"
                                     answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabel="Yes,No"
                                     style="radio"
                                     id="on-ipt" />
                                <br/>
                            </td>
                            <td width="20%"> <div><a class="ipt-patient"></a></div></td>
                        </tr>
                    </table>
                    <table id="tbl-ever-on-ipt">
                        <tr id="ever-taken-ipt">
                            <td>
                                Patient ever on TPT? &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                <obs conceptId="164950"
                                     answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabel="Yes,No"
                                     style="radio"
                                     id="ever-on-ipt" />
                                <br/>
                            </td>
                            <td>
                            </td>
                        </tr>
                    </table>
                    <br/>
                    <fieldset id="tb-screening-tab">
                        <legend>Screening Questions</legend>
                        <table id="screening-questions">
                            <obsgroup groupingConceptId="160108AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">

                                <tr>
                                    <td>Cough of any duration:  &#160;&#160; </td>
                                    <td><obs conceptId="1729AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" " answerConceptIds="159799AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" answerLabels="Yes,No" id="tb-screening-error" /></td>
                                </tr>
                                <tr>
                                    <td>Fever: &#160;&#160;</td>
                                    <td><obs conceptId="1729AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" " answerConceptIds="1494AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" answerLabels="Yes,No" /></td>

                                </tr>
                                <tr>
                                    <td>Noticeable weight loss or poor weight gain: &#160; </td>
                                    <td><obs conceptId="1729AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" " answerConceptIds="832AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" answerLabels="Yes,No" /></td>
                                </tr>
                                <!--Adult Questions-->
                                <includeIf velocityTest="$patient.age &gt; 15">
                                    <tr>
                                        <td>Night sweats: &#160;&#160;</td>
                                        <td><obs conceptId="1729AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" " answerConceptIds="133027AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" answerLabels="Yes,No" /></td>
                                    </tr>
                                </includeIf>
                                <!--Paed Questions-->
                                <includeIf velocityTest="$patient.age &lt; 16">
                                    <tr>
                                        <td>Contact with a TB Case: &#160;&#160;</td>
                                        <td><obs conceptId="1729AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" " answerConceptIds="124068AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" answerLabels="Yes,No" /></td>
                                    </tr>
                                    <tr>
                                        <td>Lethergy, less playful than usual: &#160;&#160;</td>
                                        <td><obs conceptId="1729AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" " answerConceptIds="116334AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" answerLabels="Yes,No" /></td>
                                    </tr>
                                </includeIf>
                            </obsgroup>
                        </table>
                    </fieldset>
                    <fieldset id="action-taken">
                        <legend>Indicate Action Taken</legend>
                        <table id="tb-test-ordered">
                            <tr>
                                <td>Tests Ordered:</td>
                                <td><obs id="ord-sputum-smear" conceptId="1271AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Sputum Smear" answerConceptId="307AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="checkbox" /><hr/></td>
                                <td><obs id="ord-chest-xray" conceptId="1271AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Chest Xray" answerConceptId="12AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="checkbox" /><hr/></td>
                                <td><obs id="ord-gene-xpert" conceptId="1271AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="GeneXpert" answerConceptId="162202AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="checkbox" />
                                    <hr/> </td>
                            </tr>
                        </table>
                        <table id="tb-results">
                            <tr>
                                <td>Sputum Smear:</td>
                                <td><obs id="sputum-smear-action" conceptId="307AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" " answerConceptIds="703AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,664AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" /></td>

                            </tr>
                            <tr>
                                <td>Chest X-ray:</td>
                                <td><obs id="chest-xray-action" conceptId="12AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" " answerConceptIds="1115AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,152526AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" /></td>
                            </tr>
                            <includeIf velocityTest="$patient.age &lt; 16">
                                <tr>
                                    <td>Referral:</td>
                                    <td><obs id="referral-action" conceptId="1272AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" " answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" /></td>
                                </tr>
                            </includeIf>
                            <tr>
                                <td>GeneXpert:</td>
                                <td><obs id="genexpert-action" conceptId="162202AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                         answerConceptIds="664AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162203AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162204AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,164104AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,163611AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1138AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                         style="dropdown"
                                /></td>
                            </tr>
                            <tr>
                                <td colspan="2"><p> </p></td>
                            </tr>
                            <tr>
                                <td>Clinical diagnosis:</td>
                                <td><obs  id="clinical-diagnosis-action" conceptId="163752AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" " answerConceptIds="703AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,664AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" /></td>
                            </tr>

                            <tr>
                                <td>Invitation of contacts:</td>
                                <td><obs conceptId="163414" labelText=" " answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" /></td>
                            </tr>
                            <tr>
                                <td>Evaluated for TPT:</td>
                                <td><obs conceptId="162275AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" " answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" /></td>
                            </tr>
                        </table>
                        <table id="tbl-start-antiTb">
                            <tr id="startAnti-tb">
                                <td>Start Anti-TBs:
                                    <obs  id="start-anti-tb-action" conceptId="162309AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio"
                                          answerLabels="Yes,No(Refer)"/>
                                </td>
                                <td>Referring facility:
                                    <obs conceptId="161562AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="tb-referral"/>
                                </td>
                            </tr>
                            <tr><td> <hr /></td></tr>
                            <tr id="tbrxfield">
                                <td width="50%" style="text-align: left"><obs  conceptId="1113AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText="TB Rx date: " id="tbrxdate"/> </td>
                                <td><obs conceptId="1111AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText="TB Rx:" id="tb-regimen"
                                         answerConceptSetIds="160021AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="dropdown"
                                /></td>
                            </tr>
                        </table>
                        <div id="tb-enrollment" style="width: 100%; float: left; overflow: auto; text-align: left; padding: 5px"><span class="ke-flagtag">Candidate for TB enrollment</span> </div>
                    </fieldset>
                    <fieldset id="tb-screening-result">
                        <legend>TB Results Status</legend>
                        <table>
                            <tr>
                                <td colspan="2"><p> </p></td>
                            </tr>
                            <tr>
                                <td colspan="3">
                                    <obs id="tb-result-status" conceptId="1659AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText="Resulting TB Status:" answerConceptIds="1660AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,142177AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1662AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160737AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" answerLabels="No TB Signs,Presumed TB,TB Confirmed,TB Screening Not Done" />
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2"> <p></p></td>
                            </tr>
                        </table>
                    </fieldset>
                    <fieldset id="ipt-client-workup">
                        <legend>Tuberculosis Preventive Therapy (TPT) Client Workup</legend>
                        <table id="ipt-workup">
                            <tr>
                                <td colspan="2" class="ke-panel-header">Ask for the following</td>
                            </tr>
                            <obsgroup groupingConceptId="1727AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
                                <tr>
                                    <td>1. Yellow Urine</td>
                                    <td><obs conceptId="1729AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" " answerConceptIds="162311AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" answerLabels="Yes,No" /></td>
                                </tr>
                                <tr>
                                    <td>2. Numbness/ burning sensation on the hands or feet</td>
                                    <td><obs conceptId="1729AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" " answerConceptIds="132652AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" answerLabels="Yes,No" /></td>
                                </tr>
                                <tr>
                                    <td colspan="2" class="ke-panel-header">Examine the following</td>
                                </tr>
                                <tr>
                                    <td>1. Yellowness of eyes </td>
                                    <td><obs conceptId="1729AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" " answerConceptIds="5192AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" answerLabels="Yes,No" /></td>
                                </tr>
                                <tr>
                                    <td>2.Tenderness in the upper right quadrant of the abdomen </td>
                                    <td><obs conceptId="1729AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" " answerConceptIds="124994AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio" answerLabels="Yes,No" /></td>
                                </tr>
                            </obsgroup>
                        </table>
                    </fieldset>
                    <div id="ipt-initiation" style="width: 100%; float: left; overflow: auto; text-align: left; padding: 5px"><span class="ke-flagtag">Candidate for TPT Initiation</span>
                        <table>
                            <tr>
                                <td><button type="button" class="ke-program-followup-button" id="btnEnrollInIptProgram">Start TPT</button></td>
                                <td><label id="lblIptEnrollmentStatus"></label></td>
                            </tr>
                        </table>
                    </div>
                    <div id="dlgIptInitiation" style="display: none">
                        <span class="ui-helper-hidden-accessible"><input type="text"/></span>
                        <table>
                            <tr>
                                <td>Indication for TPT</td>
                                <td>
                                    <select id="indicationForIpt">
                                        <option value="" selected="true">Select indication</option>
                                        <option value="138571">PLHIV</option>
                                        <option value="162277">Prison setting</option>
                                        <option value="162278">Household contact</option>
                                        <option value="1555">HCW and other Facility staff</option>
                                        <option value="5619">Other clinical risk group</option>
                                    </select>
                                </td>
                                <td><label id="lblIptIndicationOptions"></label></td>
                            </tr>
                        </table>
                    </div>
                </fieldset>



                <div id="ipt-enrollment" style="width: 100%; float: left; overflow: auto; text-align: left; padding: 5px"><span class="ke-flagtag">Kindly Enroll in TPT Program to Record Followup Details</span> </div>

                <fieldset id="ipt-followup">
                    <legend>TPT Followup</legend>

                    <br />
                    <br/>
                    <table border="0" style="border-spacing: 8px">
                        <tr>
                            <td><button type="button" id="btnShowIptFollowupDialog" class="ke-program-followup-button">Record TPT Followup Details</button></td>
                            <td><button type="button" id="btnShowIptOutcomeDialog" class="ke-program-outcome-button">Record TPT Outcome</button></td>
                            <td  align="left"><label id="lblIptCompletionState"/></td>

                        </tr>
                    </table>

                    <br/>
                    <br/>
                    <div id="dlgIptFollowup" style="display: none">
                        <span class="ui-helper-hidden-accessible"><input type="text"/></span>
                        <table>
                            <tr>
                                <td>TPT Due Date</td>
                                <td><input type="text" size="10" id="txtIptDueDate" autocomplete="off"/><span class="error field-error" style="display: none" id="errortxtIptDueDate"></span></td>
                                <td><label id="ipt-due-date"></label></td>
                            </tr>
                            <tr>
                                <td>Date collected TPT</td>
                                <td><input type="text" size="10" id="txtIptCollectionDate" autocomplete="off"/><span class="error field-error" style="display: none" id="errtxtIptCollectionDate"></span></td>
                                <td><label id="collectedDate"></label></td>
                            </tr>
                            <tr>
                                <td>Hepatotoxicity?  <br/> (Vomiting, persistent irritability, abdominal pain, RUQ pain, yellow urine or eyes)</td>
                                <td><input type="radio" name="rdoHepatoxicity" value="1065" onmousedown="radioDown(this)" onclick="radioClicked(this)"/><label>Yes</label>
                                    <input type="radio" name="rdoHepatoxicity" value="1066" onmousedown="radioDown(this)" onclick="radioClicked(this)"/><label>No</label>
                                    <span class="error field-error" style="display: none" id="rdoHepatoxicity"></span>
                                </td>
                                <td><label id="hepatotoxity"></label></td>
                            </tr>
                            <tr>
                                <td>Peripheral Neuropathy  <br/> Does client have any of the following in the limbs? Numbness, tingling or burning sensation</td>
                                <td>
                                    <input type="radio" name="rdoNeuropathy" value="1065" onmousedown="radioDown(this)" onclick="radioClicked(this)"/><label>Yes</label>
                                    <input type="radio" name="rdoNeuropathy" value="1066" onmousedown="radioDown(this)" onclick="radioClicked(this)"/><label>No</label>
                                    <span class="error field-error" style="display: none" id="rdoNeuropathy"></span>
                                </td>
                                <td><label id="neuropathy-peripheral"></label></td>
                            </tr>
                            <tr>
                                <td>Does the patient have Rash?	</td>
                                <td>
                                    <input type="radio" name="rdoRash" value="1065" onmousedown="radioDown(this)" onclick="radioClicked(this)"/><label>Yes</label>
                                    <input type="radio" name="rdoRash" value="1066" onmousedown="radioDown(this)" onclick="radioClicked(this)"/><label>No</label>
                                    <span class="error field-error" style="display: none" id="rdoRash"></span></td>
                                <td><label id="patient-rash"></label></td>
                            </tr>
                            <tr>
                                <td>Others e.g. gastrointestinal disturbances</td>
                                <td>
                                    <input type="radio" name="rdoOther" value="1065" onmousedown="radioDown(this)" onclick="radioClicked(this)"/><label>Yes</label>
                                    <input type="radio" name="rdoOther" value="1066" onmousedown="radioDown(this)" onclick="radioClicked(this)"/><label>No</label>
                                    <span class="error field-error" style="display: none" id="rdoOther"></span></td>
                                <td><label id="patient-other"></label></td>
                            </tr>
                            <tr>
                                <td>Adherence Measurement <br/>Good= missed &lt;3 doses/month Fair=missed 4-8 doses/month Poor= missed 9 doses/month</td>
                                <td>
                                    <input type="radio" name="rdoAdherence" value="159405" onmousedown="radioDown(this)" onclick="radioClicked(this)"/><label>Good</label>
                                    <input type="radio" name="rdoAdherence" value="159406" onmousedown="radioDown(this)" onclick="radioClicked(this)"/><label>Fair</label>
                                    <input type="radio" name="rdoAdherence" value="159407" onmousedown="radioDown(this)" onclick="radioClicked(this)"/><label>Poor</label>
                                    <span class="error field-error" style="display: none" id="rdoAdherence"></span>
                                </td>
                                <td><label id="adherencemes"></label></td>
                            </tr>
                            <tr><td colspan="2"></td></tr>
                            <tr>
                                <td><strong>Action taken</strong></td>
                                <td> </td>
                            </tr>
                            <tr>
                                <td colspan="2"><textarea id="txtActionTaken" rows="5" cols="80"></textarea></td>
                            </tr>
                        </table>
                    </div>

                    <div id="dlgIptOutcome" style="display: none">
                        <span class="ui-helper-hidden-accessible"><input type="text"/></span>
                        <table>
                            <tr>
                                <td>Reason</td>
                                <td>
                                    <select id="iptDiscReason">
                                        <option value="" selected="true">Select reason</option>
                                        <option value="1267">Treatment completed</option>
                                        <option value="5240">Lost to followup</option>
                                        <option value="159836">Discontinue</option>
                                        <option value="160034">Died</option>
                                        <option value="159492">Transferred out</option>
                                        <option value="112141">Active TB Disease - ATB</option>
                                        <option value="102">Adverse drug reaction - ADR</option>
                                        <option value="159598">Poor adherence - PA</option>
                                        <option value="5622">Others - OTR</option>
                                    </select>
                                </td>
                                <td><label id="iptDiscontinueReason"></label></td>
                            </tr>
                            <tr>
                                <td>Action taken</td>
                                <td><textarea rows="5" cols="40" id="iptDiscAction"></textarea></td>
                                <td><label id="iptDiscActionTaken"></label></td>
                            </tr>
                        </table>
                    </div>
                </fieldset>
                <!-- Known allergies   -->
                <fieldset class="patient-details">
                    <legend>Known Allergies</legend>
                    <div>
                        Patient has any known allergie(s)? &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                        <obs id="known-allergies" conceptId="160557AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"  style="yes_no"/>
                        <span style="color:red;"><strong>*</strong></span>
                    </div>
                    <table id="tbl-known-allergies">
                        <tr>
                            <td colspan="2">Record any known allergies<br/>
                                <table>
                                    <tr>
                                        <th>Causative agent</th>
                                        <th>Reaction</th>
                                        <th>Severity</th>
                                        <th>Date of Onset</th>
                                    </tr>
                                    <repeat>
                                        <template>
                                            <obsgroup groupingConceptId="121689AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
                                                <tr>
                                                    <td><obs class="allergen" conceptId="160643AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                             answerConceptIds="162543AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,72609AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162544AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162545AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162171AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162546AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162547AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162172AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162175AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
                                                                            162176AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162548AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162177AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162542AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162536AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162537AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162538AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162539AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162540AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
                                                                              	162541AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                             answerLabels="Beef,Caffeine,Chocolate,Dairy Food,Eggs,Fish,Milk Protein,Peanuts,Shellfish,Soy,Strawberries,Wheat,Adhesive Tape,Bee Stings,Dust,Latex,Mold,Pollen,Ragweed,Other"
                                                             style="dropdown" id="allergy-field"
                                                    />
                                                    </td>
                                                    <td><obs class="reaction" conceptId="159935AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                             answerConceptIds="1067AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,121629AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,148888AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,148787AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,120148AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,108AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,143264AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,142412AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,118773AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,140238AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,140039AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,139581AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,139084AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159098AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
                                                                            111061AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,117399AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,879AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,121677AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159347AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,121AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,512AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                             answerLabels="Unknown,Anaemia,Anaphylaxis,Angioedema,Arrhythmia,Bronchospasm,Cough,Diarrhea,Dystonia,Fever,Flushing,GI upset,Headache,Hepatotoxicity,Hives,Hypertension,Itching,Mental status change,Musculoskeletal pain,Myalgia,Rash,Other"
                                                             style="dropdown"
                                                    /></td>
                                                    <td><obs class="severity" conceptId="162760AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"  answerConceptIds="160754AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160755AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160756AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160758AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1067AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabels="Mild,Moderate,Severe,Fatal,Unknown" /></td>
                                                    <td><obs class="allergy-date" conceptId="160753AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"  allowFutureDates="false" labelText=" " /></td>
                                                </tr>
                                            </obsgroup>
                                        </template>
                                        <render n="1" concept=" " />
                                        <render n="2" concept=" " />
                                        <render n="3" concept=" " />
                                        <render n="4" concept=" " />
                                        <render n="5" concept=" " />
                                    </repeat>
                                </table>
                            </td>
                        </tr>
                    </table>
                </fieldset>
                <!--Chronic Illnesses-->
                <fieldset class="patient-details">
                    <legend>Chronic Illnesses and Cormobidities</legend>
                    <div>
                        Patient has any chronic illnesse(s)? &#160;&#160;&#160;&#160;&#160;&#160;&#160;
                        <obs id="chronic-illness" conceptId="162747AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                             answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                             style="radio" answerLabels="Yes,No"
                        />
                        <span style="color:red;"><strong>*</strong></span>
                    </div>
                    <table id="tbl-chronic-illness">
                        <tr>
                            <th style="color: #888">Illness</th>
                            <th style="color: #888; text-align: center">Onset Date</th>
                        </tr>
                        <repeat>
                            <template>
                                <obsgroup groupingConceptId="159392AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
                                    <tr>
                                        <td>
                                            <obs
                                                    conceptId="1284AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" class="illness-chronic"
                                                    answerConceptIds="149019AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,148432AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,153754AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159351AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,119270AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,120637AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,145438AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1295AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,120576AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,119692AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,120291AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,119481AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,118631AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,117855AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,117789AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,139071AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,115728AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,117399AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,117321AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,151342AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,133687AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,115115AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,114662AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,117703AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,118976AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                    answerLabels="Alzheimer's Disease and other Dementias,Arthritis,Asthma,Cancer,Cardiovascular diseases,Chronic Hepatitis,Chronic Kidney Disease,Chronic Obstructive Pulmonary Disease(COPD),Chronic Renal Failure,Cystic Fibrosis,Deafness and Hearing impairment,Diabetes,Endometriosis,Epilepsy,Glaucoma,Heart Disease,Hyperlipidaemia,Hypertension,Hypothyroidism,Mental illness,Multiple Sclerosis,Obesity,Osteoporosis,Sickle Cell Anaemia,Thyroid disease"
                                                    style="dropdown" id="chronic"
                                            />
                                        </td>
                                        <td><obs class="onset-date-chronic-illness" conceptId="159948AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" allowFutureDates="false" /></td>
                                    </tr>
                                </obsgroup>
                            </template>
                            <render n="1" concept="Drug"/>
                            <render n="2" concept="Drug"/>
                            <render n="3" concept="Drug"/>
                            <render n="4" concept="Drug"/>
                            <render n="5" concept="Drug"/>
                        </repeat>
                    </table>
                </fieldset>
                <fieldset class="patient-details">
                    <legend>Adverse Drug Reactions</legend>
                    <div>
                        Patient has adverse drug reaction(s)? &#160;&#160;&#160;&#160;
                        <obs id="adverse-reactions" conceptId="121764AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"  style="yes_no"/>
                        <span style="color:red;"><strong>*</strong></span>
                    </div>
                    <table id="tbl-adverse-reactions">
                        <tr>
                            <td colspan="2">Record any Adverse Drug Reactions since the last visit<br/>
                                <table>
                                    <tr>
                                        <th>Medicine Causing Reaction</th>
                                        <th>Reaction</th>
                                        <th>Severity</th>
                                        <th>Date of Onset</th>
                                        <th>Action taken</th>
                                    </tr>
                                    <repeat>
                                        <template>
                                            <obsgroup groupingConceptId="121760AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
                                                <tr>
                                                    <td><obs class="medicine-causing"
                                                             conceptId="1193AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                             answerConceptIds="70056AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162298AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,70878AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,155060AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162299AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,103727AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,71647AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,72822AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162301AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,73300AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,73667AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,74807AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,75523AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162302AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
75948AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,77164AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162305AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,77675AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,78280AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,794AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,80106AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,80586AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,80696AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162306AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,81723AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,81724AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,81959AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,82023AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
82559AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,82900AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,83018AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,767AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162307AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,84309AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162170AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,84795AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,84893AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,86663AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                             answerLabels="Abicavir,ACE inhibitors,Allopurinol,Aminoglycosides,ARBs (angiotensin II receptor blockers),Aspirin,Atazanavir,Carbamazepine,Cephalosporins,Chloroquine,Codeine,Didanosine,Efavirenz,Erythromycins,Ethambutol,Griseofulvin,Heparins,Hydralazine,Isoniazid,Lopinavir/ritonavir,Morphine,Nevirapine,Nitrofurans,Non-steroidal anti-inflammatory drugs,Penicillamine,Penicillin,Phenolphthaleins,Phenytoin,Procainamide,Pyrazinamide,Quinidine,Rifampin,Statins,Stavudine,Sulfonamides,Tenofovir,Tetracycline,Zidovudine,Other"
                                                             style="dropdown" id="adverse"
                                                    />
                                                    </td>
                                                    <td><obs class ="reaction"
                                                             conceptId="159935AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                             answerConceptIds="1067AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,121629AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,148888AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,148787AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,120148AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,108AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,143264AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,142412AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,118773AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,140238AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,140039AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,139581AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,139084AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159098AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
111061AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,117399AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,879AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,121677AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159347AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,121AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,512AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                             answerLabels="Unknown,Anaemia,Anaphylaxis,Angioedema,Arrhythmia,Bronchospasm,Cough,Diarrhea,Dystonia,Fever,Flushing,GI upset,Headache,Hepatotoxicity,Hives,Hypertension,Itching,Mental status change,Musculoskeletal pain,Myalgia,Rash,Other"
                                                             style="dropdown"
                                                    /></td>
                                                    <td><obs  class="severity"
                                                              conceptId="162760AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                              answerConceptIds="1498AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1499AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1500AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162819AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1067AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                              answerLabels="Mild,Moderate,Severe,Fatal,Unknown" /></td>
                                                    <td><obs class="adverse-events-onset-date" conceptId="160753AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" allowFutureDates="false" labelText=" " /></td>
                                                    <td>
                                                        <obs class="action-taken"
                                                             conceptId="1255AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                             answerConceptIds="1257AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1259AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,981AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1258AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1107AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1260AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                             answerLabels="CONTINUE REGIMEN,SWITCHED REGIMEN,CHANGED DOSE,SUBSTITUTED DRUG,NONE,STOP,OTHER"
                                                             style="dropdown"
                                                        />
                                                    </td>
                                                </tr>
                                            </obsgroup>
                                        </template>
                                        <render n="1" concept=" " />
                                        <render n="2" concept=" " />
                                        <render n="3" concept=" " />
                                        <render n="4" concept=" " />
                                        <render n="5" concept=" " />
                                    </repeat>
                                </table>
                            </td>
                        </tr>
                    </table>
                </fieldset>
                <fieldset class="patient-details">
                    <legend>Vaccination(s) today</legend>
                    <includeIf velocityTest="$patient.age &lt; 16">
                        <table width="30%" id="child-vacc">
                            <tr>
                                <th style="color: #888" align="left">Vaccination</th>
                            </tr>
                            <tr>
                                <td><obs conceptId="1198AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="886AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="BCG" style="checkbox" /></td>
                            </tr>
                            <tr>
                                <td><obs conceptId="1198AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="82215AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="PV" style="checkbox" /></td>
                            </tr>
                            <tr>
                                <td><obs conceptId="1198AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="1423AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Penta" style="checkbox" /></td>
                            </tr>
                            <tr>
                                <td><obs conceptId="1198AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="162342AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="PCV" style="checkbox" /></td>
                            </tr>
                            <tr>
                                <td><obs conceptId="1198AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="36AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Measles" style="checkbox" /></td>
                            </tr>
                        </table>
                    </includeIf>
                    <includeIf velocityTest="$patient.age &gt; 15">
                        <table width="30%" id="adult-vacc">
                            <tr>
                                <th style="color: #888" align="left">Vaccination</th>
                            </tr>
                            <tr>
                                <td><obs conceptId="1198AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="782AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="HBV" style="checkbox" /></td>
                            </tr>
                            <tr>
                                <td><obs conceptId="1198AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="5261AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Flu" style="checkbox" /></td>
                            </tr>
                        </table>
                        <table >
                            <tr>
                                <td><obs conceptId="1198AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Other" style="checkbox" id="otherVacc"
                                /><obs conceptId="160632AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="other-vacc"  /></td>
                            </tr>
                        </table>
                    </includeIf>
                </fieldset>
                <!--Sexual and reproductive History validated for women over 10 years -->
                <includeIf velocityTest="$patient.gender == 'F'">
                    <fieldset class="reproductive-part">
                        <legend>Sexual and Reproductive History</legend>
                        <table>
                            <tr>
                                <td>
                                    <obs labelText="Has patient ever had menses? &#160;&#160;&#160;&#160;" conceptId="162877AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="hasLMP"
                                         answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1175AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                         style="radio" answerLabels="Yes,No,N/A"
                                    />
                                </td>
                            </tr>
                        </table>
                        <table cellspacing="18" class="patient-details" id="lmp-details" >
                            <tr>
                                <th  style="color: #888" >Current Status <span style="color:red;"><strong>*</strong></span></th>
                                <th  style="color: #888" >Date </th>
                                <th  style="color: #888" >Recent </th>
                                <th  style="color: #888" >Menopausal status </th>
                            </tr>
                            <tr>
                                <td>
                                    <strong>When was your LMP Date:  <span style="color:red;">*</span></strong>

                                </td>
                                <td>
                                    <obs id="lmp-date" labelText="  &#160;"
                                         conceptId="1427AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
                                </td>
                                <td>
                                    <span class="value"><recentObs conceptId="1427AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></span>
                                </td>
                                <td><obs conceptId="160596AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="113928AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Menopause" id="menopause" style="checkbox" /></td>
                            </tr>
                        </table>
                        <table id="if-patient-pregnant">
                            <tr>
                                <td>
                                    <strong>Patient Pregnant?  <span style="color:red;">*</span></strong>
                                    <obs conceptId="5272AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                         labelText="&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;"
                                         answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                         style="radio" answerLabels="Yes,NO" id="pregnancyOption" />
                                </td>
                                <td>
                                    <span class="value"><recentObs conceptId="5272AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></span>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <strong>Patient Breastfeeding? <span style="color:red;">*</span></strong>
                                    <obs conceptId="5632AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                         labelText="&#160;&#160;&#160;&#160;&#160;&#160;"
                                         answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                         answerLabels="Yes,No"
                                         style="radio" id="breastfeeding" />
                                </td>
                                <td>
                                    <span class="value"><recentObs conceptId="5632AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></span>
                                </td>
                            </tr>
                        </table>
                        <div id="wants-pregnancy">
                            <strong>Wants to get pregnant in three months?   <span style="color:red;">*</span></strong>
                            <obs conceptId="164933"
                                 labelText="&#160;&#160;"
                                 answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                 style="radio" answerLabels="Yes,NO" id="pregnancyIntention" />
                        </div>
                        <table id="pregnancyOptionValues">
                            <tr>
                                <td width="8%" style="text-align: left">ANC Number:</td>
                                <td>
                                    <obs conceptId="163530AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" "/>
                                </td>
                                <td></td>
                            </tr>
                            <tr>
                                <td style="text-align: left">EDD:</td>
                                <td colspan="2">
                                    <obs conceptId="5596AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" showTime="false"
                                         allowFutureDates="true" labelText=" " id="patient-edd" readonly="true"/>
                                    <span class="value"><recentObs conceptId="5596AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></span>
                                </td>
                            </tr>
                            <tr>
                                <td style="text-align: left">ANC/PNC Profile</td>
                                <td>
                                    <obs id="anc-profile" conceptId="1719AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabels="Yes,No" style="radio" />
                                </td>
                            </tr>
                            <tr>
                                <td>Parity:</td>
                                <td>
                                    <obs id="parity-term" conceptId="160080AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"  />
                                    +
                                    <obs  id="parity-abortion" conceptId="1823AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" />
                                </td>
                            </tr>
                            <tr>
                                <td>Gravida:</td>
                                <td>
                                    <obs conceptId="5624AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"  id="gravida"/>
                                </td>
                            </tr>
                        </table>
                    </fieldset>
                </includeIf>
                <!--Family Planning-->
                <fieldset id="fp-details" class="patient-details">
                    <legend>Family Planning Status</legend>
                    <table id="fpOptionValues">
                        <tr>
                            <td colspan="2">
                                Family Planning Status :
                                <obs conceptId="160653AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="fplanning"
                                     answerConceptIds="965AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160652AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1360AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     style="dropdown"
                                     answerLabels="On Family Planning,Not using Family Planning,Wants Family Planning"/>
                                <hr/>
                                <br/>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2">
                                <div id="onFp">
                                    If currently using Family Planning, or wants Family Planning, specify which method(s)
                                    <hr/>
                                    <includeIf velocityTest="$patient.gender == 'F'">
                                        <table class="right-aligned-first" style="width: 100%;" border="0">
                                            <obsgroup groupingConceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
                                                <tr>

                                                    <td style="text-align: left">
                                                        <div style="float: left; padding-right: 50px">
                                                            <obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerConceptId="160570AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerLabel="Emergency contraceptive pills" style="checkbox"
                                                            />
                                                            <br />
                                                            <obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerConceptId="780AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerLabel="Oral Contraceptives Pills" style="checkbox"/>
                                                            <br />
                                                            <obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerConceptId="5279AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerLabel="Injectible" style="checkbox"/>
                                                            <br />
                                                            <obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerConceptId="1359AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerLabel="Implant" style="checkbox"/>
                                                            <br />
                                                            <obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerConceptId="5275AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerLabel="Intrauterine Device" style="checkbox"/>
                                                            <br />
                                                            <obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerConceptId="136163AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerLabel="Lactational Amenorhea Method" style="checkbox"/>
                                                            <br />
                                                        </div>
                                                    </td>
                                                    <td>
                                                        <div style="float: left; padding-right: 50px">
                                                            <obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerConceptId="5278AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerLabel="Diaphram/Cervical Cap" style="checkbox"/>
                                                            <br />
                                                            <obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerConceptId="5277AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerLabel="Fertility Awareness"
                                                                 style="checkbox"/>
                                                            <br />
                                                            <obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerConceptId="1472AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerLabel="Tubal Ligation" style="checkbox"/>
                                                            <br />
                                                            <obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerConceptId="190AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerLabel="Condoms" style="checkbox"/>
                                                            <br />
                                                            <obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerConceptId="1489AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerLabel="Vasectomy(Partner)" style="checkbox" id="fp-error"/>
                                                            <br />
                                                        </div>
                                                    </td>
                                                </tr>
                                            </obsgroup>
                                        </table>
                                    </includeIf>
                                    <includeIf velocityTest="$patient.gender == 'M'">
                                        <table class="right-aligned-first" style="width: 100%;" border="0">
                                            <obsgroup groupingConceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
                                                <tr>
                                                    <td style="text-align: left">
                                                        <obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                             answerConceptId="190AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                             answerLabel="Condoms" style="checkbox"/>
                                                        <br/>
                                                        <obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                             answerConceptId="1489AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                             answerLabel="Vasectomy" style="checkbox" id="fp-error"/>
                                                        <br/>
                                                    </td>
                                                </tr>
                                            </obsgroup>
                                        </table>
                                    </includeIf>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2">
                                <div id="notOnFp">
                                    <br/>Not using Family Planning? Specify reason(s)
                                    <hr/>
                                    <includeIf velocityTest="$patient.gender == 'F'">
                                        <table style="width: 70%" border="0">
                                            <obsgroup groupingConceptId="160575AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
                                                <tr>
                                                    <td>
                                                        <div style="float: left; padding-right: 50px">
                                                            <obs conceptId="160575AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerConceptId="160572AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerLabel="Thinks can't get pregnant"
                                                                 style="checkbox"/>
                                                            <br/>
                                                            <obs conceptId="160575AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerConceptId="160573AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerLabel="Not sexually active now"
                                                                 style="checkbox"/>
                                                            <br/>
                                                            <obs conceptId="160575AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerConceptId="5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                                 answerLabel="Other"
                                                                 style="checkbox" id="notOnfp-error" />

                                                        </div> </td>
                                                </tr>
                                            </obsgroup>
                                        </table>
                                    </includeIf>
                                    <includeIf velocityTest="$patient.gender == 'M' ">
                                        <table style="width: 100%" border="0">
                                            <obsgroup groupingConceptId="160575AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
                                                <tr>
                                                    <td width="10%"></td>
                                                    <td>
                                                        <obs conceptId="160575AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                             answerConceptId="160573AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                             answerLabel="Not sexually active now"
                                                             style="checkbox"/>
                                                    </td>
                                                </tr>
                                            </obsgroup>
                                        </table>
                                    </includeIf>
                                </div>
                            </td>
                        </tr>
                    </table>
                </fieldset>
            </div>
            <!--.step 2  System Examination step 3 -->
            <div id="step-3">
                <h2 class="StepTitle">Patient examination</h2>
                <!--General Examination-->
                <fieldset class="patient-details">
                    <legend>General Examination Findings</legend>
                    <table id="general-exam-findings">
                        <tr>
                            <td colspan="3">
                                <div style="float: left; padding-right: 50px">
                                    <obs conceptId="162737AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="1107AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="None" style="checkbox" /><br />
                                    <obs conceptId="162737AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="136443AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Jaundice" style="checkbox" /><br />
                                    <obs conceptId="162737AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="460AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Oedema" style="checkbox" /><br />
                                    <obs conceptId="162737AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="5334AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Oral thrush" style="checkbox" /><br />
                                    <obs conceptId="162737AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="5245AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Pallor" style="checkbox" /><br />
                                </div>
                            </td><td>
                            <div style="float: left;padding-right: 50px">
                                <obs conceptId="162737AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="140125AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Finger Clubbing" style="checkbox" /><br />
                                <obs conceptId="162737AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="126952AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Lymph Node Axillary" style="checkbox" /><br />
                                <obs conceptId="162737AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="143050AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Cyanosis" style="checkbox" /><br />
                                <obs conceptId="162737AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="126939AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Lymph Nodes Inguinal" style="checkbox" /><br />
                                <obs conceptId="162737AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="823AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Wasting" style="checkbox" />
                            </div>
                        </td><td>
                            <div style="float: left;padding-right: 40px">
                                <obs conceptId="162737AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="142630AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Dehydration" style="checkbox" /><br />
                                <obs conceptId="162737AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptId="116334AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabel="Lethargic" style="checkbox" id="genExams-error" /><br />
                            </div>
                        </td>
                        </tr>
                    </table>
                </fieldset>
                <fieldset class="patient-details">
                    <legend>System Examination</legend>
                    <table>
                        <tr>
                            <td>
                                Finding(s) on systems review?  &#160;&#160;&#160;&#160;
                            </td>
                            <td><obs
                                    conceptId="159615AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                    answerConceptIds="1115AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1116AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                    answerLabels="Normal,Abnormal"
                                    style="radio" id="systems-review"/>
                                <span style="color:red;"><strong>*</strong></span>
                            </td>
                        </tr>
                    </table>
                    <br />
                    <table style="width: 70%;" border="0" id="tbl-systems-review">
                        <tr>
                            <th align="left">No. </th>
                            <th align="left">System Review</th>
                            <th align="left">Findings</th>
                            <th align="left">Findings Notes</th>
                        </tr>
                        <tr>
                            <td>1.</td>
                            <td>Skin</td>
                            <td><obs class="skin-findings"
                                     conceptId="1120AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerConceptIds="150555AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,125201AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,135591AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,136455AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,507AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1249AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5244AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabels="Abscess,Swelling/Growth,Hair Loss,Itching,Kaposi Sarcoma,Skin eruptions/Rashes,Oral sores"
                                     style="dropdowm"
                            /></td>
                            <td><obs class="skin-notes" conceptId="160981AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" rows="1" cols="50"
                            />
                            </td>
                        </tr>
                        <tr>
                            <td>2.</td>
                            <td>Eyes</td>
                            <td><obs class="eye-findings"
                                     conceptId="163309AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerConceptIds="123074AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,140940AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,131040AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,127777AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,140827AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,139100AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabels="Visual Disturbance,Excessive tearing,Eye pain,Eye redness,Light sensitive,Itchy eyes"
                                     style="dropdowm"
                            /></td>

                            <td><obs class="eye-notes" conceptId="164938" rows="1" cols="50"
                            />
                            </td>
                        </tr>
                        <tr>
                            <td>3.</td>
                            <td>ENT</td>
                            <td><obs class="ent-findings"
                                     conceptId="164936"
                                     answerConceptIds="148517AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,139075AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,119558AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,118536AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,106AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,147230AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,135841AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,117698AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,138554AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,507AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,152228AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,128055AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,133499AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160285AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,110099AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,126423AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,126318AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,158843AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5244AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5334AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,123588AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,124601AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,123919AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,111525AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabels="Apnea,Hearing disorder,Dental caries,Erythema,Frequent colds,Gingival bleeding,Hairy cell leukoplakia,Hearing loss,Hoarseness,Kaposi Sarcoma,Masses,Nasal discharge,Nosebleed,Pain,Post nasal discharge,Sinus problems,Snoring,Sore thoat,Oral sores,Thrush,Tinnitus,Toothache,Ulcers,Vertigo"
                                     style="dropdowm"
                            /></td>
                            <td><obs class="ent-notes" conceptId="164939" rows="1" cols="50"
                            />
                            </td>
                        </tr>
                        <tr>
                            <td>4.</td>
                            <td>Chest</td>
                            <td><obs class="chest-findings"
                                     conceptId="1123AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerConceptIds="146893AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,127640AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,145712AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,164440AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,127639AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5209AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabels="Bronchial breathing,Crackles,Dullness,Reduced breathing,Respiratory distress,Wheezing"
                                     style="dropdowm"
                            /></td>
                            <td><obs class="chest-notes" conceptId="163042AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" rows="1" cols="50"
                            />
                            </td>
                        </tr>
                        <tr>
                            <td>5.</td>
                            <td>CVS</td>
                            <td><obs class="cvs-findings"
                                     conceptId="1124AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerConceptIds="140147AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,136522AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,562AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,130560AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabels="Elevated blood pressure,Irregular heartbeat,Cardiac murmur,Cardiac rub"
                                     style="dropdowm"
                            /></td>
                            <td><obs class="cvs-notes" conceptId="163046AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" rows="1" cols="50"
                            />
                            </td>
                        </tr>
                        <tr>
                            <td>6.</td>
                            <td>Abdomen</td>
                            <td><obs class="abdomen-findings"
                                     conceptId="1125AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerConceptIds="150915AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5008AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5103AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5009AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5105AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabels="Abdominal distension,Hepatomegaly,Abdominal mass,Splenomegaly,Abdominal tenderness"
                                     style="dropdowm "
                            /></td>
                            <td><obs class="abdomen-notes" conceptId="160948AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" rows="1" cols="50"
                            />
                            </td>
                        </tr>
                        <tr>
                            <td>7.</td>
                            <td>CNS</td>
                            <td><obs class="cns-findings"
                                     conceptId="164937"
                                     answerConceptIds="118872AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1836AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,150817AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,120345AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,157498AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,112721AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,136282AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabels="Altered sensations,Bulging fontenelle,Abnormal reflexes,Confusion,Limb weakness,Stiff neck,Kernicterus"
                                     style="dropdowm"
                            /></td>
                            <td><obs class="cns-notes" conceptId="160994AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" rows="1" cols="50"
                            />
                            </td>
                        </tr>
                        <tr>
                            <td>8.</td>
                            <td>Genitourinary </td>
                            <td><obs class="gus-findings"
                                     conceptId="1126AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerConceptIds="147241AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,154311AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,123529AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,123396AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,124087AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabels="Bleeding,Rectal discharge,Urethral discharge,Vaginal discharge,Ulceration "
                                     style="dropdowm"
                            /></td>
                            <td><obs class="gus-notes" conceptId="163047AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" rows="1" cols="50"
                            />
                            </td>
                        </tr>
                    </table>
                </fieldset>
                <fieldset class="patient-details">
                    <legend>Treatment/Management Plan</legend>
                    <table style="width: 70%;" border="0">
                        <tr>
                            <th align="left">Diagnosis</th>
                            <th align="left">Treatment Plan</th>
                        </tr>
                        <repeat>
                            <template>
                                <obsgroup groupingConceptId="159947AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
                                    <tr>
                                        <td>
                                            <obs conceptId="6042AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerClasses="Diagnosis" id="diagnosis-type" style="autocomplete"/>
                                        </td>
                                        <td>
                                            <obs conceptId="163104AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" rows="1" cols="80" id="treatment-plan"/>
                                        </td>
                                    </tr>
                                </obsgroup>
                            </template>
                            <render n="11" concept="Diagnosis"/>
                            <render n="12" concept="Diagnosis"/>
                            <render n="13" concept="Diagnosis"/>
                            <render n="14" concept="Diagnosis"/>
                            <render n="15" concept="Diagnosis"/>
                        </repeat>
                    </table>
                </fieldset>
                <!--.step 3 Patient Management step 4 -->
            </div>
            <div id="step-4">
                <h2 class="StepTitle">Patient management</h2>
                <fieldset class="prophylaxis"  >
                    <legend>Prophylaxis</legend>
                    <table>
                        <tr>
                            <td>
                                Prophylaxis used?  &#160;&#160;&#160;&#160;
                            </td>
                            <td><obs
                                    conceptId="1109AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                    answerConceptIds="105281AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,74250AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1107AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                    answerLabels="Cotrimoxazole,Dapsone,None"
                                    style="radio" id="prophylaxis-used"/>
                                <span style="color:red;"><strong>*</strong></span>
                            </td>
                        </tr>
                    </table>
                </fieldset>
                <br />
                <fieldset id="ctx-part"  >
                    <legend>Cotrimoxazole</legend>
                    <table>
                        <tr>
                            <td>
                                <table cellpadding="0" border="0" cellspacing="5">
                                    <tr id="tbl-ctx-adherence">
                                        <td>Adherence</td>
                                        <td>
                                            <obs
                                                    conceptId="161652AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                    answerConceptIds="159405AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,163794AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159407AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1175AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                    answerLabels="Good (G),Fair (F),Poor (P),Not applicable (N/A)"
                                                    style="radio" id="ctx-adherence"
                                            />
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Dispensed</td>
                                        <td>
                                            <obs
                                                    conceptId="162229AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                    answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1175AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                    answerLabels="Yes,No,Not applicable (N/A)"
                                                    style="radio" id="ctx-dispensed"
                                            />
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>
                </fieldset>
                <fieldset id="dapsone-part">
                    <legend>Dapsone</legend>
                    <table>
                        <tr>
                            <td>
                                <table cellpadding="0" border="0" cellspacing="5">
                                    <tr id="tbl-dap-adherence">
                                        <td>Adherence</td>
                                        <td>
                                            <obs
                                                    conceptId="164941"
                                                    answerConceptIds="159405AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,163794AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159407AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                    answerLabels="Good (G),Fair (F),Poor (P)"
                                                    style="radio" id="dapsone-adherence"
                                            />
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Dispensed</td>
                                        <td>
                                            <obs
                                                    conceptId="164940"
                                                    answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1175AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                    answerLabels="Yes,No,Not applicable (N/A)"
                                                    style="radio"  id="dapsone-dispensed"
                                            />
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>
                </fieldset>
                <fieldset class="patient-details">
                    <legend>ARV</legend>
                    <table>
                        <tr>
                            <td>
                                <table cellpadding="0" border="0" cellspacing="5">
                                    <tr>
                                        <td>Current Regimen:</td>
                                        <td colspan="2"><span id="current-regimen" class="value"></span></td>
                                    </tr>
                                </table>
                                <table class = "on-art">
                                    <!--Adherence Modal  -->
                                    <tr>
                                        <button type="button" id="dlgAdherenceScreening" class="ke-program-followup-button">Adherence Assessment*</button>
                                        <div id="modalContents" style="display:none;" title="ARV Adherence Assessment" footer="OK">
                                            <span class="ui-helper-hidden-accessible"><input type="text"/></span>
                                            <div id="adherence-1">
                                                1. Do you ever forget to take your medicine? &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                                &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                                &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                                <input type="radio" name="question-1" class="question-1" value="1065"/> Yes
                                                <input type="radio" name="question-1" class="question-1" value="1066"/> No    <br/><br/>

                                                2. Are you careless at times about taking your medicine? &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                                &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                                <input type="radio" name="question-2" class="question-2" value="1065"/> Yes
                                                <input type="radio" name="question-2" class="question-2" value="1066"/> No <br/><br/>

                                                3.Sometimes if you feel worse when you take the medicine, do you stop taking it? &#160;&#160;
                                                <input type="radio" name="question-3" class="question-3" value="1065"/> Yes
                                                <input type="radio" name="question-3" class="question-3" value="1066"/> No <br/><br/>

                                                4.When you feel better do you sometimes stop taking your medicine?&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                                &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                                <input type="radio" name="question-4" class="question-4" value="1065"/> Yes
                                                <input type="radio" name="question-4" class="question-4" value="1066"/> No <br/><br/>
                                            </div>
                                            <hr/>
                                            <div id="adherence-2">
                                                1. Did you take your medicine yesterday? &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                                &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                                &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                                <input type="radio" name="question-5" class="question-5" value="1065"/> Yes
                                                <input type="radio" name="question-5" class="question-5" value="1066"/> No    <br/><br/>
                                                2. When you feel like your symptoms are under control, <br/>  &#160;&#160; do you sometimes stop taking your medicine?
                                                &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                                &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                                <input type="radio" name="question-6" class="question-6" value="1065"/> Yes
                                                <input type="radio" name="question-6" class="question-6" value="1066"/> No <br/><br/>
                                                3.Taking medication every day is a real inconvenience for some people.<br/>  &#160;&#160; Do you feel under pressure about sticking to your treatment plan?
                                                &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
                                                <input type="radio" name="question-7" class="question-7" value="1065"/> Yes
                                                <input type="radio" name="question-7" class="question-7" value="1066"/> No <br/><br/>
                                                4.How often do you have difficulty remembering to take all your medications?&#160;&#160;&#160;
                                                <select name="question-8" class="question-8">
                                                    <option value="1066">Select</option>
                                                    <option value="1090">Never/Rarely</option>
                                                    <option value="159416">Once in a while</option>
                                                    <option value="1385">Sometimes</option>
                                                    <option value="1804">Usually</option>
                                                    <option value="1358">All the time</option>
                                                </select>
                                                <br/>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" id="btnCloseARVAssessment" class="ke-program-followup-button" >Save</button>
                                            </div>
                                        </div>
                                    </tr>      <!--.Modal   -->
                                    <tr>
                                        <td>Adherence</td>
                                        <td>
                                            <obs
                                                    conceptId="1658AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                    answerConceptIds="159405AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,163794AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159407AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                                    answerLabels="Good (G),Fair (F),Poor (P)"
                                                    style="radio" id="arv-adherence"
                                            />
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>
                </fieldset>
                <fieldset class="patient-details">
                    <fieldset class="phdp">
                        <legend>PHDP Services</legend>
                        <table id = "tbl-phdp">
                            <tr>
                                <td>Has the client been given condoms this visit?</td>
                                <td><obs conceptId="159777AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                         answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1067AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1175AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                         answerLabels="Yes,No,Unkown,N/A"
                                         style="radio"
                                /></td>
                            </tr>
                            <tr>
                                <td>Has the client been screened for substance abuse?</td>
                                <td><obs conceptId="112603AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                         answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1067AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1175AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                         answerLabels="Yes,No,Unkown,N/A"
                                         style="radio"
                                /></td>
                            </tr>
                            <tr>
                                <td>Has the Client disclosed HIV status to their sexually active partner?</td>
                                <td><obs conceptId="159423AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                         answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1067AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1175AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                         answerLabels="Yes,No,Unkown,N/A"
                                         style="radio"
                                /></td>
                            </tr>
                            <tr>
                                <td>Has the client's partner received on-site HIV testing?</td>
                                <td><obs conceptId="161557AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                         answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1067AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1175AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                         answerLabels="Yes,No,Unkown,N/A"
                                         style="radio"
                                /></td>
                            </tr>
                            <includeIf velocityTest="$patient.gender == 'F' ">
                                <tr>
                                    <td>Has the client been screened for CaCx <span style="color:red;">*</span></td>
                                    <td><obs conceptId="164934"
                                             answerConceptIds="703AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,664AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1118AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1175AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                             answerLabels="Positive,Negative,Not Done,N/A"
                                             style="radio"
                                             id="cacx-screening" /></td>
                                </tr>
                            </includeIf>
                            <tr >
                                <td>Has the client been screened for STI (in this visit)? <span style="color:red;">*</span></td>
                                <td><obs id="screened-sti"
                                         conceptId="161558AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                         answerConceptIds="703AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,664AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1118AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1175AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                         answerLabels="Positive,Negative,Not Done,N/A"
                                         style="radio" /></td>
                            </tr>
                        </table>
                        <table id="tbl-partner-notification">
                            <tr >
                                <td>STI Partner Notification</td>
                                <td><obs conceptId="164935"
                                         labelText="&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;"
                                         id="sti-partnerNotification"
                                         answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                         answerLabels="Yes,No"
                                         style="radio" /></td>
                            </tr>
                        </table>
                    </fieldset>
                </fieldset>
                <!--Stability Assessment -->
                <fieldset class="stability-details">
                    <legend>Stability assessment</legend>
                    <table>
                        <tr>
                            <td>
                                Is the patient stable?  &#160;&#160;&#160;&#160;
                            </td>
                            <td><obs
                                    conceptId="1855AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="yes_no"
                                    id="stability"/>
                                <span style="color:red;"><strong>*</strong></span>
                            </td>
                            <td>&#160;&#160;&#160;&#160;</td>
                            <td>&#160;&#160;&#160;&#160;</td>
                            <td>
                                <table class="simple-table">
                                    <tr>
                                        <th colspan="4">
                                            Recorded stability assessment indicators
                                        </th>
                                    </tr>
                                    <tr>
                                        <td>Age</td>
                                        <td><input type="text" name="age" id="age" readonly="True" /></td>
                                        <td>BMI</td>
                                        <td><input type="text" name="bmi-value" id="bmi-value" readonly="True" /></td>
                                    </tr>
                                    <tr>
                                        <td>Current regimen</td>
                                        <td><input type="text" name="current-regimen-stability" id="current-regimen-stability" readonly="True" /></td>
                                        <td>Duration of current regimen (Months)</td>
                                        <td><input type="text" name="current-regimen-duration" id="current-regimen-duration" readonly="True" /></td>
                                    </tr>
                                    <tr>
                                        <td>Active Ois</td>
                                        <td><input type="text" name="active-oi" id="active-oi" readonly="True" /></td>
                                        <td>Most recent VL Results</td>
                                        <td><input type="text" name="vl-value" id="vl-value" readonly="True" /></td>
                                    </tr>
                                    <tr>
                                        <td>Good adherence in the last 6 months</td>
                                        <td><input type="text" name="good-adherence" id="good-adherence" readonly="True" /></td>
                                        <td>Completed 6 months TPT</td>
                                        <td><input type="text" name="ipt-completion" id="ipt-completion" readonly="True" /></td>
                                    </tr>

                                    <includeIf velocityTest="$patient.gender == 'F'">
                                        <tr id ="pregnantBreastFeeding">
                                            <td>Pregnant </td>
                                            <td><input type="text" name="pregnant" id="pregnant" readonly="True" /> </td>
                                            <td>Breast feeding </td>
                                            <td><input type="text" name="breast-feeding" id="breast-feeding" readonly="True" /> </td>
                                        </tr>
                                    </includeIf>
                                </table>
                            </td>
                        </tr>
                    </table>
                </fieldset>
                <fieldset class="refill-facility">
                    <legend>Refill facility</legend>
                    <table>
                        <tr>
                            <td>Refill facility visited:</td>
                            <td><obs conceptId="162724AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="refill-facility-name"/>
                                <span style="color:red;"><strong>*</strong></span></td>
                            <td>&#160;&#160;&#160;&#160;</td>
                        </tr><tr></tr>
                    </table>
                </fieldset>
                <fieldset class="tca-part">
                    <legend>Return Visit</legend>
                    <table>
                        <tr>
                            <td>Return Visit Date:&#160;&#160;</td>
                            <td><obs conceptId="5096AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" allowFutureDates="true" labelText=" " id="returnVisitDate" />
                                <span style="color:red;"><strong>*</strong></span>
                                Reason:
                                <obs conceptId="160288AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="returnVisitReason"
                                     answerConceptIds="160523AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1283AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159382AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160521AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                     answerLabels="Follow up,Lab tests,Counseling,Pharmacy Refill,Other,"
                                     style="dropdown"  />
                                <span style="color:red;"><strong>*</strong></span>
                            </td><td>&#160;&#160;&#160;&#160;</td>
                            <td id="refill-label">Refill Date:&#160;&#160;</td>
                            <td id="refill-date"><obs conceptId="162549AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" allowFutureDates="true" labelText=" " id="refillVisitDate" /></td>
                        </tr><tr></tr>
                    </table>
                    <table id="showNumberBooked" class="simple-table">
                        <tr>
                            <td> <span class="ke-flagtag">Number of patients already booked for HIV consultation on the date selected</span></td>
                            <td><span id="showBookedResult"></span></td></tr>
                    </table>
                    <table>
                        <tr id="tbl-fast-track">
                            <td>Differentiated Care</td>
                            <td>
                                <obs conceptId="164947" id="fast-track"
                                     answerConceptIds="164942,164943,164944,164945,164946"
                                     style="dropdown"
                                     answerLabels="Standard Care,Fast Track,Community ART Distribution - HCW Led,Community ART Distribution - Peer Led,Facility ART Distribution Group"
                                />
                                <span style="color:red;"><strong>*</strong></span>
                            </td>
                        </tr>
                        <tr id="tbl-standard">
                            <td>Differentiated Care</td>
                            <td>
                                <obs conceptId="164947" id="standard"
                                     answerConceptIds="164942"
                                     style="dropdown"
                                     answerLabels="Standard Care"
                                />
                                <span style="color:red;"><strong>*</strong></span>
                            </td>
                        </tr>
                    </table>
                </fieldset>
                <div class="ke-form-footer" style="display: none">
                    <submit/>
                </div>    <!--.step 4-->
            </div>
        </div>
    </div>
</htmlform>



