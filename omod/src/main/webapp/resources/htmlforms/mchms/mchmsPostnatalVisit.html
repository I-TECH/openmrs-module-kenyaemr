<!--
  ~ The contents of this file are subject to the OpenMRS Public License
  ~ Version 1.0 (the "License"); you may not use this file except in
  ~ compliance with the License. You may obtain a copy of the License at
  ~ http://license.openmrs.org
  ~
  ~ Software distributed under the License is distributed on an "AS IS"
  ~ basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See the
  ~ License for the specific language governing rights and limitations
  ~ under the License.
  ~
  ~ Copyright (C) OpenMRS, LLC.  All Rights Reserved.
  -->
<htmlform>

<style type="text/css">
	table.tb {
		background-color: #B3C2F0;
		border: 1px solid black;
	}

	table.tb1 {
		border: 1px solid black;
		vertical-align: baseline;
		text-align: left;
		background-color: #E1E1FF;
	}

	table.tb1 tr th, table.tb1 tr td {
		border: 0;
		padding: 10px;
	}
</style>
	<script type="text/javascript" src="../moduleResources/kenyaemr/scripts/moment.js"></script>
<script type="text/javascript">

	var ARV_CONCEPT_ID = 1148;
	var HAART_CONCEPT_ID = 1149;
	var NA_CONCEPT_ID = 1175;
    var ctxPath = typeof openmrsContextPath === 'string' ? openmrsContextPath : OPENMRS_CONTEXT_PATH;

    var PATIENT_IS_ENROLLED_HIV = <lookup expression="kenyaemr.hasHivUniquePatientNumber()" />;
    var PATIENT_IS_REPORTED_HIV = "<lookup expression="fn.latestObs(159427).getValueCoded()"/>";
    var BABY_PROPHYLAXIS = "<lookup expression="fn.latestObs(1282).getValueCoded()"/>";
    //var HAART_START_DATE = "<lookup expression="fn.latestObs(163784).getValueDatetime()"/>";
    var DATE_OF_DELIVERY = "<lookup expression="fn.latestObs(5599).getValueDatetime()"/>";
    var PLACE_OF_DELIVERY = "<lookup expression="fn.latestObs(1572).getValueCoded()"/>";
    var MODE_OF_DELIVERY = "<lookup expression="fn.latestObs(5630).getValueCoded()"/>";
    var ANC_COUNSELLED_ON_INFANT_FEEDING = "<lookup expression="fn.latestObs(159853).getValueCoded()"/>";
    var DIS_COUNSELLED_ON_INFANT_FEEDING = "<lookup expression="fn.latestObs(161651).getValueCoded()"/>";
    var DELIVERY_OUTCOME_QUANTITATIVE = "<lookup expression="fn.latestObs(159949).getValueCoded()"/>";
    var DELIVERY_OUTCOME_QUALITATIVE = "<lookup expression="fn.latestObs(159917).getValueCoded()"/>";

    var GREENCARD_VELOCITY = "<lookup expression="kenyaemr.GreenCardVelocityCalculation()" />";
    var PATIENT_ON_ART = GREENCARD_VELOCITY.split(",")[2].split(":")[1];
    var REGIMEN_NAME = GREENCARD_VELOCITY.split(",")[4].split(":")[1];

     //On ready start
    jq(function () {
        var strtext = "";
        getField('weight.value').change(onWeightOrHeightChange);
        getField('height.value').change(onWeightOrHeightChange);
        onWeightOrHeightChange();
        onEncounterDateChange();
        getDeliveryModeChange();
        //Show number of clients already booked on tca date
        jq('#showNumberBooked').hide();
        jq("#returnVisitDate input[type=hidden]").change(getPatientsBookedOnDate);

        //On delivery outcome change
        jq('#single').show();
        jq('#twins').hide();
        jq('#triplets').hide();
        if(DELIVERY_OUTCOME_QUANTITATIVE == 159913){
            getField('delivery-outcome.value').prop("selectedIndex", 1);
            jq('#single').show();
            jq('#twins').hide();
            jq('#triplets').hide();
        }else if(DELIVERY_OUTCOME_QUANTITATIVE == 159914){
            jq('#single').show();
            jq('#twins').show();
            jq('#triplets').hide();
            getField('delivery-outcome.value').prop("selectedIndex", 2);
        }else if(DELIVERY_OUTCOME_QUANTITATIVE == 159915){
            jq('#single').show();
            jq('#twins').show();
            jq('#triplets').show();
        getField('delivery-outcome.value').prop("selectedIndex", 3);
        }else{
            getField('delivery-outcome.value').prop("selectedIndex", 0);
        }
        jq('#delivery-mode select').change(getDeliveryModeChange);
        jq('#delivery-outcome select').change(onDeliveryOutcomeChange);
        jq('#baby-condition-single select').change(onSingleBabyConditionChange);
        jq('#baby-condition-twins select').change(onTwinsBabyConditionChange);
        jq('#baby-condition-triplets select').change(onTripletsBabyConditionChange);

        //Cacx screening method  cacx-screening-method
        jq('#cacx-screening-method').hide();
        jq('#cacx-screening select').change(onCacxResultChange);
        //partner testing
        jq('#partner-hiv-status select').prop("disabled", true);
        jq('#partner-tested select').change(onPartnerTestedChange);
        // HIV Test validation
        //kit selected
        jq('#kit-name-1 select').change(kit1Selected);

        jq("#hiv-test2").hide();
        jq('#hiv-final-result select').attr("style", "pointer-events:none;");
        jq("#hiv-test1-result select").change(firstTestSelected);
        jq("#hiv-test2-result select").change(secondTestSelected);
        jq('#tbl-known-positive').hide();
        //test kit expiry
        jq("#expiry-date input").change(expiryDateSelected);
        //Family planning validation
        jq('#tbl-family-planning').hide();
        //Validation for client if already hiv positive or enrolled
        if(PATIENT_IS_REPORTED_HIV == 703 || PATIENT_IS_ENROLLED_HIV){
            jq('#tbl-hiv-test').hide();
            jq('#art-and-prophylaxis').show();
            jq('#who-staging').show();
            jq('#vl-sample').show();
            jq('#tbl-known-positive').show();
            jq('#hiv-known-positive:text').val('Positive');
            //Prepopulate if already on HAART
            if(PATIENT_ON_ART =="true") {
                jq('#on-art:text').val('Yes');
            }else {
                jq('#on-art:text').val('No');
            }
        }else if(PATIENT_IS_REPORTED_HIV == 664) {
            jq('#tbl-hiv-test').show();
            jq('#tbl-unknown-status').show();
            jq('#hiv-status:text').val("Negative");
            jq('#art-and-prophylaxis').hide();
            jq('#who-staging').hide();
            jq('#vl-sample').hide();
            var encounterDate = getValue('encounter-date.value');
            jq('#tbl-hiv-test').show();
            var deliveryDateFormatted = moment(DATE_OF_DELIVERY, 'DD-MMM-YYYY').format('YYYY-MM-DD');
            var encounterDateFormatted = moment(encounterDate, 'YYYY-MM-DD').format('YYYY-MM-DD');
            var __duration = moment.duration(moment(encounterDateFormatted).diff(deliveryDateFormatted));
            var testDurationWeeks = __duration.asWeeks().toFixed(0);
            var testDurationDays = __duration.asDays().toFixed(0);

            if(!isNaN(testDurationWeeks) &amp;&amp; testDurationWeeks &gt; 1) {
                jq('#test-duration:text').val(testDurationWeeks + " Week(s)");
            }else if(!isNaN(testDurationDays) &amp;&amp; testDurationDays &lt; 7) {
                jq('#test-duration:text').val(testDurationDays +" Day(s)");
            }
            else{
                jq('#test-duration:text').val("Not available");
            }
        }else{
            jq('#tbl-hiv-test').show();
            jq('#tbl-unknown-status').show();
            jq('#hiv-status:text').val("Reported unknown");
            jq('#art-and-prophylaxis').hide();
            jq('#who-staging').hide();
            jq('#vl-sample').hide();
            var encounterDate = getValue('encounter-date.value');
            jq('#tbl-hiv-test').show();
            var deliveryDateFormatted = moment(DATE_OF_DELIVERY, 'DD-MMM-YYYY').format('YYYY-MM-DD');
            var encounterDateFormatted = moment(encounterDate, 'YYYY-MM-DD').format('YYYY-MM-DD');
            var __duration = moment.duration(moment(encounterDateFormatted).diff(deliveryDateFormatted));
            var testDurationWeeks = __duration.asWeeks().toFixed(0);
            var testDurationDays = __duration.asDays().toFixed(0);

            if(!isNaN(testDurationWeeks) &amp;&amp; testDurationWeeks &gt; 1) {
                jq('#test-duration:text').val(testDurationWeeks + " Week(s)");
            }else if(!isNaN(testDurationDays) &amp;&amp; testDurationDays &lt; 7) {
                jq('#test-duration:text').val(testDurationDays +" Day(s)");
            }
            else{
                jq('#test-duration:text').val("Not available");
            }
        }

       //Maternal history prepopulation
        if(DATE_OF_DELIVERY !=""){
            var deliveryDateFormatted = moment(DATE_OF_DELIVERY, 'DD/MMM/YYYY').format('DD-MMM-YYYY');
            getField('delivery-date.value').val(deliveryDateFormatted);
        }else{
            getField('delivery-date.value').val("");
        }
        if(PLACE_OF_DELIVERY !=""){
            getField('delivery-place.value').val(PLACE_OF_DELIVERY);
        }else{
            getField('delivery-place.value').val("");
        }
        if(MODE_OF_DELIVERY !=""){
            getField('delivery-mode.value').val(MODE_OF_DELIVERY);
            getDeliveryModeChange();
        }else{
            getField('delivery-mode.value').val("");
        }
        //FP skip pattern
        jq("#fplanning select ").change(function () {
            jq("#fplanning select option:selected").each(function () {
                strtext += jq(this).val();
            });
            if (strtext == "") {
                jq('#onFp :input').prop('checked', false);
                jq('#onFp :input').prop('disabled', true);
                jq('#tbl-family-planning').hide();

            }
            if (strtext == "965") {       //on family planning

                jq('#onFp :input').prop('disabled', false);
                jq('#tbl-family-planning').show();
            }
            if (strtext == "160652") {
                jq('#onFp :input').prop('checked', false);
                jq('#onFp :input').prop('disabled', true);
                jq('#tbl-family-planning').hide();
            }
            strtext = "";
        });
        //HIV test skip pattern
        //First test
        var firstTest = getField("hiv-test1-result.value").val();
        //Negative
        if(firstTest ==664) {

            jq("#hiv-test2-result select").prop("disabled", true);
            jq(".kit-name2 select").prop("disabled", true);
            jq(".lot-number2 input").prop("disabled", true);
            jq("#expiry-date2 input").prop("disabled", true);
            getField('hiv-final-result.value').val(664);
            jq('#ccc-no input').prop("disabled", true);
        }
        //Positive
        if(firstTest ==703){

            jq("#hiv-test2-result select").prop("disabled", false);
            jq(".kit-name2 select").prop("disabled", false);
            jq(".lot-number2 input").prop("disabled", false);
            jq("#expiry-date2 input").prop("disabled", false);
        }
        //Invalid
        if(firstTest ==163611){

            jq("#hiv-test2-result select").prop("disabled", false);
            jq(".kit-name2 select").prop("disabled", false);
            jq(".lot-number2 input").prop("disabled", false);
            jq("#expiry-date2 input").prop("disabled", false);
        }
        //Final test
        var secondTest = getField("hiv-test2-result.value").val();
        //Negative
        if(secondTest ==664) {
            jq(".kit-name2 select").prop("disabled", true);
            jq(".lot-number2 input").prop("disabled", true);
            jq("#expiry-date2 input").prop("disabled", true);
            getField('hiv-final-result.value').val(664);
            jq('#ccc-no input').prop("disabled", true);
        }
        //Positive
        if(secondTest ==703){
            jq(".kit-name2 select").prop("disabled", false);
            jq(".lot-number2 input").prop("disabled", false);
            jq("#expiry-date2 input").prop("disabled", false);
            getField('hiv-final-result.value').val(703);
            jq('#ccc-no input').prop("disabled", false);
        }
        //Invalid
        if(secondTest ==163611){
            jq(".kit-name2 select").prop("disabled", false);
            jq(".lot-number2 input").prop("disabled", false);
            jq("#expiry-date2 input").prop("disabled", false);
            getField('hiv-final-result.value').val(1138);
        }
        //Invalid
        if(secondTest ==1175){
            jq(".kit-name2 select").prop("disabled", false);
            jq(".lot-number2 input").prop("disabled", false);
            jq("#expiry-date2 input").prop("disabled", false);
            getField('hiv-final-result.value').val(1138);
        }

        //Prepopulate infant feeding option if available
        if(ANC_COUNSELLED_ON_INFANT_FEEDING == 161651 || DIS_COUNSELLED_ON_INFANT_FEEDING == 1065){
            getField('infant-feeding.value').prop("selectedIndex", 1);
        }else{
            getField('infant-feeding.value').prop("selectedIndex", 0);
        }
        //Baby prophylaxis prepopulation
        if(BABY_PROPHYLAXIS ==160123){
            jq("#azt-dispensed input[value=160123]").prop("checked", true);
        }else{
            jq("#azt-dispensed input[value=160123]").prop("checked", false);
        }
        if(BABY_PROPHYLAXIS ==80586){
            jq("#nvp-dispensed input[value=80586]").prop("checked", true);
        }else{
            jq("#nvp-dispensed input[value=80586]").prop("checked", false);
        }
    });
    //on ready end
    function getDeliveryModeChange() {
        if (getField('delivery-mode.value').val() == 1171) {
            jq('#cs-scar select').prop('disabled', false);
            jq('#episiotomy select').prop('disabled', true);
            getField('episiotomy.value').prop("selectedIndex", 0);
        }
        if(getField('delivery-mode.value').val() == 1170) {
            jq('#cs-scar select').prop('disabled', true);
            jq('#episiotomy select').prop('disabled', false);
            getField('cs-scar.value').prop("selectedIndex", 0);
        }
        if(getField('delivery-mode.value').val() == 1172) {
            jq('#cs-scar select').prop('disabled', true);
            jq('#episiotomy select').prop('disabled', false);
            getField('cs-scar.value').prop("selectedIndex", 0);
        }
        if(getField('delivery-mode.value').val() == 118159) {
            jq('#cs-scar select').prop('disabled', true);
            jq('#episiotomy select').prop('disabled', false);
            getField('cs-scar.value').prop("selectedIndex", 0);
        }
    }


    function onDeliveryOutcomeChange() {
        if (getValue('delivery-outcome.value') == 159913) {
            jq('#single').show();
            jq('#twins').hide();
            jq('#triplets').hide();
        }
        if (getValue('delivery-outcome.value') == 159914) {
            jq('#single').show();
            jq('#twins').show();
            jq('#triplets').hide();
        }
        if (getValue('delivery-outcome.value') == 159915) {
            jq('#single').show();
            jq('#twins').show();
            jq('#triplets').show();
        }
    }

    function onSingleBabyConditionChange() {
        if (getValue('baby-condition-single.value') == 160034) {
            jq('#feeding-method-single select').prop('disabled', true);
            jq('#umbilical-cord-single select').prop('disabled', true);
            jq('#immunization-single select').prop('disabled', true);
        }else{
            jq('#feeding-method-single select').prop('disabled', false);
            jq('#umbilical-cord-single select').prop('disabled', false);
            jq('#immunization-single select').prop('disabled', false);
		}
    }
    function onTwinsBabyConditionChange() {
        if (getValue('baby-condition-twins.value') == 160034) {
            jq('#feeding-method-twins select').prop('disabled', true);
            jq('#umbilical-cord-twins select').prop('disabled', true);
            jq('#immunization-twins select').prop('disabled', true);
        }else{
            jq('#feeding-method-twins select').prop('disabled', false);
            jq('#umbilical-cord-twins select').prop('disabled', false);
            jq('#immunization-twins select').prop('disabled', false);
        }
    }
    function onTripletsBabyConditionChange() {
        if (getValue('baby-condition-triplets.value') == 160034) {
            jq('#feeding-method-triplets select').prop('disabled', true);
            jq('#umbilical-cord-triplets select').prop('disabled', true);
            jq('#immunization-triplets select').prop('disabled', true);
        }else{
            jq('#feeding-method-triplets select').prop('disabled', false);
            jq('#umbilical-cord-triplets select').prop('disabled', false);
            jq('#immunization-triplets select').prop('disabled', false);
        }
    }
	function clearArvMeds() {
		jq('.arv-med').each(function () {
			var elementId = jq(this).attr('id');
			setValue(elementId + '.value', null);
		});
	}
    function onCacxResultChange() {
        if (getValue('cacx-screening.value') == 1118 || getValue('cacx-screening.value') == 1175) {
            jq('#cacx-screening-method').hide();
            clearHiddenSections(jq('#screening-cacx-method'));
        }else{
            jq('#cacx-screening-method').show();
        }
    }
	function onWeightOrHeightChange() {
		var display = '';
		var weightKg = parseFloat(getValue('weight.value'));
		var heightM = parseFloat(getValue('height.value')) / 100;
		if (!isNaN(weightKg) &amp;&amp; !isNaN(heightM)) {
			var bmi = weightKg / (heightM * heightM);
			if (isNaN(bmi) || bmi &lt; 10 || bmi &gt; 50) {
				display = 'Abnormal value. Were height and height entered correctly?';
			}
			else {
				display = bmi.toFixed(2);
			}
		}
		jq('#calculated-bmi').html(display);
	}
    function onPartnerTestedChange() {
        var partnerTested = jq('#partner-tested select').val();
        if (partnerTested == 1065) {
            jq('#partner-hiv-status select').prop("disabled", false);
        }else{
            jq('#partner-hiv-status select').prop("disabled", true);
            getField('partner-hiv-status.value').val("");
        }
    }
    //First and second test validation
    var firstTestSelected  = function () {
        var firstTest = getField("hiv-test1-result.value").val();
        //Negative
        if(firstTest ==664) {
            jq("#hiv-test2").hide();

            clearHiddenSections(jq('#ccc-no'));
            clearHiddenSections(jq('#hiv-final-result'));
            clearHiddenSections(jq('#hiv-test2-result'));
            clearHiddenSections(jq('.kit-name2'));
            clearHiddenSections(jq('.lot-number2'));
            getField('hiv-final-result.value').val(664);
            jq('#ccc-no input').prop("disabled", true);
        }
        //Positive
        if(firstTest ==703){
            jq("#hiv-test2").show();
            jq("#hiv-test2-result select").prop("disabled", false);
            jq(".kit-name2 select").prop("disabled", false);
            jq(".lot-number2 input").prop("disabled", false);
            jq("#expiry-date2 input").prop("disabled", false);
            clearHiddenSections(jq('#hiv-final-result'));
            clearHiddenSections(jq('#hiv-test2-result'));
        }
        //Invalid
        if(firstTest ==163611){
            jq("#hiv-test2").show();
            jq("#hiv-test2-result select").prop("disabled", false);
            jq("kit-name2 select").prop("disabled", false);
            jq("lot-number2 input").prop("disabled", false);
            jq("#expiry-date2 input").prop("disabled", false);
            clearHiddenSections(jq('#ccc-no'));
            clearHiddenSections(jq('#hiv-final-result'));
            clearHiddenSections(jq('#hiv-test2-result'));
        }
    }
    var secondTestSelected  = function () {
        var secondTest = getField("hiv-test2-result.value").val();
        //Negative
        if(secondTest ==664) {
            jq(".kit-name2 select").prop("disabled", false);
            jq(".lot-number2 input").prop("disabled", false);
            jq("#expiry-date2 input").prop("disabled", false);
            clearHiddenSections(jq('#ccc-no'));
            clearHiddenSections(jq('#hiv-final-result'));
            getField('hiv-final-result.value').val(1138);
            jq('#ccc-no input').prop("disabled", true);
        }
        //Positive
        if(secondTest ==703){
            clearHiddenSections(jq('#ccc-no'));
            clearHiddenSections(jq('#hiv-final-result'));
            jq(".kit-name2 select").prop("disabled", false);
            jq(".lot-number2 input").prop("disabled", false);
            jq("#expiry-date2 input").prop("disabled", false);
            getField('hiv-final-result.value').val(703);
            jq('#ccc-no input').prop("disabled", false);
        }
        //Invalid
        if(secondTest ==163611){
            clearHiddenSections(jq('#ccc-no'));
            clearHiddenSections(jq('#hiv-final-result'));
            jq(".kit-name2 select").prop("disabled", false);
            jq(".lot-number2 input").prop("disabled", false);
            jq("#expiry-date2 input").prop("disabled", false);
            getField('hiv-final-result.value').val(1138);
        }
        //Invalid
        if(secondTest ==1175){
            clearHiddenSections(jq('#ccc-no'));
            clearHiddenSections(jq('#hiv-final-result'));
            jq(".kit-name2 select").prop("disabled", false);
            jq(".lot-number2 input").prop("disabled", false);
            jq("#expiry-date2 input").prop("disabled", false);
            getField('hiv-final-result.value').val(1138);
        }
    }

    var kit1Selected = function () {
        var val = jq(this).val();
        if (val == 165351 ){   //Dual kit selected
            jq('#dual-results-1').show();
            $("#kit-name-2 option[value='164961']").add();
            $("#kit-name-2 option[value='164960']").remove();
            $("#kit-name-2 option[value='165351']").remove();
        }

        if (val == 164960 ){   //Determine kit selected
            jq('#dual-results-1').hide();
            $("#kit-name-2 option[value='164961']").add();
            $("#kit-name-2 option[value='164960']").remove();
            $("#kit-name-2 option[value='165351']").remove();
        }
        if (val == 164961 ){   //Determine kit selected
            jq('#dual-results-1').hide();
            $("#kit-name-2 option[value='164960']").add();
            $("#kit-name-2 option[value='165351']").add();
            $("#kit-name-2 option[value='164961']").remove();
        }
    }

    var expiryDateSelected  = function () {
        var encounterDate = getValue('encounter-date.value');
        var testKitExpiryDate = getValue('expiry-date.value');
        var isTestKitExpiryBeforeEncounterDate = moment(moment(moment(testKitExpiryDate, 'YYYY-MM-DD').toDate()).format('YYYY-MM-DD')).isBefore(moment(moment(encounterDate, 'YYYY-MM-DD').toDate()).format('YYYY-MM-DD'));
        if (isTestKitExpiryBeforeEncounterDate) {
            getField('expiry-date.error').html('HIV Test Kit expiry date should not be later than encounter Date').show();
        }else{
            getField('expiry-date.error').html('HIV Test Kit expiry date should not be later than encounter Date').hide();
		}
    }
    function onEncounterDateChange() {
        var patientId = <lookup expression="patient.patientId"/>;
        var encDate = getValue('encounter-date.value');
        if(encDate == null) {
            encDate = new Date();
        }
        if(PATIENT_ON_ART =="true") {
            jq('#current-regimen').html(REGIMEN_NAME);
        }else{
            jq('#current-regimen').html("None");
        }
    }
    // get count of patients booked on a date
    function getPatientsBookedOnDate() {
        var tca_date = jq('#returnVisitDate input[type=hidden]').val();
        jq('#showNumberBooked').hide();
        jq.getJSON('/' + ctxPath + '/kenyaemr/emrUtils/clientsBookedForMchConsultationOnDate.action', { appointmentDate: tca_date }, function(data) {
            jq('#showBookedResult').text(data.bookingsOnDate);
            jq('#showNumberBooked').show();
        });
    }
    //Clear hidden sections
    clearHiddenSections = function(parentObj) {
        parentObj.find('input[type=radio]').each(function() {
            this.checked = false;
        });
        parentObj.find('input[type=checkbox]').each(function() {
            this.checked = false;
        });
        parentObj.find('input[type=text]').each(function() {
            jq(this).val("");
        });
        parentObj.find('select').each(function() {
            this.selectedIndex =0;
        });
    }

	beforeSubmit.push(function () {
        var fundalHeight = getValue('fundal.value');
        var deliveryDate = getValue('delivery-date.value');
        var encounterDate = getValue('encounter-date.value');
        var tca_date = getValue('returnVisitDate.value');

        if (fundalHeight &lt; 0 || fundalHeight &gt; 40) {
            getField('fundal.error').html('Fundal Height should be between 0 and 40.').show();
            return false;
        }
		if (!jq('#arv-medication').is(':visible')) {
			clearArvMeds();
		}
        if (DATE_OF_DELIVERY =="" &amp;&amp; deliveryDate =="" ) {
            getField('delivery-date.error').html('Delivery date should not be empty').show();
            return false;
        }else{
            getField('delivery-date.error').html('Delivery date should not be empty').hide();
        }
        if (tca_date == "") {
            getField('returnVisitDate.error').html('Please specify return visit date for client.').show();
            return false;
        }else{
            getField('returnVisitDate.error').html('Please specify return visit date for client.').hide();
        }
        if (tca_date &lt; encounterDate ) {
            getField('returnVisitDate.error').html('Return visit date should not be earlier than encounter date.').show();
            return false;
        }else{
            getField('returnVisitDate.error').html('Return visit date should not be earlier than encounter date.').hide();
        }
		return true;
	});

</script>

<div class="ke-form-header">
	<table style="width: 100%">
		<tr>
			<td>
				<ifMode mode="EDIT">
					<script type="text/javascript">
                        jq(function(){

                            //First test
                            var firstTest = getField("hiv-test1-result.value").val();
                            //Negative
                            if(firstTest ==664) {

                                jq("#hiv-test2-result select").prop("disabled", true);
                                jq(".kit-name2 select").prop("disabled", true);
                                jq(".lot-number2 input").prop("disabled", true);
                                jq("#expiry-date2 input").prop("disabled", true);
                                getField('hiv-final-result.value').val(664);
                                jq('#ccc-no input').prop("disabled", true);
                            }
                            //Positive
                            if(firstTest ==703){
                                jq("#hiv-test2").show();
                                jq("#hiv-test2-result select").prop("disabled", false);
                                jq(".kit-name2 select").prop("disabled", false);
                                jq(".lot-number2 input").prop("disabled", false);
                                jq("#expiry-date2 input").prop("disabled", false);
                            }
                            //Invalid
                            if(firstTest ==163611){
                                jq("#hiv-test2").show();
                                jq("#hiv-test2-result select").prop("disabled", false);
                                jq(".kit-name2 select").prop("disabled", false);
                                jq(".lot-number2 input").prop("disabled", false);
                                jq("#expiry-date2 input").prop("disabled", false);
                            }
                            //Final test
                            var secondTest = getField("hiv-test2-result.value").val();
                            //Negative
                            if(secondTest ==664) {
                                jq(".kit-name2 select").prop("disabled", true);
                                jq(".lot-number2 input").prop("disabled", true);
                                jq("#expiry-date2 input").prop("disabled", true);
                                getField('hiv-final-result.value').val(664);
                                jq('#ccc-no input').prop("disabled", true);
                            }
                            //Positive
                            if(secondTest ==703){
                                jq(".kit-name2 select").prop("disabled", false);
                                jq(".lot-number2 input").prop("disabled", false);
                                jq("#expiry-date2 input").prop("disabled", false);
                                getField('hiv-final-result.value').val(703);
                                jq('#ccc-no input').prop("disabled", false);
                            }
                            //Invalid
                            if(secondTest ==163611){
                                jq(".kit-name2 select").prop("disabled", false);
                                jq(".lot-number2 input").prop("disabled", false);
                                jq("#expiry-date2 input").prop("disabled", false);
                                getField('hiv-final-result.value').val(1138);
                            }
                            //Invalid
                            if(secondTest ==1175){
                                jq(".kit-name2 select").prop("disabled", false);
                                jq(".lot-number2 input").prop("disabled", false);
                                jq("#expiry-date2 input").prop("disabled", false);
                                getField('hiv-final-result.value').val(1138);
                            }

                            //show syphilis results if they exist
                            var testKit1 = getField('kit-name-1.value').val();
                            if (testKit1 == 165351 ){   //Dual kit selected
                                jq('#dual-results-1').show();
                                $("#kit-name-2 option[value='164961']").add();
                                $("#kit-name-2 option[value='164960']").remove();
                                $("#kit-name-2 option[value='165351']").remove();
                            }

                            if (testKit1 == 164960 ){   //Determine kit selected
                                $("#kit-name-2 option[value='164961']").add();
                                $("#kit-name-2 option[value='164960']").remove();
                                $("#kit-name-2 option[value='165351']").remove();
                            }
                            if (testKit1 == 164961 ){   //Determine kit selected
                                $("#kit-name-2 option[value='164960']").add();
                                $("#kit-name-2 option[value='165351']").remove();
                                $("#kit-name-2 option[value='164961']").remove();
                            }
                            var syphylisTest1Results = getField("syphilis-test-results-1.value").val();
                            if(syphylisTest1Results != ""){
                                jq('#dual-results-1').show();
                            }

                        });
					</script>
				</ifMode>
				Date:
				<encounterDate id="encounter-date" showTime="true"/>
			</td>
			<td>Provider:
				<encounterProvider default="currentUser"/>
			</td>
			<td>Location:
				<encounterLocation default="GlobalProperty:kenyaemr.defaultLocation"/>
			</td>
		</tr>
	</table>
</div>

<div class="ke-form-content">
<table align="center" border="0" class="tb" cellspacing="8">
<tr>
	<td colspan="2">
		<div class="ke-form-instructions">
			<b>*</b>
			indicates a required field
		</div>
	</td>
</tr>
<tr>
		<td>
			<legend>Visit details </legend>
			<table align="top" width="100%" class="tb1">
				<tr>
					<td>
						<table>
							<tr>
								<td >PNC Register Number:
								</td>
								<td>
									<obs conceptId="1646AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
									<i>(yyyy-mm-xxxx)</i>
								</td>
								<td>PNC Visit Number:</td>
								<td>
									<obs conceptId="159893AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
								</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</td>
</tr>
	<tr>
		<td>
			<legend>Maternity history </legend>
			<table align="top" width="100%" class="tb1">
				<tr>
					<td>
						<table>
							<tr>
								<td>Date of delivery:</td>
								<td>
									<obs conceptId="5599AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="delivery-date" allowTime="false" allowFutureDates="false" /> <span style="color:red;"><strong>*</strong></span>
								</td>
								<td>Mode of Delivery:</td>
								<td>
									<obs conceptId="5630AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="delivery-mode"
										 answerConceptIds="1170AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
                                                           1171AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
                                                           1172AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
                                                           118159AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
										 answerLabels="Spontaneous vaginal delivery(SVD),
                                                       Cesarean section(CS),
                                                       Breech delivery,
                                                       Assisted vaginal delivery(AVD)"
										 style="dropdown"
										 		/>
								</td>
							</tr>
							<tr>
								<td>Place of delivery:</td>
								<td>
									<obs conceptId="1572AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"   id="delivery-place"
										 answerConceptIds="1536AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1589AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1601AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
										 answerLabels="Home,Facility,Born Before Arrival"/>
								</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</td>
	</tr>
<tr>
	<td>
		<legend>Vitals</legend>
		<table align="center" width="100%" class="tb1">
			<tr>
				<td>
					<table>
						<tr>
							<td>Temperature</td>
							<td colspan="2">
								<obs conceptId="5088AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
							</td>
							<td>Pulse Rate</td>
							<td>
								<obs conceptId="5087AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
							</td>
						</tr>
						<tr>
							<td colspan="2">B.P.</td>
							<td>
								<obs conceptId="5085AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
								/
								<obs conceptId="5086AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
								mmHg
							</td>
							<td>Respiratory Rate</td>
							<td>
								<obs conceptId="5242AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
							</td>
						</tr>
						<tr>
							<td colspan="2">Oxygen Saturation</td>
							<td>
								<obs conceptId="5092AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
							</td>

							<td>MUAC</td>
							<td>
								<obs conceptId="1343AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
							</td>
						</tr>
						<tr>
							<td colspan="2">Height: (cm)</td>
							<td>
								<obs conceptId="5090AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="height"/>
							</td>
							<td>Weight: (kg)</td>
							<td>
								<obs conceptId="5089AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="weight"/>
							</td>
						</tr>
						<tr>
							<td colspan="2">BMI</td>
							<td><span id="calculated-bmi" class="value"></span></td>
						</tr>
					</table>
				</td>
	   <td>
		<table border="1">
			<tr>
				<td>
					<u>
						Other Vitals Recorded Recently
					</u>
					<br/>
					<br/>
					Temperature:
					<lookup expression="fn.latestObs(5088).valueNumeric"/>
					<br/>
					Pulse:
					<lookup expression="fn.latestObs(5087).valueNumeric"/>
					<br/>
					B.P.:
					<lookup expression="fn.latestObs(5085).valueNumeric"/>
					/
					<lookup expression="fn.latestObs(5086).valueNumeric"/>
					<br/>
					Respiratory Rate:
					<lookup expression="fn.latestObs(5242).valueNumeric"/>
					<br/>
					Oxygen Saturation:
					<lookup expression="fn.latestObs(5092).valueNumeric"/>
					<br/>
					Weight:
					<lookup expression="fn.latestObs(5089).valueNumeric"/>
					<br/>
					Height:
					<lookup expression="fn.latestObs(5090).valueNumeric"/>
					<br/>
					MUAC:
					<lookup expression="fn.latestObs(1343).valueNumeric"/>
					<br/>
				</td>
			</tr>
		         </table>
	          </td>
			</tr>
		</table>
	</td>
</tr>
<tr>
	<td>
		<table>
			<tr>
				<td>
					<legend>Postnatal Observations</legend>
					<table align="center" width="100%" class="tb1">
						<tr>
							<td colspan="6">
								<br/>
								<strong>Mother's observations</strong>
								<hr />
							</td>
						</tr>
						<tr>
							<td width="200">General Condition:</td>
							<td>
								<obs conceptId="1856AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
										answerConceptIds="1855AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162133AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162132AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
										answerLabels="Good, Fair, Poor"/>
							</td>
							<td width="200">Pallor:</td>
							<td>
								<obs conceptId="5245AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
									 answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1175AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
								<span class="value"><recentObs conceptId="5245AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></span>
							</td><td width="200"> </td>
						</tr>
						<tr>
							<td>Breast:</td>
							<td>
								<obs conceptId="159780AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
									 answerConceptIds="1115AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,143242AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,127522AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,115915AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
									 answerLabels="Normal,Cracked nipple,Engorged nipple,Mastitis"/>
							</td>
							<td>PPH:</td>
							<td>
								<obs conceptId="230AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
									 answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
									 answerLabels="Present,Absent"/>
							</td>
						</tr>
						<tr>
							<td>C/S Scar:</td>
							<td>
								<obs conceptId="162128AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="cs-scar"
									 answerConceptIds="162129AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,145776AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,156794AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162130AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1175AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
									 answerLabels="Wound intact and healing,Caesarean Wound Disruption,Infection of obstetric surgical wound,Surgical wound healed,Not Applicable"
								/>
							</td>
							<td>Haemoglobin:</td>
							<td>
								<obs conceptId="21AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"></obs>
							</td><td></td>
						</tr>
						<tr>
							<td>Involution of Uterus:</td>
							<td>
								<obs conceptId="162110AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
							</td>
						</tr>
						<tr>
							<td>Condition of Episiotomy:</td>
							<td>
								<obs conceptId="159840AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="episiotomy"
									 answerConceptIds="159842AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159843AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159841AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,113919AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1175AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
									 answerLabels="Repaired-episiotomy wound,Healed-episiotomy wound,Gap-episiotomy wound,Postoperative wound infection,Not Applicable"
								/>
							</td>
							<td>Lochia:</td>
							<td>
								<obs conceptId="159844AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"  id="lochia"
									 answerConceptIds="159721AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159846AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159845AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
									 style="dropdown" answerLabels="Normal,Foul smelling,Excessive"/>

							</td>
						</tr>
						<tr>
							<td>Counselled on infant feeding?</td>
							<td>
								<obs conceptId="161651AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"  id="infant-feeding"
									 answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
									 style="dropdown" answerLabels="YES,NO"/>
							</td>
							<td>Counseling on Family Planning?</td>
							<td>
								<obs conceptId="1382AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"></obs>
							</td>
						</tr>
					</table>
				</td>
				<tr>
			    <td>
					<br/>
			            <strong>Baby(s) observations</strong>
					<table align="center" width="100%" class="tb1" id="single">
							<tr>
								<td><strong>Delivery outcome : </strong></td>
								<td>
									<obs conceptId="159949AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"  id="delivery-outcome"
										 answerConceptIds="159913AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159914AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159915AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
										 answerLabels="Single,Twins,Triplets"/>
								</td>
							</tr>
						<obsgroup groupingConceptId="162588AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
							<tr>
								<td colspan="6">
									Baby 1:
									<hr />
								</td>
							</tr>
						<tr>
							<td>Baby's Condition</td>
							<td>
								<obs conceptId="162134AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="baby-condition-single"
									 answerConceptIds="1855AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162133AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162132AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160034AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
									 answerLabels="Good, Fair, Poor,Died"/>
							</td>
							<td>Baby's Feeding Method</td>
							<td>
								<obs conceptId="1151AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"  id="feeding-method-single"
									 answerConceptIds="5526AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1595AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,6046AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159418AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
							</td>
						</tr>
						<tr>
							<td>Umbilical Cord</td>
							<td>
								<obs conceptId="162121AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"  id="umbilical-cord-single"/>
							</td>
							<td>Baby Immunization Started</td>
							<td>
								<obs conceptId="162127AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="immunization-single"/>
							</td>

						</tr>
						</obsgroup>
					</table>
					<table align="center" width="100%" class="tb1" id="twins">
						<obsgroup groupingConceptId="162588AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
							<tr>
								<td colspan="6">
									Baby 2:
									<hr />
								</td>
							</tr>
							<tr>
								<td>Baby's Condition</td>
								<td>
									<obs conceptId="162134AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="baby-condition-twins"
										 answerConceptIds="1855AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162133AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162132AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160034AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
										 answerLabels="Good, Fair, Poor,Died"/>
								</td>
								<td>Baby's Feeding Method</td>
								<td>
									<obs conceptId="1151AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="feeding-method-twins"
										 answerConceptIds="5526AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1595AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,6046AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159418AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
								</td>
							</tr>
							<tr>
								<td>Umbilical Cord</td>
								<td>
									<obs conceptId="162121AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"  id="umbilical-cord-twins"/>
								</td>
								<td>Baby Immunization Started</td>
								<td>
									<obs conceptId="162127AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="immunization-twins"/>
								</td>

							</tr>
						</obsgroup>
					</table>
					<table align="center" width="100%" class="tb1" id="triplets">
						<obsgroup groupingConceptId="162588AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
							<tr>
								<td colspan="6">
									Baby 3:
									<hr />
								</td>
							</tr>
							<tr>
								<td>Baby's Condition</td>
								<td>
									<obs conceptId="162134AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"   id="baby-condition-triplets"
										 answerConceptIds="1855AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162133AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162132AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160034AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
										 answerLabels="Good, Fair, Poor,Died"/>
								</td>
								<td>Baby's Feeding Method</td>
								<td>
									<obs conceptId="1151AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"   id="feeding-method-triplets"
										 answerConceptIds="5526AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1595AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,6046AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159418AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
								</td>
							</tr>
							<tr>
								<td>Umbilical Cord</td>
								<td>
									<obs conceptId="162121AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"  id="umbilical-cord-triplets"/>
								</td>
								<td>Baby Immunization Started</td>
								<td>
									<obs conceptId="162127AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="immunization-triplets"/>
								</td>

							</tr>
						</obsgroup>
					</table>
				</td>
				</tr>
				<!-- here -->
	<tr>
		<td colspan="2">
			<fieldset>
				<legend>HIV testing</legend>
				<table align="center" width="100%" class="tb1">
					<tr>
						<td>
							<br/>
							<strong>HIV Testing</strong>
							<hr />
							<table id="tbl-known-positive" border="1">
								<tr>
									<td>
										<u>
											HIV Test Recorded Recently
										</u>
										<br/>
										<br/>Final results:
										<input type="text" name="hiv-known-status" id="hiv-known-positive" readonly="True" />
										&#160;&#160;&#160;&#160;
										Date:
										<lookup expression="fn.latestObs(159427).getObsDatetime()"/>
										<br/>
										<br/>On HAART:
										<input type="text" name="on-art" id="on-art" readonly="True" />
										&#160;&#160;&#160;&#160;
										Regimen:
										<span id="current-regimen" class="value"></span>
										<br/>
									</td>
								</tr>
							</table>
							<table id="tbl-hiv-test">
								<obsgroup groupingConceptId="164410AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
									<tr>
										<td colspan="6">
											<strong><U>Mother HIV Testing</U></strong>
										</td>
									</tr>
									<tr>

										<td>&#160;&#160;&#160;&#160; Kit Name
											<obs class="kit-name"
												 id="kit-name-1"
												 conceptId="164962"
												 answerConceptIds="164960,164961,165351"
												 style="dropdown" answerLabels="Determine,First Response,Dual Kit"
											/>

										</td>
										<td>&#160;&#160;&#160;&#160;Lot Number
											<obs
													class="lot-number"
													id="lot-number-1"
													conceptId="164964"
											/>

										</td>
										<td>&#160;&#160;&#160;&#160;Expiry Date
											<obs id="expiry-date" conceptId="162502AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" allowFutureDates="true"
											/>
										</td>
										<td>HIV Test 1 Results:
											<obs id="hiv-test1-result" conceptId="1040AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
												 answerConceptIds="703AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,664AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,163611AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
												 style="dropdown" answerLabels="Positive,Negative,Invalid"/>
										</td>
										<td>
											<div id="dual-results-1" style="display:none;" >&#160;&#160;&#160;&#160; Syphilis Results
												<obs conceptId="299AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
													 id="syphilis-test-results"
													 answerConceptIds="1229AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1228AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
													 answerLabels="Negative,Positive"/>
											</div>
										</td>
									</tr>
								</obsgroup>
								<obsgroup groupingConceptId="164410AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
									<tr id="hiv-test2">

										<td>&#160;&#160;&#160;&#160; Kit Name
											<obs class="kit-name2"
												 id="kit-name-2"
												 conceptId="164962"
												 answerConceptIds="164960,164961,165351"
												 style="dropdown" answerLabels="Determine,First Response,Dual Kit"
											/>

										</td>
										<td>&#160;&#160;&#160;&#160;Lot Number
											<obs class="lot-number2"
												 id="lot-number-2"
												 conceptId="164964"
											/>

										</td>
										<td>&#160;&#160;&#160;&#160;Expiry Date
											<obs id="expiry-date2" conceptId="162502AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" allowFutureDates="true"
											/>
										</td>

										<td>HIV Test 2 Results:
											<obs id="hiv-test2-result" conceptId="1326AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
												 answerConceptIds="703AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,664AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1175AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
												 style="dropdown" answerLabels="Positive,Negative,N/A"/>
										</td>
									</tr>
								</obsgroup>
								<tr>
									<td>Final Results:&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
										<obs id="hiv-final-result" conceptId="159427AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptIds="703AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,664AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1138AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
											 answerLabels="Positive,Negative,Inconclusive"/>
									</td>
									<td>&#160;&#160;&#160;&#160;Results given to client?&#160;&#160;&#160;&#160;
										<obs class="result-given" conceptId="164848AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
											 answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
											 style="dropdown" answerLabels="YES,NO"/>
									</td>
									<td>
										<table border="1">
											<tr>
												<td>
													<u>
														HIV Status Recorded Recently
													</u>
													<br/>
													<br/>
													Date:
													<lookup expression="fn.latestObs(159427).getObsDatetime()"/>
													<br/>
													Final results:
													<input type="text" name="hiv-status" id="hiv-status" readonly="True" />
													<br/>
													<br/> Duration since delivery:&#160;&#160;
													<input type="text" name="test-duration" id="test-duration" readonly="True" />
													<br/>
												</td>
											</tr>
										</table>
									</td>
								</tr>
							</table>
						</td>
					</tr>
					<tr>
						<td>
							<strong><U>Partner Testing</U></strong>
						</td>
					</tr>
					<tr>
						<td>Has the client's partner been tested for HIV? &#160;&#160;&#160;&#160;&#160;&#160;&#160;

							<obs id="partner-tested" conceptId="161557AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 answerLabels="Yes,No"/>
							<span class="value"><recentObs conceptId="1436AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></span>
							&#160;&#160;&#160;&#160;&#160;&#160;&#160;
						Partner HIV Status:
							&#160;&#160;&#160;&#160;&#160;&#160;&#160;
							<obs conceptId="1436AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 id="partner-hiv-status"
								 answerConceptIds="703AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,664AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1067AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 answerLabels="HIV Positive,HIV Negative,Unknown"/>
						</td>
					</tr>
				</table>
			</fieldset>
		</td>
	</tr>
	<tr id="art-and-prophylaxis">
		<td colspan="2">
			<fieldset>
				<legend>ART and Prophylaxis</legend>
				<table align="center" width="100%" class="tb1">
					<tr>
						<td>Mother's prophylaxis given during this visit?</td>
						<td><obs
								conceptId="1109AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								answerConceptIds="105281AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,74250AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1107AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								answerLabels="Cotrimoxazole,Dapsone,None"
								style="radio" id="prophylaxis-used"/>
						</td>
					</tr>
					<tr>
						<td>AZT for the baby dispensed?</td>
						<td>
							<obs class ="azt-prescribed"
								 conceptId="1282AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 answerConceptIds="160123AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1175AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 answerLabels="Yes,No,N/A"
								 style="radio" id="azt-dispensed" />
						</td>
					</tr>
					<tr>
						<td>NVP for the baby dispensed?</td>
						<td>
							<obs class ="nvp-prescribed"
								 conceptId="1282AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 answerConceptIds="80586AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1175AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 answerLabels="Yes,No,N/A"
								 style="radio" id="nvp-dispensed" />
						</td>
					</tr>
				</table>
			</fieldset>
		</td>
	</tr>
	<tr>
		<td colspan="2">
			<fieldset>
				<legend>Client monitoring</legend>
				<table align="center" width="100%" class="tb1">
					<tr>
						<td>Has the client undergone post natal exercises? &#160;&#160;&#160;&#160;&#160;&#160;&#160;  </td>
                            <td>
							<obs conceptId="161074AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 id="physical-exercises"
								 style="radio"
								 answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 answerLabels="Yes,No"/>
						</td><td><recentObs conceptId="161074AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/></td>
					</tr>
					<tr>
						<td>Maternal condition</td>
						<td>
							<obs conceptId="160085AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
						</td><td colspan="2"></td>
					</tr>
					<tr>
						<td>Iron supplementation (Haematinics):</td><td>

						<obs conceptId="161004AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 style="dropdown" answerLabels="Yes,No"  />
					    </td>
					</tr>
					<tr>
						<td>Fistula screening: </td>
						<td><obs conceptId="159921AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 answerConceptIds="1107AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,49AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,127847AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1118AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 answerLabels="None,Vesicovaginal Fistula,Rectovaginal fistula,Not done"
								 style="dropdown"
								 id="fistula-screening"
								  />
						</td>
					</tr>
					<tr>
						<td>CaCx screening: </td>
						<td><obs conceptId="164934"
								 answerConceptIds="664AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159393AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,703AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1118AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1175AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 answerLabels="Normal,Presumed,Confirmed,Not Done,N/A"
								 style="dropdown"
								 id="cacx-screening"/>
						</td>
					</tr>
					<tr id="cacx-screening-method">
						<td>CaCx screening method? </td>
						<td><obs conceptId="163589AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 answerConceptIds="885AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,162816AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,164977,5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 answerLabels="Pap Smear,VIA,VILI,Other"
								 style="radio"
								 id="screening-cacx-method"
						/>
						</td>
					</tr>
					<tr>
						<td>On modern FP Method (less than or equals to 6 weeks)?</td><td>
						<obs conceptId="160653AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="fplanning"
							 answerConceptIds="965AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160652AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 style="dropdown"
							 answerLabels="Yes,No"/>
					</td>
					</tr>
					<tr id="tbl-family-planning">
						<td colspan="2">
							<div id="onFp">
								If on modern FP Method specify which method(s)
								<hr/>
								<includeIf velocityTest="$patient.gender == 'F'">
									<table class="right-aligned-first" style="width: 100%;" border="0">
										<obsgroup groupingConceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
											<tr>
												<td style="text-align: left">
													<div style="float: left; padding-right: 50px">
														<obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
															 answerConceptId="160570AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
															 answerLabel="Emergency contraceptive pills" style="checkbox"
														/>
														<br />
														<obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
															 answerConceptId="780AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
															 answerLabel="Oral Contraceptives Pills" style="checkbox"/>
														<br />
														<obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
															 answerConceptId="5279AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
															 answerLabel="Injectible" style="checkbox"/>
														<br />
														<obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
															 answerConceptId="1359AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
															 answerLabel="Implant" style="checkbox"/>
														<br />
														<obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
															 answerConceptId="5275AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
															 answerLabel="Intrauterine Device" style="checkbox"/>
														<br />
														<obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
															 answerConceptId="136163AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
															 answerLabel="Lactational Amenorhea Method" style="checkbox"/>
														<br />
													</div>
												</td>
												<td>
													<div style="float: left; padding-right: 50px">
														<obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
															 answerConceptId="5278AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
															 answerLabel="Diaphram/Cervical Cap" style="checkbox"/>
														<br />
														<obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
															 answerConceptId="5277AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
															 answerLabel="Fertility Awareness"
															 style="checkbox"/>
														<br />
														<obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
															 answerConceptId="1472AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
															 answerLabel="Tubal Ligation" style="checkbox"/>
														<br />
														<obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
															 answerConceptId="190AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
															 answerLabel="Condoms" style="checkbox"/>
														<br />
														<obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
															 answerConceptId="1489AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
															 answerLabel="Vasectomy(Partner)" style="checkbox"/>
														<br />
													</div>
												</td>
											</tr>
										</obsgroup>
									</table>
								</includeIf>
								<includeIf velocityTest="$patient.gender == 'M'">
									<table class="right-aligned-first" style="width: 100%;" border="0">
										<obsgroup groupingConceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
											<tr>
												<td style="text-align: left">
													<obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
														 answerConceptId="190AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
														 answerLabel="Condoms" style="checkbox"/>
													<br/>
													<obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
														 answerConceptId="1489AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
														 answerLabel="Vasectomy" style="checkbox"/>
													<br/>
													<obs conceptId="374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
														 answerConceptId="162332AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
														 answerLabel="Undecided" style="checkbox" id="fp-error"/>
												</td>
											</tr>
										</obsgroup>
									</table>
								</includeIf>
							</div>
						</td>
					</tr>
				</table>
			</fieldset>
		</td>
	</tr>
	<tr>
		<td colspan="2">
			<fieldset>
				<legend>Referrals </legend>
				<table align="center" width="100%" class="tb1">
					<tr>
						<td>Referred from? &#160;&#160;&#160;&#160;&#160;&#160;&#160;

							<obs conceptId="160481AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 style="dropdown"
								 answerConceptIds="1537AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,163488AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1175AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 answerLabels="Another Health Facility,Community Unit,N/A"/>
						</td>
						<td>Referred to? &#160;&#160;&#160;&#160;&#160;&#160;&#160;

							<obs conceptId="163145AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 style="dropdown"
								 answerConceptIds="1537AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,163488AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1175AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 answerLabels="Another Health Facility,Community Unit,N/A"/>
						</td>
					</tr>
				</table>
			</fieldset>
		</td>
	</tr>
	<tr>
		<td colspan="2">
			<fieldset>
				<legend>Next Appointment </legend>
				<table align="center" width="100%" class="tb1">
					<tr>
						<td>Next appointment date:  &#160;&#160;&#160;&#160;&#160;&#160;&#160;

							<obs conceptId="5096AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" allowFutureDates="true" labelText=" " id="returnVisitDate" />
							<span style="color:red;"><strong>*</strong></span>
						</td>
					</tr>
				</table>
				<table id="showNumberBooked" class="simple-table">
					<tr>
						<td> <span class="ke-flagtag">Number of patients already booked for MCH consultation on the date selected </span></td>
						<td><span class="ke-flagtag" id="showBookedResult"></span></td></tr>
				</table>
			</fieldset>
		</td>
	</tr>
<tr>
	<td>
		<legend>Clinical Notes</legend>
		<table align="center" width="100%" class="tb1">
			<tr>
				<td>
					<obs conceptId="159395AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" rows="3" cols="100"
						 style="textarea"/>
				</td>
			</tr>
		</table>
	</td>
</tr>
			</tr>
		</table>
	</td>
</tr>
</table>
</div>

<div class="ke-form-footer">
	<submit/>
</div>

</htmlform>