<!--
  ~ The contents of this file are subject to the OpenMRS Public License
  ~ Version 1.0 (the "License"); you may not use this file except in
  ~ compliance with the License. You may obtain a copy of the License at
  ~ http://license.openmrs.org
  ~
  ~ Software distributed under the License is distributed on an "AS IS"
  ~ basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See the
  ~ License for the specific language governing rights and limitations
  ~ under the License.
  ~
  ~ Copyright (C) OpenMRS, LLC.  All Rights Reserved.
-->
<htmlform>

	<script type="text/javascript">

        jq(document).ready(function() {

            jq("#reason-trf").hide();
            jq("#reason-died").hide();

            jq("#idReason select").change(function() {
                if((getValue('idReason.value')) == 159492) {
                    jq("#reason-trf").show();
                    jq('#ptransferred :input').prop('disabled', false);
                    jq('#ptrfVerification :input').prop('disabled', false);
                    jq("#reason-died").hide();
                    clearHiddenSections(jq('#reason-died'));
                }else if((getValue('idReason.value')) == 160432){
                    jq("#reason-died").show();
                    jq("#reason-trf").hide();
                    clearHiddenSections(jq('#ptransferred'));
                    clearHiddenSections(jq('#ptrfVerification'));
                    clearHiddenSections(jq('#tr-verified-obs'));
                }
                else {
                    jq("#reason-died").hide();
                    jq("#reason-trf").hide();
                    clearHiddenSections(jq('#ptransferred'));
                    clearHiddenSections(jq('#ptrfVerification'));
                    clearHiddenSections(jq('#reason-died'));
                    clearHiddenSections(jq('#tr-verified-obs'));
                }
            });

            jq("#tr-verified-obs").change(function(){
                if (getValue('tr-verified-obs.value') == 1066 || getValue('tr-verified-obs.value') == "") {
                    jq('#trf-verification-date :input').val('');
                    jq('#trf-verification-date :input').prop('disabled',true);
                }
                else
                {
                    jq('#trf-verification-date :input').prop('disabled',false);
                }
            });

            jq("#death-reason select").change(function() {
                if ((getValue('death-reason.value')) == 163324) {
                    jq("#specific-death-cause").show();
                    jq('#specific-cause-of-death option[value=145439]').hide();
                    jq('#specific-cause-of-death option[value=156673]').show();
                    jq('#specific-cause-of-death option[value=165609]').hide();
                    jq('#specific-cause-of-death option[value=155010]').hide();
                    jq('#specific-cause-of-death option[value=156667]').hide();
                    jq('#specific-cause-of-death option[value=115195]').hide();
                    jq('#specific-cause-of-death option[value=156672]').hide();
                    jq('#specific-cause-of-death option[value=159988]').hide();
                    jq('#specific-cause-of-death option[value=116031]').hide();
                    jq('#specific-cause-of-death option[value=157578]').hide();
                    jq('#specific-cause-of-death option[value=5333]').hide();
                    jq('#specific-cause-of-death option[value=156669]').hide();
                    jq('#specific-cause-of-death option[value=123122]').hide();
                    jq('#specific-cause-of-death option[value=156668]').hide();
                    jq('#specific-cause-of-death option[value=5350]').hide();
                    jq('#specific-cause-of-death option[value=882]').hide();
                    jq('#specific-cause-of-death option[value=156671]').hide();
                    jq('#specific-cause-of-death option[value=160159]').hide();
                    jq('#specific-cause-of-death option[value=171]').hide();
                    jq('#specific-cause-of-death option[value=156670]').hide();
                    jq('#specific-cause-of-death option[value=160160]').hide();
                    jq('#specific-cause-of-death option[value=161548]').hide();
                    jq('#specific-cause-of-death option[value=157593]').hide();
                    jq("#other-non-natural").hide();
                    jq("#other-natural").hide();

                }
                else if ((getValue('death-reason.value')) == 116030) {
                    jq("#specific-death-cause").show();
                    jq('#specific-cause-of-death option[value=145439]').hide();
                    jq('#specific-cause-of-death option[value=165609]').hide();
                    jq('#specific-cause-of-death option[value=156673]').hide();
                    jq('#specific-cause-of-death option[value=155010]').show();
                    jq('#specific-cause-of-death option[value=156667]').show();
                    jq('#specific-cause-of-death option[value=115195]').show();
                    jq('#specific-cause-of-death option[value=156672]').show();
                    jq('#specific-cause-of-death option[value=159988]').show();
                    jq('#specific-cause-of-death option[value=116031]').show();
                    jq('#specific-cause-of-death option[value=157578]').show();
                    jq('#specific-cause-of-death option[value=157593]').show();
                    jq('#specific-cause-of-death option[value=5333]').hide();
                    jq('#specific-cause-of-death option[value=156669]').hide();
                    jq('#specific-cause-of-death option[value=123122]').hide();
                    jq('#specific-cause-of-death option[value=156668]').hide();
                    jq('#specific-cause-of-death option[value=5350]').hide();
                    jq('#specific-cause-of-death option[value=882]').hide();
                    jq('#specific-cause-of-death option[value=156671]').hide();
                    jq('#specific-cause-of-death option[value=160159]').hide();
                    jq('#specific-cause-of-death option[value=171]').hide();
                    jq('#specific-cause-of-death option[value=156670]').hide();
                    jq('#specific-cause-of-death option[value=160160]').hide();
                    jq('#specific-cause-of-death option[value=161548]').hide();
                    jq("#other-non-natural").hide();
                    jq("#other-natural").hide();
                }
                else if ((getValue('death-reason.value')) == 160159) {
                    jq("#specific-death-cause").show();
                    jq('#specific-cause-of-death option[value=145439]').hide();
                    jq('#specific-cause-of-death option[value=156673]').hide();
                    jq('#specific-cause-of-death option[value=155010]').hide();
                    jq('#specific-cause-of-death option[value=156667]').hide();
                    jq('#specific-cause-of-death option[value=115195]').hide();
                    jq('#specific-cause-of-death option[value=156672]').hide();
                    jq('#specific-cause-of-death option[value=159988]').hide();
                    jq('#specific-cause-of-death option[value=116031]').hide();
                    jq('#specific-cause-of-death option[value=157578]').hide();
                    jq('#specific-cause-of-death option[value=165609]').show();
                    jq('#specific-cause-of-death option[value=5333]').show();
                    jq('#specific-cause-of-death option[value=156669]').show();
                    jq('#specific-cause-of-death option[value=123122]').show();
                    jq('#specific-cause-of-death option[value=156668]').show();
                    jq('#specific-cause-of-death option[value=5350]').show();
                    jq('#specific-cause-of-death option[value=882]').show();
                    jq('#specific-cause-of-death option[value=156671]').show();
                    jq('#specific-cause-of-death option[value=160159]').show();
                    jq('#specific-cause-of-death option[value=171]').show();
                    jq('#specific-cause-of-death option[value=156670]').hide();
                    jq('#specific-cause-of-death option[value=160160]').hide();
                    jq('#specific-cause-of-death option[value=161548]').hide();
                    jq('#specific-cause-of-death option[value=157593]').hide();
                    jq("#other-non-natural").hide();
                    jq("#other-natural").hide();
                }
                else if ((getValue('death-reason.value')) == 160158) {
                    jq("#specific-death-cause").show();
                    jq('#specific-cause-of-death option[value=165609]').hide();
                    jq('#specific-cause-of-death option[value=156673]').hide();
                    jq('#specific-cause-of-death option[value=155010]').hide();
                    jq('#specific-cause-of-death option[value=156667]').hide();
                    jq('#specific-cause-of-death option[value=115195]').hide();
                    jq('#specific-cause-of-death option[value=156672]').hide();
                    jq('#specific-cause-of-death option[value=159988]').hide();
                    jq('#specific-cause-of-death option[value=116031]').hide();
                    jq('#specific-cause-of-death option[value=157578]').hide();
                    jq('#specific-cause-of-death option[value=5333]').hide();
                    jq('#specific-cause-of-death option[value=156669]').hide();
                    jq('#specific-cause-of-death option[value=123122]').hide();
                    jq('#specific-cause-of-death option[value=156668]').hide();
                    jq('#specific-cause-of-death option[value=5350]').hide();
                    jq('#specific-cause-of-death option[value=882]').hide();
                    jq('#specific-cause-of-death option[value=156671]').hide();
                    jq('#specific-cause-of-death option[value=160159]').hide();
                    jq('#specific-cause-of-death option[value=171]').hide();
                    jq('#specific-cause-of-death option[value=145439]').show();
                    jq('#specific-cause-of-death option[value=156670]').show();
                    jq('#specific-cause-of-death option[value=160160]').show();
                    jq('#specific-cause-of-death option[value=161548]').show();
                    jq('#specific-cause-of-death option[value=157593]').hide();
                    jq("#other-non-natural").hide();
                    jq("#other-natural").hide();
                }
                else if ((getValue('death-reason.value')) == 133478) {
                    jq("#specific-death-cause").hide();
                    jq("#other-non-natural").hide();
                    jq("#other-natural").show();
                }
                else if ((getValue('death-reason.value')) == 123812) {
                    jq("#specific-death-cause").hide();
                    jq("#other-natural").hide();
                    jq("#other-non-natural").show();
                }
                else if ((getValue('death-reason.value')) ==  142917) {
                    jq("#specific-death-cause").hide();
                    jq("#other-non-natural").hide();
                    jq("#other-natural").hide();
                }

            });

            beforeSubmit.push(function() {
                var trfVerified = getValue('tr-verified-obs.value');
                var trfVerificationDate = getField("trf-verification-date.value").val();
                var discReason = getValue('idReason.value');
                var deathReason = getValue('death-reason.value');

                if (trfVerified == 1065 &amp;&amp; trfVerificationDate == "") {
                    getField('trf-verification-date.error').html('Please enter date transfer was verified').show();
                    return false;
                }else{
                    getField('trf-verification-date.error').html('Please enter date transfer was verified').hide();
                }
                if (discReason == 160432 &amp;&amp; deathReason == "") {
                    getField('death-reason.error').html('Cause of death is required').show();
                    return false;
                }else{
                    getField('death-reason.error').html('Cause of death is require').hide();
                }
                return true;
            });
        });
        clearHiddenSections = function(parentObj) {
            parentObj.find('input[type=text]').each(function() {
                jq(this).val("");
            });
            parentObj.find('select').each(function() {
                this.selectedIndex =0;
            });
            parentObj.find('input[type=radio]').each(function() {
                this.checked = false;
            });
        }
	</script>

	<ifMode mode="EDIT">
		<script type="text/javascript">
            jq(function(){

                var val = getField("idReason.value").val();
                var verifiedObs = getValue("tr-verified-obs.value");
                var trfVerificationDate = getField("trf-verification-date.value").val();
                if (val == 159492) {
                    jq("#reason-trf").show();
                }else if(val == 160432) {
                    jq("#reason-died").show();
                }else {
                    jq("#reason-trf").hide();
                }

                if(verifiedObs == 1065) {
                    jq('#ptrfVerification').show();
                }

            });
		</script>
	</ifMode>

	<style type="text/css">
		table.hei {
			border-collapse: collapse;
			background-color: #fff0f7;
		}
		table.hei > tbody > tr > td, table.hei > tbody > tr > th {
			border: 1px solid black;
			vertical-align: baseline;
			padding: 4px;
			text-align: left;
		}
	</style>

	<div class="ke-form-header">
		<table style="width: 100%">
			<tr>
				<td>Location: <encounterLocation default="GlobalProperty:kenyaemr.defaultLocation" /></td>
			</tr>
		</table>
	</div>

	<div class="ke-form-content">
		<table class="hei" align="center">
			<tbody>
			<tr><td colspan="2"><b>Child Services Discontinuation</b></td></tr>
			<tr>
				<td>Discontinued Date</td>
				<td><encounterDate  id="exitDate" showTime="true"/></td>
			</tr>
			<tr>
				<td>Reason</td>
				<td><obs conceptId="161555AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="dropdown" answerConceptIds="5240AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1692AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1267AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160432AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,159492AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerLabels="Lost to follow up,Discharged at 18 months, Completed,Died,Transferred Out" id="idReason"/></td>
			</tr>
			<completeProgram programId="c2ecdf11-97cd-432a-a971-cfd9bd296b83"/>
			</tbody>
		</table>

		<!-- Died -->
		<div id="reason-died">
			<div id="pdied">
				<table>
					<tr>
						<td width="200px">Date of Death, if Known:</td>
						<td><obs conceptId="1543AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" /></td>
					</tr>
				</table>
			</div><br/>
			<div id="cause-death">
				<table id="general-death-cause">
					<tr>
						<td width="200px">Death reason:</td>
						<td><obs conceptId="1599AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptIds="163324AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
							                                                                            116030AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
							                                                                            160159AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
							                                                                            160158AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
							                                                                            133478AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
							                                                                            123812AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
							                                                                            142917AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 answerLabels="HIV disease resulting in TB,
									               HIV disease resulting in cancer,
									               HIV disease resulting in other infectious and parasitic diseases,
									               Other HIV disease resulting in other diseases or conditions leading to death,
									               Other natural causes not directly related to HIV,
									               Non-natural causes,
									               Unknown cause" id="death-reason" /><span style="color:red;">*</span></td>

					</tr>
				</table><br/>
				<table id="specific-death-cause">
					<tr id="cause-of-death">
						<td width="200px">Specific cause of death:</td>
						<td><obs conceptId="1748AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 answerConceptIds="165609,
									                    145439AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
									                    156673AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
														155010AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
														156667AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
														115195AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
														157593AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
														156672AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
														159988AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
														5333AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
														116031AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
														123122AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
														156669AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
														156668AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
														5350AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
														882AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
														156671AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
														160159AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
														171AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
														156670AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
														160160AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
														161548AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 answerLabels="COVID-19 Complications,
									                    Non-communicable diseases such as Diabetes and hypertension,
									                    HIV disease resulting in mycobacterial infection,
														HIV disease resulting in Kaposis sarcoma,
														HIV disease resulting in Burkitts lymphoma,
														HIV disease resulting in other types of non-Hodgkin lymphoma,
														HIV disease resulting in other malignant neoplasms of lymphoid and haematopoietic and related tissue,
														HIV disease resulting in multiple malignant neoplasms,
														HIV disease resulting in other malignant neoplasms,
														HIV disease resulting in other bacterial infections,
														HIV disease resulting in unspecified malignant neoplasms,
														HIV disease resulting in other viral infections,
														HIV disease resulting in cytomegaloviral disease,
														HIV disease resulting in candidiasis,
														HIV disease resulting in other mycoses,
														HIV disease resulting in Pneumocystis jirovecii pneumonia - HIV disease resulting in Pneumocystis carinii pneumonia,
														HIV disease resulting in multiple infections,
														HIV disease resulting in other infectious and parasitic diseases,
														HIV disease resulting in unspecified infectious or parasitic disease - HIV disease resulting in infection NOS,
														HIV disease resulting in other specified diseases including encephalopathy or lymphoid interstitial pneumonitis or wasting syndrome and others,
														HIV disease resulting in other conditions including acute HIV infection syndrome or persistent generalized lymphadenopathy or hematological and immunological abnormalities and others,
														HIV disease resulting in Unspecified HIV disease"
								 id="specific-cause-of-death" />
							<span style="color:red;"><strong>*</strong></span></td>

					</tr>
				</table>
				<table id="other-death-causes">
					<tr id ="other-natural">
						<td width="200px">Other natural causes:</td>
						<td ><obs conceptId="162580AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" "/></td>
					</tr>
					<tr id="other-non-natural">
						<td>Non-natural causes:</td>
						<td ><obs conceptId="160218AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" "/></td>
					</tr>
				</table>
			</div>
		</div>

		<div id="reason-trf" align="center" class="hei">
			<div id="ptransferred">
				<table class="hei">
					<tr>
						<td width="200px"><i>(If transferred out)</i> <br/>Transfer to Facility:</td>
						<td ><obs conceptId="159495AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" "/></td>
					</tr>
					<tr>
						<td>Date Transferred Out<br /></td>
						<td><obs conceptId="160649AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" " /></td>
					</tr>
				</table>
			</div>
			<div id="ptrfVerification">
				<table class="hei">
					<tr>
						<td width="220px">Transfer out verified?</td>
						<td ><obs conceptId="1285AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								  answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								  answerLabel="Yes,No"
								  style="radio" id="tr-verified-obs"/> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</td>
					</tr>
					<tr>
						<td>Date verified<br /></td>
						<td><obs conceptId="164133AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="trf-verification-date" /></td>
					</tr>
				</table>
			</div>
		</div>
		<br/>
		<hr/>
		<br/>

	</div>
	<div class="ke-form-footer">
		<submit />
	</div>

</htmlform>
